{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"themes/archer/source/assets/algolia_logo.svg","path":"assets/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/archer/source/assets/example_qr.png","path":"assets/example_qr.png","modified":1,"renderable":1},{"_id":"themes/archer/source/assets/beian.png","path":"assets/beian.png","modified":1,"renderable":1},{"_id":"themes/archer/source/assets/favicon.ico","path":"assets/favicon.ico","modified":1,"renderable":1},{"_id":"themes/archer/source/assets/favicon_bak.ico","path":"assets/favicon_bak.ico","modified":1,"renderable":1},{"_id":"themes/archer/source/assets/loading.svg","path":"assets/loading.svg","modified":1,"renderable":1},{"_id":"themes/archer/source/assets/wechat_qr.jpg","path":"assets/wechat_qr.jpg","modified":1,"renderable":1},{"_id":"themes/archer/source/avatar/Jason.jpg","path":"avatar/Jason.jpg","modified":1,"renderable":1},{"_id":"themes/archer/source/css/dark.css","path":"css/dark.css","modified":1,"renderable":1},{"_id":"themes/archer/source/css/dark.css.map","path":"css/dark.css.map","modified":1,"renderable":1},{"_id":"themes/archer/source/avatar/Misaka.jpg","path":"avatar/Misaka.jpg","modified":1,"renderable":1},{"_id":"themes/archer/source/css/mobile.css","path":"css/mobile.css","modified":1,"renderable":1},{"_id":"themes/archer/source/css/style.css","path":"css/style.css","modified":1,"renderable":1},{"_id":"themes/archer/source/css/style.css.map","path":"css/style.css.map","modified":1,"renderable":1},{"_id":"themes/archer/source/css/mobile.css.map","path":"css/mobile.css.map","modified":1,"renderable":1},{"_id":"themes/archer/source/font/Oswald-Regular.ttf","path":"font/Oswald-Regular.ttf","modified":1,"renderable":1},{"_id":"themes/archer/source/font/Source Sans Pro.woff","path":"font/Source Sans Pro.woff","modified":1,"renderable":1},{"_id":"themes/archer/source/font/Source Sans Pro.woff2","path":"font/Source Sans Pro.woff2","modified":1,"renderable":1},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff","path":"font/SourceCodePro-Regular.ttf.woff","modified":1,"renderable":1},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff2","path":"font/SourceCodePro-Regular.ttf.woff2","modified":1,"renderable":1},{"_id":"themes/archer/source/intro/404-bg.jpg","path":"intro/404-bg.jpg","modified":1,"renderable":1},{"_id":"themes/archer/source/intro/about-bg.jpg","path":"intro/about-bg.jpg","modified":1,"renderable":1},{"_id":"themes/archer/source/intro/index-bg.jpg","path":"intro/index-bg.jpg","modified":1,"renderable":1},{"_id":"themes/archer/source/intro/post-bg.jpg","path":"intro/post-bg.jpg","modified":1,"renderable":1},{"_id":"themes/archer/source/lib/jquery.min.js","path":"lib/jquery.min.js","modified":1,"renderable":1},{"_id":"themes/archer/source/lib/webfontloader.min.js","path":"lib/webfontloader.min.js","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/customFontLoader.js","path":"scripts/customFontLoader.js","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/customFontLoader.js.map","path":"scripts/customFontLoader.js.map","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/dark.js","path":"scripts/dark.js","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/dark.js.map","path":"scripts/dark.js.map","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/main.js","path":"scripts/main.js","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/main.js.LICENSE.txt","path":"scripts/main.js.LICENSE.txt","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/main.js.map","path":"scripts/main.js.map","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/search.js","path":"scripts/search.js","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/search.js.LICENSE.txt","path":"scripts/search.js.LICENSE.txt","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/share.js","path":"scripts/share.js","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/search.js.map","path":"scripts/search.js.map","modified":1,"renderable":1},{"_id":"themes/archer/source/scripts/share.js.map","path":"scripts/share.js.map","modified":1,"renderable":1},{"_id":"source/images/hello-bg.png","path":"images/hello-bg.png","modified":1,"renderable":0},{"_id":"source/images/daemonset/DaemonSets.png","path":"images/daemonset/DaemonSets.png","modified":1,"renderable":0},{"_id":"source/images/daemonset/bg.png","path":"images/daemonset/bg.png","modified":1,"renderable":0},{"_id":"source/images/daemonset/daemonset-pods.png","path":"images/daemonset/daemonset-pods.png","modified":1,"renderable":0},{"_id":"source/images/daemonset/daemonset-1.png","path":"images/daemonset/daemonset-1.png","modified":1,"renderable":0},{"_id":"source/images/daemonset/nodes.png","path":"images/daemonset/nodes.png","modified":1,"renderable":0},{"_id":"source/images/docker-1/bg.png","path":"images/docker-1/bg.png","modified":1,"renderable":0},{"_id":"source/images/docker-1/configurations.png","path":"images/docker-1/configurations.png","modified":1,"renderable":0},{"_id":"source/images/docker-1/multi-env.png","path":"images/docker-1/multi-env.png","modified":1,"renderable":0},{"_id":"source/images/dead-message/bg.jpg","path":"images/dead-message/bg.jpg","modified":1,"renderable":0},{"_id":"source/images/dead-message/dead-letter-2.jpg","path":"images/dead-message/dead-letter-2.jpg","modified":1,"renderable":0},{"_id":"source/images/dead-message/dead-letter-3.png","path":"images/dead-message/dead-letter-3.png","modified":1,"renderable":0},{"_id":"source/images/dead-message/dead-letter-exchange-1.png","path":"images/dead-message/dead-letter-exchange-1.png","modified":1,"renderable":0},{"_id":"source/images/dead-message/delay_comsuption_1.png","path":"images/dead-message/delay_comsuption_1.png","modified":1,"renderable":0},{"_id":"source/images/docker-2/after.png","path":"images/docker-2/after.png","modified":1,"renderable":0},{"_id":"source/images/docker-2/before.png","path":"images/docker-2/before.png","modified":1,"renderable":0},{"_id":"source/images/docker-2/inspect1.png","path":"images/docker-2/inspect1.png","modified":1,"renderable":0},{"_id":"source/images/dead-message/delay_comsuption_2.png","path":"images/dead-message/delay_comsuption_2.png","modified":1,"renderable":0},{"_id":"source/images/docker-2/inspect3.png","path":"images/docker-2/inspect3.png","modified":1,"renderable":0},{"_id":"source/images/docker-2/inspect2.png","path":"images/docker-2/inspect2.png","modified":1,"renderable":0},{"_id":"source/images/docker-layer/filesystem.png","path":"images/docker-layer/filesystem.png","modified":1,"renderable":0},{"_id":"source/images/docker-layer/layers.png","path":"images/docker-layer/layers.png","modified":1,"renderable":0},{"_id":"source/images/docker-layer/ls_upper.png","path":"images/docker-layer/ls_upper.png","modified":1,"renderable":0},{"_id":"source/images/docker-layer/merged.png","path":"images/docker-layer/merged.png","modified":1,"renderable":0},{"_id":"source/images/docker-layer/tree.png","path":"images/docker-layer/tree.png","modified":1,"renderable":0},{"_id":"source/images/dump/bg.png","path":"images/dump/bg.png","modified":1,"renderable":0},{"_id":"source/images/dump/crash.jpeg","path":"images/dump/crash.jpeg","modified":1,"renderable":0},{"_id":"source/images/dump/windbg_1.png","path":"images/dump/windbg_1.png","modified":1,"renderable":0},{"_id":"source/images/dump/windbg_2.png","path":"images/dump/windbg_2.png","modified":1,"renderable":0},{"_id":"source/images/dump/windbg_3.png","path":"images/dump/windbg_3.png","modified":1,"renderable":0},{"_id":"source/images/dump/windbg_4.png","path":"images/dump/windbg_4.png","modified":1,"renderable":0},{"_id":"source/images/garnet/1.png","path":"images/garnet/1.png","modified":1,"renderable":0},{"_id":"source/images/garnet/client.png","path":"images/garnet/client.png","modified":1,"renderable":0},{"_id":"source/images/garnet/compare1.png","path":"images/garnet/compare1.png","modified":1,"renderable":0},{"_id":"source/images/garnet/compatible.png","path":"images/garnet/compatible.png","modified":1,"renderable":0},{"_id":"source/images/garnet/connect.png","path":"images/garnet/connect.png","modified":1,"renderable":0},{"_id":"source/images/garnet/custom-command.png","path":"images/garnet/custom-command.png","modified":1,"renderable":0},{"_id":"source/images/garnet/log.png","path":"images/garnet/log.png","modified":1,"renderable":0},{"_id":"source/images/garnet/running.png","path":"images/garnet/running.png","modified":1,"renderable":0},{"_id":"source/images/http/TCP-connection-1.png","path":"images/http/TCP-connection-1.png","modified":1,"renderable":0},{"_id":"source/images/http/auto-disconnect.png","path":"images/http/auto-disconnect.png","modified":1,"renderable":0},{"_id":"source/images/http/auto-disconnect2.png","path":"images/http/auto-disconnect2.png","modified":1,"renderable":0},{"_id":"source/images/http/curl-header.png","path":"images/http/curl-header.png","modified":1,"renderable":0},{"_id":"source/images/http/handshake-1.png","path":"images/http/handshake-1.png","modified":1,"renderable":0},{"_id":"source/images/http/handshake-2.png","path":"images/http/handshake-2.png","modified":1,"renderable":0},{"_id":"source/images/http/http-request.png","path":"images/http/http-request.png","modified":1,"renderable":0},{"_id":"source/images/http/http-keep-alive-header.png","path":"images/http/http-keep-alive-header.png","modified":1,"renderable":0},{"_id":"source/images/http/perisitent-connection.png","path":"images/http/perisitent-connection.png","modified":1,"renderable":0},{"_id":"source/images/http/request-methods.png","path":"images/http/request-methods.png","modified":1,"renderable":0},{"_id":"source/images/http/timeout-auto-disconnect.png","path":"images/http/timeout-auto-disconnect.png","modified":1,"renderable":0},{"_id":"source/images/https/bg.jpg","path":"images/https/bg.jpg","modified":1,"renderable":0},{"_id":"source/images/https/ca.png","path":"images/https/ca.png","modified":1,"renderable":0},{"_id":"source/images/https/cipher-suites.png","path":"images/https/cipher-suites.png","modified":1,"renderable":0},{"_id":"source/images/https/client-hello.png","path":"images/https/client-hello.png","modified":1,"renderable":0},{"_id":"source/images/https/expire.png","path":"images/https/expire.png","modified":1,"renderable":0},{"_id":"source/images/https/handshake.png","path":"images/https/handshake.png","modified":1,"renderable":0},{"_id":"source/images/https/negotiated-cipher-suite.png","path":"images/https/negotiated-cipher-suite.png","modified":1,"renderable":0},{"_id":"source/images/https/security.png","path":"images/https/security.png","modified":1,"renderable":0},{"_id":"source/images/https/encrypted.png","path":"images/https/encrypted.png","modified":1,"renderable":0},{"_id":"source/images/image-search/bg.jpg","path":"images/image-search/bg.jpg","modified":1,"renderable":0},{"_id":"source/images/image-search/images.png","path":"images/image-search/images.png","modified":1,"renderable":0},{"_id":"source/images/image-search/process.png","path":"images/image-search/process.png","modified":1,"renderable":0},{"_id":"source/images/image-search/qdrant.png","path":"images/image-search/qdrant.png","modified":1,"renderable":0},{"_id":"source/images/image-search/search.gif","path":"images/image-search/search.gif","modified":1,"renderable":0},{"_id":"source/images/internal-loss/20231109_sy_01.jpg","path":"images/internal-loss/20231109_sy_01.jpg","modified":1,"renderable":0},{"_id":"source/images/internal-loss/996.jpg","path":"images/internal-loss/996.jpg","modified":1,"renderable":0},{"_id":"source/images/https/ca2.png","path":"images/https/ca2.png","modified":1,"renderable":0},{"_id":"source/images/internal-loss/depressed.jpg","path":"images/internal-loss/depressed.jpg","modified":1,"renderable":0},{"_id":"source/images/proxy/bg.jpg","path":"images/proxy/bg.jpg","modified":1,"renderable":0},{"_id":"source/images/proxy/forward-proxy.png","path":"images/proxy/forward-proxy.png","modified":1,"renderable":0},{"_id":"source/images/js-signal/EventTarget.png","path":"images/js-signal/EventTarget.png","modified":1,"renderable":0},{"_id":"source/images/js-signal/EventTarget2.png","path":"images/js-signal/EventTarget2.png","modified":1,"renderable":0},{"_id":"source/images/proxy/transparent-proxy.png","path":"images/proxy/transparent-proxy.png","modified":1,"renderable":0},{"_id":"source/images/js-signal/EventTarget3.png","path":"images/js-signal/EventTarget3.png","modified":1,"renderable":0},{"_id":"source/images/proxy/reverse-proxy.png","path":"images/proxy/reverse-proxy.png","modified":1,"renderable":0},{"_id":"source/images/js-signal/responsive.gif","path":"images/js-signal/responsive.gif","modified":1,"renderable":0},{"_id":"source/images/js-signal/switch-theme.gif","path":"images/js-signal/switch-theme.gif","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/16elk-ujaxc.gif","path":"images/rabbitmq-basic/16elk-ujaxc.gif","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/channel1.png","path":"images/rabbitmq-basic/channel1.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/channel2.png","path":"images/rabbitmq-basic/channel2.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/default-exchange.png","path":"images/rabbitmq-basic/default-exchange.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/exchanges-bidings-routing-keys.svg","path":"images/rabbitmq-basic/exchanges-bidings-routing-keys.svg","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/fanout.mp4","path":"images/rabbitmq-basic/fanout.mp4","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/fanout-exchange.svg","path":"images/rabbitmq-basic/fanout-exchange.svg","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/direct-exchange.svg","path":"images/rabbitmq-basic/direct-exchange.svg","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/fanout.png","path":"images/rabbitmq-basic/fanout.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/main.png","path":"images/rabbitmq-basic/main.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/topic-exchange.svg","path":"images/rabbitmq-basic/topic-exchange.svg","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/rabbitmq-headers-exchange.svg","path":"images/rabbitmq-basic/rabbitmq-headers-exchange.svg","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-basic/vro2s-b2mub.gif","path":"images/rabbitmq-basic/vro2s-b2mub.gif","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-quarum/courgette.log","path":"images/rabbitmq-quarum/courgette.log","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-quarum/normal.png","path":"images/rabbitmq-quarum/normal.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-quarum/quarum1.png","path":"images/rabbitmq-quarum/quarum1.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-quarum/quarum2.png","path":"images/rabbitmq-quarum/quarum2.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-quarum/stream_error1.png","path":"images/rabbitmq-quarum/stream_error1.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-quarum/stream_error2.png","path":"images/rabbitmq-quarum/stream_error2.png","modified":1,"renderable":0},{"_id":"source/images/rabbitmq-quarum/stream_offset.png","path":"images/rabbitmq-quarum/stream_offset.png","modified":1,"renderable":0},{"_id":"source/images/quic/handshake.png","path":"images/quic/handshake.png","modified":1,"renderable":0},{"_id":"source/images/quic/head_of_line_blocking.png","path":"images/quic/head_of_line_blocking.png","modified":1,"renderable":0},{"_id":"source/images/quic/quic.png","path":"images/quic/quic.png","modified":1,"renderable":0},{"_id":"source/images/quic/quic-logo.png","path":"images/quic/quic-logo.png","modified":1,"renderable":0},{"_id":"source/images/quic/tcp.png","path":"images/quic/tcp.png","modified":1,"renderable":0},{"_id":"source/images/redis-interview/bg.png","path":"images/redis-interview/bg.png","modified":1,"renderable":0},{"_id":"source/images/redis-interview/cache-avalanche.png","path":"images/redis-interview/cache-avalanche.png","modified":1,"renderable":0},{"_id":"source/images/redis-interview/cache-breakdown.png","path":"images/redis-interview/cache-breakdown.png","modified":1,"renderable":0},{"_id":"source/images/redis-interview/cache-penetration.png","path":"images/redis-interview/cache-penetration.png","modified":1,"renderable":0},{"_id":"source/images/redis-interview/memory.png","path":"images/redis-interview/memory.png","modified":1,"renderable":0},{"_id":"source/images/redis-interview/recruitment.png","path":"images/redis-interview/recruitment.png","modified":1,"renderable":0},{"_id":"source/images/sticky-packet/bg.jpg","path":"images/sticky-packet/bg.jpg","modified":1,"renderable":0},{"_id":"source/images/sticky-packet/server-sticky.png","path":"images/sticky-packet/server-sticky.png","modified":1,"renderable":0},{"_id":"source/images/sticky-packet/solve-sender-sticky.png","path":"images/sticky-packet/solve-sender-sticky.png","modified":1,"renderable":0},{"_id":"source/images/sticky-packet/sender-sticky.png","path":"images/sticky-packet/sender-sticky.png","modified":1,"renderable":0},{"_id":"source/images/sticky-packet/solve-server-sticky.png","path":"images/sticky-packet/solve-server-sticky.png","modified":1,"renderable":0},{"_id":"source/images/task-completion-source/bg.jpg","path":"images/task-completion-source/bg.jpg","modified":1,"renderable":0},{"_id":"source/images/task-completion-source/pause-1.png","path":"images/task-completion-source/pause-1.png","modified":1,"renderable":0},{"_id":"source/images/task-completion-source/pause-2.png","path":"images/task-completion-source/pause-2.png","modified":1,"renderable":0}],"Cache":[{"_id":"source/images/rabbitmq-quarum/courgette.log","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1720774060906},{"_id":"source/_posts/daemonset.md","hash":"bb165cf091f0a25e1fab93fc06dcc7bd2ec4e71f","modified":1722592868923},{"_id":"source/_posts/TaskCompletionSource.md","hash":"a2bcfbda71ac8d8406e1bd14fa333169457384e5","modified":1717658556858},{"_id":"source/_posts/docker-1.md","hash":"3f9d81f24d238d3b9a48b5ec67c5a65fb52388f8","modified":1720255588285},{"_id":"source/_posts/docker-layer.md","hash":"f608b1c31fe24320a204f1473a25524dc90110b9","modified":1723448461339},{"_id":"source/_posts/dead-message.md","hash":"e0a8e83a589cd97cb599fd243d348f4b1896eb71","modified":1716628987803},{"_id":"source/_posts/hello-world.md","hash":"3c422ea24b75465e6ea2a80c268251ca0a03e042","modified":1714100836002},{"_id":"source/_posts/dump.md","hash":"fc0d11e98d4a2c35e8f590fc901c33ec87cf1654","modified":1715157478693},{"_id":"source/_posts/hello-world-bak.md1","hash":"1e16dbc0dbf8b18e83f47dbbdffd0d1f27cfe955","modified":1710398484836},{"_id":"source/_posts/docker-2.md","hash":"a75951a67f13186efc0b09411b6255a83af11df5","modified":1720444768360},{"_id":"source/_posts/garnet.md","hash":"9fa10e3a47f78d4b6f8465f3e49e33da56758f21","modified":1714100842478},{"_id":"source/_posts/organization-internal-loss.md","hash":"b157730ebdda6cfd58233ff8ec9d9bfed27d37b1","modified":1714100795957},{"_id":"source/_posts/https.md","hash":"00df307cec478b57c6b9ab848f2b3d2ef578098a","modified":1714100800272},{"_id":"source/_posts/js-signal.md","hash":"99254f370782596935a99c866ff0dffef867da63","modified":1730790518259},{"_id":"source/_posts/proxy.md","hash":"fbe68bb5c014a73c809edf55bd34ac75f88dc814","modified":1718931872131},{"_id":"source/_posts/quic.md","hash":"f69a826a8a6c38e5269bff4127f55bb5dce9f6df","modified":1724379707402},{"_id":"source/_posts/rabbitmq-quorum.md","hash":"01529732ac69c5892cb1c977a36b8093fed2fe84","modified":1720857305748},{"_id":"source/_posts/http.md","hash":"e538858062edce06c26c8060d05f61b3e6fe772b","modified":1714100804259},{"_id":"source/_posts/rabbitmq-basic.md","hash":"9d43ee83b6448cbc3cfd9e77099ab1ee31027684","modified":1720615377682},{"_id":"source/_posts/sticky-packet.md","hash":"e71dbd0f9ac05830a8921dda3ec1ea5e8723069c","modified":1724999441472},{"_id":"source/_posts/redis-interview-1.md","hash":"951b57d41f67b3f9287684d1808c63e0ab08023d","modified":1714102286087},{"_id":"source/images/daemonset/DaemonSets.png","hash":"b2d8cb6e9f9a3246d70a6c4f1fa6656c6128eb67","modified":1722580496257},{"_id":"source/_posts/similar-image-search.md","hash":"80b6ecb4440b108c26f92fd41d4f1d326f88eba5","modified":1717774298746},{"_id":"source/images/daemonset/daemonset-pods.png","hash":"ffc713e43daebc3db7fbcde65c154bfc0c4e5148","modified":1722586245355},{"_id":"source/images/daemonset/nodes.png","hash":"9ddeb9b6441cfee33edce7aa99af8058c7a291b1","modified":1722586074002},{"_id":"source/images/docker-1/bg.png","hash":"e3b82c04b261788b6c333288578220dad894e135","modified":1720252982915},{"_id":"source/images/daemonset/daemonset-1.png","hash":"30bd683b3eba29092f63bb3c3d1b3742a94706e4","modified":1722562440090},{"_id":"source/images/dead-message/bg.jpg","hash":"e0de32bdd097eeb58f534882e876a282606db679","modified":1716366165441},{"_id":"source/images/dead-message/delay_comsuption_1.png","hash":"c093bbb3f975f40087d037aa56b8fd32ed866332","modified":1716627815685},{"_id":"source/images/dead-message/dead-letter-3.png","hash":"d8017b10c2efd5448993b92f0a35783e4d0b71f7","modified":1716626485267},{"_id":"source/images/dead-message/delay_comsuption_2.png","hash":"f9b57ebe4ba7cefabad08a139f92e619fd1aae8f","modified":1716627676317},{"_id":"source/images/docker-layer/ls_upper.png","hash":"aa190ff2fa11cfcf0c125e79b71e9b5d161358a5","modified":1723443838820},{"_id":"source/images/docker-layer/tree.png","hash":"8650756f7321bd4e7a53e0525f3e42411b7d51b7","modified":1723443628297},{"_id":"source/images/docker-layer/layers.png","hash":"cf95861f382cab38dfcb0864099633592e85fc50","modified":1723432713503},{"_id":"source/images/docker-layer/merged.png","hash":"a35d1d9111feb7ed81e3279ef2f1f5c9bb8951d6","modified":1723443249117},{"_id":"source/images/dump/crash.jpeg","hash":"e25f4327f9073e01e8b1a3e13c209ca732880e15","modified":1714290837084},{"_id":"source/images/dump/windbg_3.png","hash":"47fa0c7ac253a9a44eef9bc6d5dce90d96445ba2","modified":1715068901454},{"_id":"source/images/garnet/client.png","hash":"4889111b6b22a0f07ed3e80b70ee4e1e99c8045e","modified":1712652420303},{"_id":"source/images/garnet/compare1.png","hash":"ed8a21697688433ffe376d2a4ccaa7ec53c667ff","modified":1712648062046},{"_id":"source/images/docker-layer/filesystem.png","hash":"969d25d9599c4bcc72ee3403e1805d7ad7a874e6","modified":1723428032741},{"_id":"source/images/garnet/compatible.png","hash":"1714c1d5f1c6fd0421b4594015595976b5fd4ee4","modified":1712567994543},{"_id":"source/images/garnet/connect.png","hash":"82d4fc4511b032c7c797018845ca40d83ac7aa9d","modified":1712650225409},{"_id":"source/images/garnet/custom-command.png","hash":"bea263307a51c77205885ace2c3060272e444339","modified":1712736760989},{"_id":"source/images/http/TCP-connection-1.png","hash":"588cade2c5e791bee0f282a6290889ba15c3a039","modified":1711091658444},{"_id":"source/images/garnet/running.png","hash":"3253e7a14adf9509baead2613151f614a0012ab5","modified":1712567881514},{"_id":"source/images/http/handshake-1.png","hash":"698f25b0696249dbbadbf1b71ea5e3e48b57348e","modified":1711100170452},{"_id":"source/images/http/http-keep-alive-header.png","hash":"d2b1f6ccc2903ffbd4308627c2562b42c80a2cb7","modified":1711435826469},{"_id":"source/images/http/http-request.png","hash":"4d29675c37a4cc0df885db03cff820aa3f98080c","modified":1710926387387},{"_id":"source/images/http/curl-header.png","hash":"e5c4a20f54045759a1a29f7f35a344d45ee51ecb","modified":1711013282028},{"_id":"source/images/http/perisitent-connection.png","hash":"0e16961aaa4851908823dccfa904d3f4f6989c08","modified":1711092222874},{"_id":"source/images/https/ca.png","hash":"a3f65f3b7f108a2e18c61d13c3024d761586a9ca","modified":1712826407187},{"_id":"source/images/https/handshake.png","hash":"9d2b92013eb6b78a0f3b84855a383b29962da2ba","modified":1713152131440},{"_id":"source/images/https/bg.jpg","hash":"9424b491fdae5f8c91344596469c3980217e2206","modified":1712821936174},{"_id":"source/images/https/expire.png","hash":"801009fef98fa9d46a677f153f097e6476c139e2","modified":1712824416637},{"_id":"source/images/https/security.png","hash":"e040846f476100e1ac38f67dec1fc9735978fc9f","modified":1713148972216},{"_id":"source/images/image-search/process.png","hash":"c1f5c3452b606dc8a510d9b3a5a24b330eff06eb","modified":1717772066200},{"_id":"source/images/image-search/bg.jpg","hash":"a02f0b66241373b0fb83610977010c41297c6985","modified":1718069912767},{"_id":"source/images/image-search/qdrant.png","hash":"0c42f079a8b35f9fe8da6c3b3cf3180e9d603c62","modified":1717773798375},{"_id":"source/images/internal-loss/depressed.jpg","hash":"8ff19e979ef211030d79fc29eca3bef0ed42f9e9","modified":1711678444570},{"_id":"source/images/js-signal/EventTarget.png","hash":"818561377792246188fd5e247e0de485c99b889e","modified":1730776254380},{"_id":"source/images/js-signal/EventTarget2.png","hash":"58db529e086abb315e24f6738d871e776e72f9c6","modified":1730777763048},{"_id":"source/images/js-signal/EventTarget3.png","hash":"e5f9ea6836e53d2a388a09cf54190253f5d4a467","modified":1730788409397},{"_id":"source/images/proxy/bg.jpg","hash":"c884b6efad5351ee2996fe0d18715fb27f7b3749","modified":1718931303461},{"_id":"source/images/proxy/reverse-proxy.png","hash":"57444303e4d4327cd1ebaedd3d954dfcf2486b69","modified":1718888319294},{"_id":"source/images/proxy/forward-proxy.png","hash":"49892dfa05b23599732f106b70b44fa95bc2eaa5","modified":1718888217801},{"_id":"source/images/proxy/transparent-proxy.png","hash":"e2bc2ee06dbfa33170ec3120277f21f4e3e503f9","modified":1718890992387},{"_id":"source/images/rabbitmq-basic/channel1.png","hash":"fcde762d9619fe15b3fbdbe32455dfee9214dee0","modified":1720580078238},{"_id":"source/images/rabbitmq-basic/channel2.png","hash":"f09e7365fd1026393f0b89777406570fbb1be70b","modified":1720580479287},{"_id":"source/images/rabbitmq-basic/fanout-exchange.svg","hash":"5e14973b4eba3986a1805c585260d34e781c512a","modified":1720612870539},{"_id":"source/images/rabbitmq-basic/exchanges-bidings-routing-keys.svg","hash":"ec548510fb86ab373be5decbb3f65896813d048b","modified":1720517279179},{"_id":"source/images/rabbitmq-basic/main.png","hash":"e45cabff6e1cc9ea8477412977a49277b9656faa","modified":1720530900322},{"_id":"source/images/rabbitmq-basic/direct-exchange.svg","hash":"e1e7e8648d3c479c2b4223af6be07e434ea62730","modified":1720612845887},{"_id":"source/images/rabbitmq-basic/fanout.png","hash":"6458eb591f42ff61e67364d480c4b2c0dc1ff3bf","modified":1720524567852},{"_id":"source/images/rabbitmq-quarum/normal.png","hash":"7a81405dc9d73b0a7cdff3b685c35853bad1cb1a","modified":1720679165151},{"_id":"source/images/rabbitmq-quarum/stream_error1.png","hash":"ce4c9e1a9a9da1cb4278e2e74be852611c8c265d","modified":1720855445532},{"_id":"source/images/rabbitmq-quarum/quarum1.png","hash":"e24787c731793ab83bc335c08dcf21060babd92d","modified":1720704401188},{"_id":"source/images/rabbitmq-quarum/quarum2.png","hash":"7c88c03d166aee001257f3fe29918c29ff0df8bb","modified":1720680123566},{"_id":"source/images/rabbitmq-quarum/stream_error2.png","hash":"0d84d8d3ae357383925c86c728d865ce461bce8b","modified":1720855694734},{"_id":"source/images/quic/head_of_line_blocking.png","hash":"2203cca89e72b24f13cc9774fb78ee64927f32ea","modified":1723801376313},{"_id":"source/images/quic/quic-logo.png","hash":"f2cf0868ef61bfe597981193c314327741c5a48e","modified":1724382247911},{"_id":"source/images/redis-interview/cache-penetration.png","hash":"17f21e18052f40f20189a31c4bfbf749a1dedcbc","modified":1714100540904},{"_id":"source/images/redis-interview/memory.png","hash":"37fadd91ec8573c6c30ec5fd32562f2c3d22d5a9","modified":1714031983730},{"_id":"source/images/sticky-packet/server-sticky.png","hash":"8a7a47f695c9d74f4bebb7cf444d221e59bc8923","modified":1724988818136},{"_id":"source/images/sticky-packet/bg.jpg","hash":"9a73ba1e1dfa83d5e79399fe25745e9c90915762","modified":1724999655551},{"_id":"source/images/redis-interview/recruitment.png","hash":"9da7eff910bfb50b7f11618614003b6153e71d98","modified":1713425715760},{"_id":"source/images/sticky-packet/sender-sticky.png","hash":"199862fcf0175fe9b9acca3c698c58482dd123c5","modified":1724987423202},{"_id":"source/images/sticky-packet/solve-server-sticky.png","hash":"0833d4fd870412068dc5b3515a60e9f078bd0ae9","modified":1724990256799},{"_id":"source/images/sticky-packet/solve-sender-sticky.png","hash":"9060a5391d9fe9f8a5b49dbda8ef182d7690e0c5","modified":1724998588917},{"_id":"source/images/task-completion-source/bg.jpg","hash":"762d9571bdc71e36879c00907cb524e825980694","modified":1718067987009},{"_id":"source/images/task-completion-source/pause-1.png","hash":"14d301e1283ad280dd8ea0525be0e5c38531ef74","modified":1717658041988},{"_id":"source/images/docker-1/configurations.png","hash":"c6f58a834400b5d6fff7c76249562888a908304c","modified":1720252449460},{"_id":"source/images/docker-1/multi-env.png","hash":"a8aa3cdee473ee5987c28a30c4def6b06b1c4708","modified":1720253343754},{"_id":"source/images/dead-message/dead-letter-2.jpg","hash":"424a4237b4485e845ed3e9e6e74ee1f34485d196","modified":1716542966790},{"_id":"source/images/dead-message/dead-letter-exchange-1.png","hash":"7b141675f4bd37c8d65a63b5d22612430b945720","modified":1716621402662},{"_id":"source/images/docker-2/inspect3.png","hash":"e8523ef78b9823458520eb25300303381b046a8e","modified":1720441204166},{"_id":"source/images/dump/bg.png","hash":"32c7ad31ef1117233e7691e74198041f62870e63","modified":1714290251488},{"_id":"source/images/garnet/1.png","hash":"0d8a64004413ec34a334cce4925372781b3c88b0","modified":1712566365601},{"_id":"source/images/dump/windbg_4.png","hash":"5618b95c756aab451803e23e9c0f77b5fa94e6b4","modified":1715069009388},{"_id":"source/images/garnet/log.png","hash":"0c32a044823dd2b85353c2816c9109c9df0626b4","modified":1712721260633},{"_id":"source/images/http/auto-disconnect.png","hash":"6eb07b19f5350b86e32c41503abdef786d1cc8a3","modified":1711368567428},{"_id":"source/images/http/handshake-2.png","hash":"f50dd3fab7ff21a20cd91622aefb077b7ec74b89","modified":1711353457535},{"_id":"source/images/http/timeout-auto-disconnect.png","hash":"87f74686dc596abb5be91260a40dcf38ed3d0d17","modified":1711433208748},{"_id":"source/images/http/request-methods.png","hash":"5914a2642fc3c771aaddbb5a4db79d020c75ba27","modified":1710917201189},{"_id":"source/images/https/client-hello.png","hash":"65039f3b5656ce343d9c36842642aedef464f9d1","modified":1712827328350},{"_id":"source/images/internal-loss/996.jpg","hash":"d712414d1167ea1a5790683d549a3dbf56cc3c8c","modified":1711684344049},{"_id":"source/images/internal-loss/20231109_sy_01.jpg","hash":"f637ac12cf901b7e557077687482f7232bbc2a72","modified":1711685199687},{"_id":"source/images/rabbitmq-basic/rabbitmq-headers-exchange.svg","hash":"b9983fdc354c45500fcfe57e9f78ab4cb88a2c4d","modified":1720612881431},{"_id":"source/images/rabbitmq-quarum/stream_offset.png","hash":"156f277e1c766644c8704892454397fc113f153d","modified":1720856674850},{"_id":"source/images/rabbitmq-basic/topic-exchange.svg","hash":"ed3868a0efc180866dca5c7ba33cb6797ad96bc5","modified":1720612864235},{"_id":"source/images/quic/handshake.png","hash":"38daab0f33947a35e7caacf41e3e2979cc854b89","modified":1723797528048},{"_id":"source/images/quic/quic.png","hash":"5a459deaef952ec228d3515dfdbf47048fc05c5c","modified":1724379367865},{"_id":"source/images/task-completion-source/pause-2.png","hash":"f681d83790b004e1703e18560c2f7d2db0cd6d01","modified":1717658059375},{"_id":"source/images/redis-interview/cache-avalanche.png","hash":"8bcdb1787aa12c08febeb8c2324cf7fa9c6d3c02","modified":1714100497420},{"_id":"source/images/redis-interview/cache-breakdown.png","hash":"de31f8ba0958f9428c1148746206f8351fa1bf18","modified":1714100525728},{"_id":"source/images/dump/windbg_2.png","hash":"e55722d89679167f37e0b851a53e27ae989663f8","modified":1714439116512},{"_id":"source/images/http/auto-disconnect2.png","hash":"d96b55fe2a3d138263e29ec9ba3a171b78eaf003","modified":1711356920847},{"_id":"source/images/rabbitmq-basic/default-exchange.png","hash":"da48c3eae865c3758c2998b9234193ef1c52e26c","modified":1720515775722},{"_id":"source/images/docker-2/before.png","hash":"4d6df539061278c5a371d63bbf494a54ac390588","modified":1720419780264},{"_id":"source/images/https/encrypted.png","hash":"51f01f7c79cbb8e5ace366b423a46c677483d4f3","modified":1712827358003},{"_id":"source/images/dump/windbg_1.png","hash":"fec01b96435a46269b0a241c8feb13764458b0e9","modified":1714438955774},{"_id":"source/images/docker-2/after.png","hash":"2aa4ca9b53dc8a4270e3174115fcf96887185f64","modified":1720439019007},{"_id":"source/images/https/cipher-suites.png","hash":"e9faeff8e36d3efd82a5a0800c85a8e23d6ebf56","modified":1713149632927},{"_id":"source/images/https/negotiated-cipher-suite.png","hash":"32d7a6f6ad24e6c5755d2ba2626e0ba71520fd50","modified":1713149675775},{"_id":"source/images/redis-interview/bg.png","hash":"e5be0650aa2343b4a62218b58ebae10c4f4b9ba6","modified":1714101428369},{"_id":"source/images/daemonset/bg.png","hash":"b1603478da28b1f0e9b0f1e54d6eca8e30537b4b","modified":1722579353097},{"_id":"themes/archer/layout/_partial/comment/custom.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1688482306000},{"_id":"source/images/quic/tcp.png","hash":"1fba23e6486468abf1e4baa60d8a2cf85c5685cf","modified":1724377517189},{"_id":"source/images/js-signal/switch-theme.gif","hash":"8e8f0c1a5add7925ac6f7f5931d43a6f829373b7","modified":1730790295869},{"_id":"themes/archer/.babelrc","hash":"078678843ebb6992f0cc44304faa6f1cb082bd4a","modified":1688482306000},{"_id":"themes/archer/.eslintignore","hash":"304e696987e3f31cd0a7a13a835d58d8bda3aa6c","modified":1688482306000},{"_id":"themes/archer/.gitignore","hash":"9a5e5d0a05fc5bee9bf00a0c5cefc712b4bf0904","modified":1688482306000},{"_id":"themes/archer/.gitattributes","hash":"82c1a621642d5b620275ae1ed59845c3f7015a64","modified":1688482306000},{"_id":"themes/archer/.editorconfig","hash":"3a7f38d9586f73ed1c46cfbc9839b3465ec57d7c","modified":1688482306000},{"_id":"themes/archer/.eslintrc.json","hash":"352a07b94efa124a5658b502bf973683be09fd00","modified":1688482306000},{"_id":"themes/archer/CHANGELOG.md","hash":"6fbf3e5e8ed6ae6fb68fd74bfd2b53d99db4b1fd","modified":1688482306000},{"_id":"themes/archer/.prettierrc.js","hash":"bae1d8dab7bf8b68207386f366e092778940540c","modified":1688482306000},{"_id":"themes/archer/.prettierignore","hash":"29648a30c14f6df709eb6610f506c82825910cc8","modified":1688482306000},{"_id":"themes/archer/LICENSE","hash":"0da0c361bf299375739c6b668a44af0f5faf37bb","modified":1688482306000},{"_id":"themes/archer/package.json","hash":"81af75826e854ac80f6337dc4f1ce4b51f066b0b","modified":1723104164550},{"_id":"themes/archer/_config.yml","hash":"bf3d3444da07f4901d77f3455af63aeea406d8f8","modified":1723520595061},{"_id":"themes/archer/README.md","hash":"63eb0f874bc056d407ee343f853adee9a5765434","modified":1688482306000},{"_id":"themes/archer/webpack.dev.js","hash":"7c740341894bd584f72145512a58703bb134ea60","modified":1688482306000},{"_id":"themes/archer/gulpfile.js","hash":"ee1ad57aa5113a084091fd86fca2c34e1b9e4b95","modified":1688482306000},{"_id":"themes/archer/dev/archer.sh","hash":"4065c4e55462d5ecf016464adea0d1db967ef4b4","modified":1688482306000},{"_id":"themes/archer/webpack.prod.js","hash":"a34abc06d6cd8fa4e267069468726322a3656e2b","modified":1688482306000},{"_id":"themes/archer/webpack.config.js","hash":"e090744d8e7a0d0906d1d6b8192eb906092d1e9b","modified":1688482306000},{"_id":"themes/archer/languages/en.yml","hash":"5a1a85fed95dab4f01671714ee8cc5420936c05f","modified":1688482306000},{"_id":"themes/archer/languages/default.yml","hash":"e937791c5080868c3abe20bab4cf266a342b5922","modified":1711010720209},{"_id":"themes/archer/layout/404.ejs","hash":"9137c0b1153ca8cd32e60a38fd79b7e4b91c8bf4","modified":1688482306000},{"_id":"themes/archer/docs/develop-guide-en.md","hash":"c62510d3d14b38126b5a86ff30416cb71abc1d9a","modified":1688482306000},{"_id":"themes/archer/docs/README-en.md","hash":"f5e40c5803071bd6dafc94070c6939aa0c02d061","modified":1688482306000},{"_id":"themes/archer/docs/develop-guide-zh.md","hash":"451b304c1a5d081313f0532a4f5665f0855d4cfd","modified":1688482306000},{"_id":"themes/archer/layout/about.ejs","hash":"748786bebad03b1ef79c551f26522fa2bee1b9dd","modified":1688482306000},{"_id":"themes/archer/layout/site-meta.ejs","hash":"562e446a742fde07e0880343d5693bf8cb0dec23","modified":1688482306000},{"_id":"themes/archer/layout/index.ejs","hash":"093f8dbe875cad94b9618f181d1b5621d8874b19","modified":1688482306000},{"_id":"themes/archer/.github/ISSUE_TEMPLATE/-----------bug--help-wanted-or-bug-report-.md","hash":"55e843652d99fae32534a7630e698d2394020baf","modified":1688482306000},{"_id":"themes/archer/layout/_partial/algolia.ejs","hash":"c7bf50dd6e60fd8e8dfbeab9960172359af7307e","modified":1688482306000},{"_id":"themes/archer/.github/ISSUE_TEMPLATE/-----other-issue-.md","hash":"05f24b2df012808f6410f1ef2230d4fd1a5d6cf5","modified":1688482306000},{"_id":"themes/archer/.github/workflows/deploy-demo-page.yml","hash":"91c065ee0ec29f7bb10263fefa6f3072bc493a38","modified":1688482306000},{"_id":"themes/archer/layout/post.ejs","hash":"d421aba0ab93e2b7a22d060da4c56441bf97cdb9","modified":1688482306000},{"_id":"themes/archer/layout/_partial/base-footer-fixed.ejs","hash":"e4dbde6594c0c2d1c5de71ddf968be0879ceddb7","modified":1688482306000},{"_id":"themes/archer/.github/ISSUE_TEMPLATE/-----feature-request-.md","hash":"edb6b06041660beb656fd5e4062d5a21577cbb3a","modified":1688482306000},{"_id":"themes/archer/layout/layout.ejs","hash":"23235793df01cf129ae747293172dab307e2b9ac","modified":1725011322544},{"_id":"themes/archer/layout/_partial/base-background-image.ejs","hash":"18365516cd8819de853716f0d47a72a60a5edc46","modified":1688482306000},{"_id":"themes/archer/layout/_partial/base-footer.ejs","hash":"2afd877a9ae9509622a6163094ae27df17e36184","modified":1723102105116},{"_id":"themes/archer/layout/_partial/base-social.ejs","hash":"0190f06c2f0345cec00eba2074bbfd1b56a7fdc9","modified":1688482306000},{"_id":"themes/archer/layout/_partial/base-header.ejs","hash":"57d1ae0fd6f9f1ab52a64c44a8ae17ee71de22ef","modified":1688482306000},{"_id":"themes/archer/layout/_partial/base-title-tags.ejs","hash":"1d5a95782ffc382fdb6b1239b3b97db125984fa0","modified":1688482306000},{"_id":"themes/archer/source/assets/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1688482306000},{"_id":"themes/archer/layout/_partial/base-head.ejs","hash":"f4b8e36a8ae882f3b1e194811b0c5a370913270f","modified":1725011450243},{"_id":"themes/archer/layout/_partial/base-preload-polyfill.ejs","hash":"d046322674052b0667775dca0886f14e0d812897","modified":1688482306000},{"_id":"themes/archer/layout/_partial/base-profile.ejs","hash":"f63032391dd75905b6663628a9ca231fa0283350","modified":1688482306000},{"_id":"themes/archer/source/assets/example_qr.png","hash":"cce20432c34875f4d9c6df927ede0fc0f00bb194","modified":1688482306000},{"_id":"themes/archer/layout/_partial/custom-font.ejs","hash":"bc6bfda53f8856e1473263a44fd861e96cc00719","modified":1688482306000},{"_id":"themes/archer/source/assets/loading.svg","hash":"45be17d07697d604d8981890eb21e308530c7a38","modified":1688482306000},{"_id":"themes/archer/source/assets/wechat_qr.jpg","hash":"20763d666624facc585e34645018deadb343b4b5","modified":1705482083315},{"_id":"themes/archer/source/assets/beian.png","hash":"a99df13e8eb11db86edebf6e5ac246eb59f4b3c4","modified":1688482306000},{"_id":"themes/archer/source/css/dark.css","hash":"4db211216f16a5e66d4d499158f4005a1bbb39f5","modified":1688482306000},{"_id":"themes/archer/source/css/mobile.css","hash":"acb0dfcce26ec93f59c6ec4936006abbe8daefee","modified":1688482306000},{"_id":"themes/archer/source/avatar/Jason.jpg","hash":"0eae332ea91f9e04b54f35d2ed1b17b5b37aee64","modified":1710397722571},{"_id":"themes/archer/source/assets/favicon_bak.ico","hash":"8b200c575d273d41a179c102442e191414e74eae","modified":1688482306000},{"_id":"themes/archer/source/css/style.css","hash":"f08b1ec3a5fe1bf936401a238d55e0487296b42c","modified":1688482306000},{"_id":"themes/archer/layout/_partial/intro-height.ejs","hash":"7b8b078b1c1e5b216e46b32a0cab67330c92c734","modified":1688482306000},{"_id":"themes/archer/source/avatar/Misaka.jpg","hash":"74a0372523f98dfbba992bf80642e160d04dc9b1","modified":1688482306000},{"_id":"themes/archer/source/css/dark.css.map","hash":"f49556935deae49df3158c2eb2265464129ef978","modified":1688482306000},{"_id":"themes/archer/source/css/mobile.css.map","hash":"c9f9dade45b119ae2eb7a93be0160baef4d494f8","modified":1688482306000},{"_id":"themes/archer/source/font/Source Sans Pro.woff","hash":"a6722c9b6439b7a020a9be3d3178970757a9265c","modified":1688482306000},{"_id":"themes/archer/source/font/Source Sans Pro.woff2","hash":"da65f527a8da65d5eb6721626d28cfdb46ab104a","modified":1688482306000},{"_id":"themes/archer/src/js/customFontLoader.js","hash":"98bb3a1c0f69bc2675bfa6579df2dde38ba6fded","modified":1688482306000},{"_id":"themes/archer/src/js/fancybox.js","hash":"6dfc8015d6000c76806424876f5472f39e5485af","modified":1688482306000},{"_id":"themes/archer/src/js/browser.js","hash":"c56e0094a04d6f20564f8f0da1496cb7631d4dc2","modified":1688482306000},{"_id":"themes/archer/src/js/dark.js","hash":"2cd243df8593b18a1a293f483d2db18503c53547","modified":1688482306000},{"_id":"themes/archer/src/js/main.js","hash":"658565fbf20adc5b9b237a53c973d0685ce60202","modified":1688482306000},{"_id":"themes/archer/src/js/mobile.js","hash":"4ae6837e18b729f85b5097867fc742ba2d1edf25","modified":1688482306000},{"_id":"themes/archer/src/js/fontawsome.js","hash":"43e852899ee1bc22495253428a2ff3bdedf89882","modified":1688482306000},{"_id":"themes/archer/src/js/scroll.js","hash":"3017b329329888b287ad233831138428475749be","modified":1688482306000},{"_id":"themes/archer/source/lib/webfontloader.min.js","hash":"4c69aeb4e4f355912503d1c460e8e7aa6ea6963e","modified":1688482306000},{"_id":"themes/archer/src/js/search.js","hash":"0bf92b51fef092989f4fe16fb7ef7724d11e9f58","modified":1688482306000},{"_id":"themes/archer/src/js/sidebar.js","hash":"2518f2b0b7947530851e6c73245dddc96a618a08","modified":1688482306000},{"_id":"themes/archer/src/js/share.js","hash":"c2e6a3d8d6883cde0c67484daca5e742ebb8e0d1","modified":1688482306000},{"_id":"themes/archer/src/js/tag.js","hash":"395db7eb2d09e2df6eefcf3f4c7da5cd809a6221","modified":1688482306000},{"_id":"themes/archer/src/scss/_common.scss","hash":"e80acb4f0049d24260f0a32a301f985ae7e166b8","modified":1688482306000},{"_id":"themes/archer/src/js/util.js","hash":"e49b30f6ba82d5183d005fc0192d2d673969586b","modified":1688482306000},{"_id":"themes/archer/src/js/toc.js","hash":"96a7e07d1976eb29a77799ac2b7abb47907f4b45","modified":1688482306000},{"_id":"themes/archer/src/js/initSidebar.js","hash":"c9c030a451ed394934c1858c7d55ec5a7b588305","modified":1688482306000},{"_id":"themes/archer/src/scss/_normalize.scss","hash":"a2dbeb38ad08bb8975856d75954cc697bf8e5ff7","modified":1688482306000},{"_id":"themes/archer/src/js/init.js","hash":"dee0a1c959bd4dc3953428b1b2137f42bc659b32","modified":1688482306000},{"_id":"themes/archer/src/scss/dark.scss","hash":"739af46f0ef8c0c89c3e78ec577e844678f737b5","modified":1688482306000},{"_id":"themes/archer/src/scss/_variables.scss","hash":"01e5cab2b5fc686c52145d65229f17db13a3cc54","modified":1688482306000},{"_id":"themes/archer/src/scss/style.scss","hash":"b10b9a44efaa293b7ac220e66c963dca04ad4bc7","modified":1688482306000},{"_id":"themes/archer/source/scripts/dark.js","hash":"28ba818b2ab8a9454a52fe2710b5a8a81a195e4d","modified":1688482306000},{"_id":"themes/archer/src/scss/mobile.scss","hash":"2b542af943a8502aae26362dd2af1fbcf68eac1c","modified":1688482306000},{"_id":"themes/archer/source/scripts/dark.js.map","hash":"feb9e1905c4b313b839c1c3b69ad61c05f265a9a","modified":1688482306000},{"_id":"themes/archer/source/scripts/customFontLoader.js.map","hash":"702a44b0b1b450263592bfb1199c8d36ea9834a2","modified":1688482306000},{"_id":"themes/archer/source/scripts/main.js.LICENSE.txt","hash":"959bfc660011bc6a0800fe9e7974080f64c062aa","modified":1688482306000},{"_id":"themes/archer/src/scss/_mixin.scss","hash":"78da2632e7150baa0fd1f6d04fc59ca5e304903d","modified":1688482306000},{"_id":"themes/archer/source/scripts/search.js.LICENSE.txt","hash":"2c9b607ded909550f2ed2d0f2e7271781d9f78d9","modified":1688482306000},{"_id":"themes/archer/source/scripts/share.js","hash":"2210dd8dacea4f1ca11c0047dfafd0a170abd953","modified":1688482306000},{"_id":"themes/archer/source/scripts/customFontLoader.js","hash":"7c2f03fbd2b8340b77b1b02778a34e5ac10b560c","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/gitment.ejs","hash":"eda79ada5171ed44e4f3ae4d8a345ad2c7adb2df","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/changyan.ejs","hash":"cc02b3cf9586135d2d7f822c7ad97d81fdf6d4e5","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/utteranc.ejs","hash":"f4ec58c74e6870b8c22032ad3a3c1ee33e5ec41d","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/livere.ejs","hash":"d65d9372fca4b316b94ae511f8ccfb0b92d7b065","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/gitalk.ejs","hash":"840279fd3e21dc1cdb1932fe4d9a3be5f670e764","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/valine.ejs","hash":"24cd7b9e28ceb4b2083ddccce26517de64b35119","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/disqus.ejs","hash":"0f0612ce9ca5c3dc349153a87fdc9dba5f93c52c","modified":1688482306000},{"_id":"themes/archer/layout/_partial/critical-css/critical-style.ejs","hash":"e67a7a2f6bcbfd97e95577446872e217e0c48e80","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/youyan.ejs","hash":"2f4ef49a74a8d63310af60ecda6d765b8c386ff4","modified":1688482306000},{"_id":"themes/archer/layout/_partial/comment/waline.ejs","hash":"c2208d6f05490bbf1b35cdf1519a39933212c33e","modified":1688482306000},{"_id":"themes/archer/layout/_partial/math/mathjax.ejs","hash":"84c40a07765e95213045e9b9f7a8c9aaa9c69161","modified":1688482306000},{"_id":"themes/archer/layout/_partial/sidebar/sidebar-categories.ejs","hash":"02f407d9f9968d228a6a47f2a283b8cf41836a1a","modified":1688482306000},{"_id":"themes/archer/layout/_partial/sidebar/base-sidebar.ejs","hash":"bdf08beebbe454da9d4c55b35efd317d5f222be5","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_common-dark.scss","hash":"fc03470312c57a39bc131a1e86cdd3ea2ddb164a","modified":1688482306000},{"_id":"themes/archer/layout/_partial/script/font-loader.ejs","hash":"0473335774025d185dcbaf641496b25a8f33f7af","modified":1688482306000},{"_id":"themes/archer/layout/_partial/sidebar/sidebar-tags.ejs","hash":"469455994771da166ddecb4839efa9ef28f2775d","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_404.scss","hash":"9e5cb20871e5bf1af4cf50694a73bd7c9fe64685","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_algolia.scss","hash":"fd7716d8559a9f58f7caef576c553ca7ba1a85e1","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_post-page.scss","hash":"7583c8c2004e333c5b94e4b868ac778357e0d21e","modified":1688482306000},{"_id":"themes/archer/layout/_partial/sidebar/sidebar-archives.ejs","hash":"6360da867c23b8daa5e34e62c5c5552e2974e360","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_algolia-dark.scss","hash":"e9ea52ca5410c6a6eb53d2a6de1419d3db97d8ca","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_index-page.scss","hash":"91dc2a0c1ca8d25b1f27d91fa1c81ceb5ff8c3bc","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_index-page-dark.scss","hash":"4c1406e82b2d4503e027443f64f0984fe0942e1d","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_post-page-dark.scss","hash":"d61059785c72c626990f5b473dc3570cb52c0d73","modified":1688482306000},{"_id":"themes/archer/src/scss/_mobile/_partial/_index-page-mobile.scss","hash":"2d166bb6f234b8773a9ea12457b10e94902a32f1","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_post/_writing-enhance.scss","hash":"4cb495c64d144b2bcf225f2b87641017bd652e66","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_comment/_gitalk.scss","hash":"341bb251987f30221936e36b44374b2b5ce0d218","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_post/_code.scss","hash":"504f9fdb723c7b287d958211189d25919ac592f6","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_partial/_footer.scss","hash":"4aafefa6834c8a8583c1cdace620a31306676a57","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_partial/_footer-fixed.scss","hash":"1eb918f6c16054ef2b53b9eea60c751ad89bbd55","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_partial/_header.scss","hash":"ce683553806293fea0466f363b18de0ee341dd4e","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_partial/_paginator.scss","hash":"67c2e697a5fbb3b8006cf358ea45eb7f75b496f8","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_partial/_intro.scss","hash":"4567b9081f063e5fb388b0671f3bc322bdc9acfa","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_sidebar/_sidebar-archive.scss","hash":"a7374f46ca31bf8ebf5bafea909100921d0c52a4","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_partial/_profile.scss","hash":"4771add895f8a47917ae2d0d34b92cb327329bf1","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_partial/_scrollbar.scss","hash":"424c08f4acc3f643567f138ffea7d8337791d2c4","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_comment/_gitalk-dark.scss","hash":"57accaee4bb5b502d5d3e94c7981ac6996804cf0","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_sidebar/_sidebar.scss","hash":"b2870a9cdaea9b9c8426d406d6859a8f3f1a995f","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_footer-dark.scss","hash":"d074a8fef75ba626dd3448cc42290a8c722fd182","modified":1688482306000},{"_id":"themes/archer/src/scss/_partial/_sidebar/_sidebar-tags.scss","hash":"93cc82cb56663e83e90fbd6fe31ffdd38e694f3b","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_footer-fixed-dark.scss","hash":"f4e3eb7aa19c1061b5d9df4f6a7745902e5843f2","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_header-dark.scss","hash":"ed815d959a37cccdf9137ace91c68bea8ca922c2","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_post/_code-dark.scss","hash":"9ded8203699f816558fd1493a3ce7cf3d38818e9","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_profile-dark.scss","hash":"c0fe68f6e9c196157adc71fea0d97f6f70f0a31b","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_sidebar/_sidebar-archive-dark.scss","hash":"79b7548214339807ff713f0c7454a227d24d6d0d","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_sidebar/_sidebar-dark.scss","hash":"8e77738f83a425eebb00513ee98e487fe71fdc22","modified":1688482306000},{"_id":"source/images/hello-bg.png","hash":"f70f2a6805ceb4ab1175e391c03923b7264bc431","modified":1705386424945},{"_id":"themes/archer/src/scss/_mobile/_partial/_sidebar/_sidebar-tags-mobile.scss","hash":"b5c62234defe693b4cfa65bda188d71c937eeaf9","modified":1688482306000},{"_id":"themes/archer/src/scss/_dark/_partial/_sidebar/_sidebar-tags-dark.scss","hash":"6621db2ff1182e3cd14286af4b8f3d8c5bd14e2a","modified":1688482306000},{"_id":"themes/archer/src/scss/_mobile/_partial/_post/_writing-enhance-mobile.scss","hash":"9e714c1cdc61a4ebd5510667e87e879d0b14de67","modified":1688482306000},{"_id":"themes/archer/source/assets/favicon.ico","hash":"c136618e070daf370da961ac730973293a088b9e","modified":1710382119333},{"_id":"themes/archer/source/css/style.css.map","hash":"dbe8f8c1fccf8bd9d28ecf3874036a2281319aa0","modified":1688482306000},{"_id":"themes/archer/source/font/Oswald-Regular.ttf","hash":"965d729546a43a8490ad4cf33c25ac475682100c","modified":1688482306000},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff","hash":"12eef75e1ad3eca9dae42b65505010ce4464a315","modified":1688482306000},{"_id":"themes/archer/source/lib/jquery.min.js","hash":"ad886e472b3557f3dc7dfa2bc43468ab8d1cef5b","modified":1688482306000},{"_id":"themes/archer/source/intro/post-bg.jpg","hash":"525fafb2238c27754d8fa751f143ff1de9b8482d","modified":1688482306000},{"_id":"themes/archer/source/intro/about-bg.jpg","hash":"ab388276822417cc4e703312c14e20280ec783b3","modified":1688482306000},{"_id":"themes/archer/source/scripts/share.js.map","hash":"1e018aa465800a066480e33c848f380880af6743","modified":1688482306000},{"_id":"themes/archer/source/scripts/search.js","hash":"ac8e9d130ea410832a421d661898abee63bd8e67","modified":1688482306000},{"_id":"source/images/https/ca2.png","hash":"e71ae267fc6a9eda8943e4881e2f408b0a84055f","modified":1712827074795},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff2","hash":"f5991289ec17884cb641da0646d278d36702a190","modified":1688482306000},{"_id":"source/images/js-signal/responsive.gif","hash":"32b125a785deeae5ffac981705d6f896369e0f1b","modified":1730450652968},{"_id":"source/images/docker-2/inspect1.png","hash":"e818b04708ae3c4ffa2ca0e3e890c5d2d4c0bb05","modified":1720441093812},{"_id":"source/images/docker-2/inspect2.png","hash":"30515858e2dddad39c76f016c55a02af8f639856","modified":1720441069919},{"_id":"source/images/image-search/images.png","hash":"b2a77e00a2290543613f0df77f8c30337c91f441","modified":1717681798910},{"_id":"themes/archer/docs/snap.png","hash":"0b2a8bf016f6eed576abfdcdb7dcf8de51c12562","modified":1688482306000},{"_id":"themes/archer/source/intro/index-bg.jpg","hash":"96b52e177b8bc53e64ec6ee1e10b2b6a4e13083b","modified":1688482306000},{"_id":"themes/archer/package-lock.json","hash":"9c9404949ccef92a95c7ca7fb85907fec5584d2d","modified":1730275372398},{"_id":"source/images/image-search/search.gif","hash":"eb44e6dcab6b4292eb95ef63cbf64035ed01c878","modified":1717770772367},{"_id":"themes/archer/source/intro/404-bg.jpg","hash":"3afb5bb26f4ff0bd0e0a28df955c8aa7d746d3c5","modified":1688482306000},{"_id":"themes/archer/source/scripts/main.js","hash":"11fd75dddcbef7157fbfb8717b3463a80fda1fb3","modified":1688482306000},{"_id":"themes/archer/source/scripts/main.js.map","hash":"79d928070b7e5333ca241c5563ab4fe9cab31b74","modified":1688482306000},{"_id":"themes/archer/source/scripts/search.js.map","hash":"bd469588b3bee82b3cf72b72d447c854f4d76875","modified":1688482306000},{"_id":"source/images/rabbitmq-basic/fanout.mp4","hash":"132a8c24996e91d19467bff53d9fb453c609cb79","modified":1720611325113},{"_id":"source/images/rabbitmq-basic/vro2s-b2mub.gif","hash":"70b8ce43edd1599dd11a8c8dd529c26405323082","modified":1720612469268},{"_id":"source/images/rabbitmq-basic/16elk-ujaxc.gif","hash":"0b01075739b5d1b96d35a878bf55ff2575b50d41","modified":1720527427526},{"_id":"public/2024/10/30/js-signal/index.html","hash":"bc28c8faa9183cf5e7db6b8b78528fc37aeab624","modified":1730790651183},{"_id":"public/2024/08/28/sticky-packet/index.html","hash":"f4229bdc4070488a77abdc1db9ed7b36e37dcb17","modified":1730790651183},{"_id":"public/2024/08/16/quic/index.html","hash":"bf12915159df7c62d67d2746b1aec33134b7f510","modified":1730790651183},{"_id":"public/2024/08/08/docker-layer/index.html","hash":"798ac7949905418f525f3b8b9d25fabf41cf76d1","modified":1730790651183},{"_id":"public/2024/08/01/daemonset/index.html","hash":"54b368f7a033953f043301ca8392d0a89b1b1fb8","modified":1730790651183},{"_id":"public/2024/07/11/rabbitmq-quorum/index.html","hash":"c526f7838b30f39e48a5916ecf60d52c767da3d5","modified":1730790651183},{"_id":"public/2024/07/09/rabbitmq-basic/index.html","hash":"b2d93769dcf9342c6f3fc5cce168973ec2e50ae3","modified":1730790651183},{"_id":"public/2024/07/08/docker-2/index.html","hash":"a27b81708ef55e691bddaf64adde8c5ed00ef48a","modified":1730790651183},{"_id":"public/2024/07/05/docker-1/index.html","hash":"a25068458050c8b8868c945e723b84e860145680","modified":1730790651183},{"_id":"public/2024/06/20/proxy/index.html","hash":"7ab73cc463288675ffb7fcfa0e6baa2a64bd5167","modified":1730790651183},{"_id":"public/2024/05/30/similar-image-search/index.html","hash":"2968066fe302a3f037de628646c1fc20e3d6a6da","modified":1730790651183},{"_id":"public/2024/05/30/TaskCompletionSource/index.html","hash":"615f82b21feb0af99116016f97869a40991bacd4","modified":1730790651183},{"_id":"public/2024/05/22/dead-message/index.html","hash":"d3df6940ff244ec1dde283b38a0b6db7e82b7c19","modified":1730790651183},{"_id":"public/2024/04/28/dump/index.html","hash":"cbd0536e3a4863d373ea1e5f51c6b8590670e454","modified":1730790651183},{"_id":"public/2024/04/18/redis-interview-1/index.html","hash":"41ab218278c44a89e8027515a6a8d52d9b1e5a4f","modified":1730790651183},{"_id":"public/2024/04/11/https/index.html","hash":"a8a5789543445ef42dba835a7b1e16827edea658","modified":1730790651183},{"_id":"public/2024/04/07/garnet/index.html","hash":"05b093453a8a1b5dadcb7446b717b38eef01f856","modified":1730790651183},{"_id":"public/2024/03/28/organization-internal-loss/index.html","hash":"6741bcded5e528d530326355f8fbd0ffa37fd223","modified":1730790651183},{"_id":"public/2024/03/19/http/index.html","hash":"cb836cd521d201890b88fcd345ecbbd030b776e9","modified":1730790651183},{"_id":"public/2024/03/13/hello-world/index.html","hash":"5330353fb714e636f2b8bacacb1d539f23a0e200","modified":1730790651183},{"_id":"public/tags/dump--/index.html","hash":"76c4c69ba48a927ffda9151be62e824e41696ec8","modified":1730790651183},{"_id":"public/tags/Garnet--/index.html","hash":"95139200b27a667c9b5cb2cba852de416aa670c1","modified":1730790651183},{"_id":"public/tags/https-http-ssl-tls/index.html","hash":"651c6aa06119c133088dde95f35c8fc34e41e51d","modified":1730790651183},{"_id":"public/tags/-/index.html","hash":"e8f9715ef513e1e4c4665ee3d3a1f54de8d3b377","modified":1730790651183},{"_id":"public/tags/redis--/index.html","hash":"21063a2ce96616c389ab2e835e29efd0835bad27","modified":1730790651183},{"_id":"public/tags/http-http-Connection/index.html","hash":"ba2cc2426c29abb1a5e48f8349a5cd5845c033d5","modified":1730790651183},{"_id":"public/archives/index.html","hash":"da84e7f3871031682ebe4c82a60f2ada19d0a0dc","modified":1730790651183},{"_id":"public/archives/page/2/index.html","hash":"eb1c9b362f499db802e6dafe53b2249828fe6831","modified":1730790651183},{"_id":"public/archives/2024/index.html","hash":"24f9fc9ebdfb6b1ebadaa0256792e07a4c88bcf0","modified":1730790651183},{"_id":"public/archives/2024/page/2/index.html","hash":"3ac51110b011235953f8731342aaf9358a10c938","modified":1730790651183},{"_id":"public/archives/2024/03/index.html","hash":"bccfe2e845ff227540f81998afd71dee7f2032dc","modified":1730790651183},{"_id":"public/archives/2024/04/index.html","hash":"9f804a86faf22c25387e7ed802218016b6c4bea2","modified":1730790651183},{"_id":"public/archives/2024/05/index.html","hash":"9708d915d5c3bfda6b1dd0955b8d4f8b471db20e","modified":1730790651183},{"_id":"public/archives/2024/06/index.html","hash":"80b05c899e602cca967e05e337690b76b4acc660","modified":1730790651183},{"_id":"public/archives/2024/07/index.html","hash":"c578cbdcc74735e82df80f69f492216edbf59b0d","modified":1730790651183},{"_id":"public/index.html","hash":"713879bdede98c162b8c678dbc7051353ee53d23","modified":1730790651183},{"_id":"public/archives/2024/08/index.html","hash":"0cfb9d244d01e06d5c9ea3d10802f7b778a5656b","modified":1730790651183},{"_id":"public/archives/2024/10/index.html","hash":"0414bbaa8951d754e87199c9115df948c8b8a14a","modified":1730790651183},{"_id":"public/page/2/index.html","hash":"3aa1c1457a4a3ff4ff4a754361cfd0d98010978d","modified":1730790651183},{"_id":"public/assets/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1730790651183},{"_id":"public/assets/example_qr.png","hash":"cce20432c34875f4d9c6df927ede0fc0f00bb194","modified":1730790651183},{"_id":"public/assets/beian.png","hash":"a99df13e8eb11db86edebf6e5ac246eb59f4b3c4","modified":1730790651183},{"_id":"public/assets/loading.svg","hash":"45be17d07697d604d8981890eb21e308530c7a38","modified":1730790651183},{"_id":"public/assets/wechat_qr.jpg","hash":"20763d666624facc585e34645018deadb343b4b5","modified":1730790651183},{"_id":"public/css/dark.css.map","hash":"f49556935deae49df3158c2eb2265464129ef978","modified":1730790651183},{"_id":"public/assets/favicon_bak.ico","hash":"8b200c575d273d41a179c102442e191414e74eae","modified":1730790651183},{"_id":"public/css/mobile.css.map","hash":"c9f9dade45b119ae2eb7a93be0160baef4d494f8","modified":1730790651183},{"_id":"public/avatar/Misaka.jpg","hash":"74a0372523f98dfbba992bf80642e160d04dc9b1","modified":1730790651183},{"_id":"public/avatar/Jason.jpg","hash":"0eae332ea91f9e04b54f35d2ed1b17b5b37aee64","modified":1730790651183},{"_id":"public/font/Source Sans Pro.woff","hash":"a6722c9b6439b7a020a9be3d3178970757a9265c","modified":1730790651183},{"_id":"public/font/Source Sans Pro.woff2","hash":"da65f527a8da65d5eb6721626d28cfdb46ab104a","modified":1730790651183},{"_id":"public/scripts/customFontLoader.js.map","hash":"702a44b0b1b450263592bfb1199c8d36ea9834a2","modified":1730790651183},{"_id":"public/scripts/dark.js.map","hash":"feb9e1905c4b313b839c1c3b69ad61c05f265a9a","modified":1730790651183},{"_id":"public/scripts/main.js.LICENSE.txt","hash":"959bfc660011bc6a0800fe9e7974080f64c062aa","modified":1730790651183},{"_id":"public/scripts/search.js.LICENSE.txt","hash":"2c9b607ded909550f2ed2d0f2e7271781d9f78d9","modified":1730790651183},{"_id":"public/images/daemonset/daemonset-pods.png","hash":"ffc713e43daebc3db7fbcde65c154bfc0c4e5148","modified":1730790651183},{"_id":"public/images/daemonset/DaemonSets.png","hash":"b2d8cb6e9f9a3246d70a6c4f1fa6656c6128eb67","modified":1730790651183},{"_id":"public/images/daemonset/nodes.png","hash":"9ddeb9b6441cfee33edce7aa99af8058c7a291b1","modified":1730790651183},{"_id":"public/images/daemonset/daemonset-1.png","hash":"30bd683b3eba29092f63bb3c3d1b3742a94706e4","modified":1730790651183},{"_id":"public/images/docker-1/bg.png","hash":"e3b82c04b261788b6c333288578220dad894e135","modified":1730790651183},{"_id":"public/images/dead-message/bg.jpg","hash":"e0de32bdd097eeb58f534882e876a282606db679","modified":1730790651183},{"_id":"public/images/dead-message/dead-letter-3.png","hash":"d8017b10c2efd5448993b92f0a35783e4d0b71f7","modified":1730790651183},{"_id":"public/images/dead-message/delay_comsuption_1.png","hash":"c093bbb3f975f40087d037aa56b8fd32ed866332","modified":1730790651183},{"_id":"public/images/dead-message/delay_comsuption_2.png","hash":"f9b57ebe4ba7cefabad08a139f92e619fd1aae8f","modified":1730790651183},{"_id":"public/images/docker-layer/filesystem.png","hash":"969d25d9599c4bcc72ee3403e1805d7ad7a874e6","modified":1730790651183},{"_id":"public/images/docker-layer/layers.png","hash":"cf95861f382cab38dfcb0864099633592e85fc50","modified":1730790651183},{"_id":"public/images/docker-layer/ls_upper.png","hash":"aa190ff2fa11cfcf0c125e79b71e9b5d161358a5","modified":1730790651183},{"_id":"public/images/docker-layer/merged.png","hash":"a35d1d9111feb7ed81e3279ef2f1f5c9bb8951d6","modified":1730790651183},{"_id":"public/images/docker-layer/tree.png","hash":"8650756f7321bd4e7a53e0525f3e42411b7d51b7","modified":1730790651183},{"_id":"public/images/dump/crash.jpeg","hash":"e25f4327f9073e01e8b1a3e13c209ca732880e15","modified":1730790651183},{"_id":"public/images/garnet/client.png","hash":"4889111b6b22a0f07ed3e80b70ee4e1e99c8045e","modified":1730790651183},{"_id":"public/images/garnet/compare1.png","hash":"ed8a21697688433ffe376d2a4ccaa7ec53c667ff","modified":1730790651183},{"_id":"public/images/garnet/connect.png","hash":"82d4fc4511b032c7c797018845ca40d83ac7aa9d","modified":1730790651183},{"_id":"public/images/garnet/compatible.png","hash":"1714c1d5f1c6fd0421b4594015595976b5fd4ee4","modified":1730790651183},{"_id":"public/images/garnet/custom-command.png","hash":"bea263307a51c77205885ace2c3060272e444339","modified":1730790651183},{"_id":"public/images/garnet/running.png","hash":"3253e7a14adf9509baead2613151f614a0012ab5","modified":1730790651183},{"_id":"public/images/http/TCP-connection-1.png","hash":"588cade2c5e791bee0f282a6290889ba15c3a039","modified":1730790651183},{"_id":"public/images/http/curl-header.png","hash":"e5c4a20f54045759a1a29f7f35a344d45ee51ecb","modified":1730790651183},{"_id":"public/images/http/handshake-1.png","hash":"698f25b0696249dbbadbf1b71ea5e3e48b57348e","modified":1730790651183},{"_id":"public/images/http/http-request.png","hash":"4d29675c37a4cc0df885db03cff820aa3f98080c","modified":1730790651183},{"_id":"public/images/dump/windbg_3.png","hash":"47fa0c7ac253a9a44eef9bc6d5dce90d96445ba2","modified":1730790651183},{"_id":"public/images/http/http-keep-alive-header.png","hash":"d2b1f6ccc2903ffbd4308627c2562b42c80a2cb7","modified":1730790651183},{"_id":"public/images/http/perisitent-connection.png","hash":"0e16961aaa4851908823dccfa904d3f4f6989c08","modified":1730790651183},{"_id":"public/images/https/ca.png","hash":"a3f65f3b7f108a2e18c61d13c3024d761586a9ca","modified":1730790651183},{"_id":"public/images/https/bg.jpg","hash":"9424b491fdae5f8c91344596469c3980217e2206","modified":1730790651183},{"_id":"public/images/https/handshake.png","hash":"9d2b92013eb6b78a0f3b84855a383b29962da2ba","modified":1730790651183},{"_id":"public/images/rabbitmq-quarum/courgette.log","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1730790651183},{"_id":"public/images/https/security.png","hash":"e040846f476100e1ac38f67dec1fc9735978fc9f","modified":1730790651183},{"_id":"public/images/https/expire.png","hash":"801009fef98fa9d46a677f153f097e6476c139e2","modified":1730790651183},{"_id":"public/images/image-search/bg.jpg","hash":"a02f0b66241373b0fb83610977010c41297c6985","modified":1730790651183},{"_id":"public/images/image-search/qdrant.png","hash":"0c42f079a8b35f9fe8da6c3b3cf3180e9d603c62","modified":1730790651183},{"_id":"public/images/image-search/process.png","hash":"c1f5c3452b606dc8a510d9b3a5a24b330eff06eb","modified":1730790651183},{"_id":"public/images/internal-loss/depressed.jpg","hash":"8ff19e979ef211030d79fc29eca3bef0ed42f9e9","modified":1730790651183},{"_id":"public/images/proxy/bg.jpg","hash":"c884b6efad5351ee2996fe0d18715fb27f7b3749","modified":1730790651183},{"_id":"public/images/proxy/forward-proxy.png","hash":"49892dfa05b23599732f106b70b44fa95bc2eaa5","modified":1730790651183},{"_id":"public/images/js-signal/EventTarget.png","hash":"818561377792246188fd5e247e0de485c99b889e","modified":1730790651183},{"_id":"public/images/js-signal/EventTarget2.png","hash":"58db529e086abb315e24f6738d871e776e72f9c6","modified":1730790651183},{"_id":"public/images/proxy/transparent-proxy.png","hash":"e2bc2ee06dbfa33170ec3120277f21f4e3e503f9","modified":1730790651183},{"_id":"public/images/js-signal/EventTarget3.png","hash":"e5f9ea6836e53d2a388a09cf54190253f5d4a467","modified":1730790651183},{"_id":"public/images/proxy/reverse-proxy.png","hash":"57444303e4d4327cd1ebaedd3d954dfcf2486b69","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/channel1.png","hash":"fcde762d9619fe15b3fbdbe32455dfee9214dee0","modified":1730790651183},{"_id":"public/assets/favicon.ico","hash":"c136618e070daf370da961ac730973293a088b9e","modified":1730790651183},{"_id":"public/css/style.css.map","hash":"dbe8f8c1fccf8bd9d28ecf3874036a2281319aa0","modified":1730790651183},{"_id":"public/font/Oswald-Regular.ttf","hash":"965d729546a43a8490ad4cf33c25ac475682100c","modified":1730790651183},{"_id":"public/font/SourceCodePro-Regular.ttf.woff","hash":"12eef75e1ad3eca9dae42b65505010ce4464a315","modified":1730790651183},{"_id":"public/font/SourceCodePro-Regular.ttf.woff2","hash":"f5991289ec17884cb641da0646d278d36702a190","modified":1730790651183},{"_id":"public/intro/404-bg.jpg","hash":"3afb5bb26f4ff0bd0e0a28df955c8aa7d746d3c5","modified":1730790651183},{"_id":"public/images/docker-1/configurations.png","hash":"c6f58a834400b5d6fff7c76249562888a908304c","modified":1730790651183},{"_id":"public/images/docker-1/multi-env.png","hash":"a8aa3cdee473ee5987c28a30c4def6b06b1c4708","modified":1730790651183},{"_id":"public/images/dead-message/dead-letter-2.jpg","hash":"424a4237b4485e845ed3e9e6e74ee1f34485d196","modified":1730790651183},{"_id":"public/images/dead-message/dead-letter-exchange-1.png","hash":"7b141675f4bd37c8d65a63b5d22612430b945720","modified":1730790651183},{"_id":"public/images/docker-2/inspect3.png","hash":"e8523ef78b9823458520eb25300303381b046a8e","modified":1730790651183},{"_id":"public/images/dump/bg.png","hash":"32c7ad31ef1117233e7691e74198041f62870e63","modified":1730790651183},{"_id":"public/images/dump/windbg_4.png","hash":"5618b95c756aab451803e23e9c0f77b5fa94e6b4","modified":1730790651183},{"_id":"public/images/garnet/1.png","hash":"0d8a64004413ec34a334cce4925372781b3c88b0","modified":1730790651183},{"_id":"public/images/garnet/log.png","hash":"0c32a044823dd2b85353c2816c9109c9df0626b4","modified":1730790651183},{"_id":"public/images/http/auto-disconnect.png","hash":"6eb07b19f5350b86e32c41503abdef786d1cc8a3","modified":1730790651183},{"_id":"public/images/http/handshake-2.png","hash":"f50dd3fab7ff21a20cd91622aefb077b7ec74b89","modified":1730790651183},{"_id":"public/images/http/timeout-auto-disconnect.png","hash":"87f74686dc596abb5be91260a40dcf38ed3d0d17","modified":1730790651183},{"_id":"public/images/http/request-methods.png","hash":"5914a2642fc3c771aaddbb5a4db79d020c75ba27","modified":1730790651183},{"_id":"public/images/https/client-hello.png","hash":"65039f3b5656ce343d9c36842642aedef464f9d1","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/channel2.png","hash":"f09e7365fd1026393f0b89777406570fbb1be70b","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/exchanges-bidings-routing-keys.svg","hash":"ec548510fb86ab373be5decbb3f65896813d048b","modified":1730790651183},{"_id":"public/css/dark.css","hash":"4db211216f16a5e66d4d499158f4005a1bbb39f5","modified":1730790651183},{"_id":"public/css/mobile.css","hash":"acb0dfcce26ec93f59c6ec4936006abbe8daefee","modified":1730790651183},{"_id":"public/css/style.css","hash":"f08b1ec3a5fe1bf936401a238d55e0487296b42c","modified":1730790651183},{"_id":"public/scripts/dark.js","hash":"28ba818b2ab8a9454a52fe2710b5a8a81a195e4d","modified":1730790651183},{"_id":"public/lib/webfontloader.min.js","hash":"4c69aeb4e4f355912503d1c460e8e7aa6ea6963e","modified":1730790651183},{"_id":"public/scripts/customFontLoader.js","hash":"7c2f03fbd2b8340b77b1b02778a34e5ac10b560c","modified":1730790651183},{"_id":"public/scripts/share.js","hash":"2210dd8dacea4f1ca11c0047dfafd0a170abd953","modified":1730790651183},{"_id":"public/lib/jquery.min.js","hash":"ad886e472b3557f3dc7dfa2bc43468ab8d1cef5b","modified":1730790651183},{"_id":"public/scripts/search.js","hash":"ac8e9d130ea410832a421d661898abee63bd8e67","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/fanout-exchange.svg","hash":"5e14973b4eba3986a1805c585260d34e781c512a","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/main.png","hash":"e45cabff6e1cc9ea8477412977a49277b9656faa","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/direct-exchange.svg","hash":"e1e7e8648d3c479c2b4223af6be07e434ea62730","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/fanout.png","hash":"6458eb591f42ff61e67364d480c4b2c0dc1ff3bf","modified":1730790651183},{"_id":"public/images/rabbitmq-quarum/quarum1.png","hash":"e24787c731793ab83bc335c08dcf21060babd92d","modified":1730790651183},{"_id":"public/images/rabbitmq-quarum/normal.png","hash":"7a81405dc9d73b0a7cdff3b685c35853bad1cb1a","modified":1730790651183},{"_id":"public/images/rabbitmq-quarum/quarum2.png","hash":"7c88c03d166aee001257f3fe29918c29ff0df8bb","modified":1730790651183},{"_id":"public/images/rabbitmq-quarum/stream_error1.png","hash":"ce4c9e1a9a9da1cb4278e2e74be852611c8c265d","modified":1730790651183},{"_id":"public/images/rabbitmq-quarum/stream_error2.png","hash":"0d84d8d3ae357383925c86c728d865ce461bce8b","modified":1730790651183},{"_id":"public/images/quic/head_of_line_blocking.png","hash":"2203cca89e72b24f13cc9774fb78ee64927f32ea","modified":1730790651183},{"_id":"public/images/quic/quic-logo.png","hash":"f2cf0868ef61bfe597981193c314327741c5a48e","modified":1730790651183},{"_id":"public/images/redis-interview/memory.png","hash":"37fadd91ec8573c6c30ec5fd32562f2c3d22d5a9","modified":1730790651183},{"_id":"public/images/redis-interview/cache-penetration.png","hash":"17f21e18052f40f20189a31c4bfbf749a1dedcbc","modified":1730790651183},{"_id":"public/images/sticky-packet/server-sticky.png","hash":"8a7a47f695c9d74f4bebb7cf444d221e59bc8923","modified":1730790651183},{"_id":"public/images/sticky-packet/bg.jpg","hash":"9a73ba1e1dfa83d5e79399fe25745e9c90915762","modified":1730790651183},{"_id":"public/images/sticky-packet/sender-sticky.png","hash":"199862fcf0175fe9b9acca3c698c58482dd123c5","modified":1730790651183},{"_id":"public/images/redis-interview/recruitment.png","hash":"9da7eff910bfb50b7f11618614003b6153e71d98","modified":1730790651183},{"_id":"public/images/sticky-packet/solve-sender-sticky.png","hash":"9060a5391d9fe9f8a5b49dbda8ef182d7690e0c5","modified":1730790651183},{"_id":"public/images/sticky-packet/solve-server-sticky.png","hash":"0833d4fd870412068dc5b3515a60e9f078bd0ae9","modified":1730790651183},{"_id":"public/images/task-completion-source/pause-1.png","hash":"14d301e1283ad280dd8ea0525be0e5c38531ef74","modified":1730790651183},{"_id":"public/images/task-completion-source/pause-2.png","hash":"f681d83790b004e1703e18560c2f7d2db0cd6d01","modified":1730790651183},{"_id":"public/images/task-completion-source/bg.jpg","hash":"762d9571bdc71e36879c00907cb524e825980694","modified":1730790651183},{"_id":"public/images/internal-loss/20231109_sy_01.jpg","hash":"f637ac12cf901b7e557077687482f7232bbc2a72","modified":1730790651183},{"_id":"public/images/internal-loss/996.jpg","hash":"d712414d1167ea1a5790683d549a3dbf56cc3c8c","modified":1730790651183},{"_id":"public/images/dump/windbg_2.png","hash":"e55722d89679167f37e0b851a53e27ae989663f8","modified":1730790651183},{"_id":"public/images/http/auto-disconnect2.png","hash":"d96b55fe2a3d138263e29ec9ba3a171b78eaf003","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/topic-exchange.svg","hash":"ed3868a0efc180866dca5c7ba33cb6797ad96bc5","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/rabbitmq-headers-exchange.svg","hash":"b9983fdc354c45500fcfe57e9f78ab4cb88a2c4d","modified":1730790651183},{"_id":"public/images/rabbitmq-quarum/stream_offset.png","hash":"156f277e1c766644c8704892454397fc113f153d","modified":1730790651183},{"_id":"public/images/quic/handshake.png","hash":"38daab0f33947a35e7caacf41e3e2979cc854b89","modified":1730790651183},{"_id":"public/images/quic/quic.png","hash":"5a459deaef952ec228d3515dfdbf47048fc05c5c","modified":1730790651183},{"_id":"public/images/quic/tcp.png","hash":"1fba23e6486468abf1e4baa60d8a2cf85c5685cf","modified":1730790651183},{"_id":"public/images/redis-interview/cache-breakdown.png","hash":"de31f8ba0958f9428c1148746206f8351fa1bf18","modified":1730790651183},{"_id":"public/images/redis-interview/cache-avalanche.png","hash":"8bcdb1787aa12c08febeb8c2324cf7fa9c6d3c02","modified":1730790651183},{"_id":"public/intro/about-bg.jpg","hash":"ab388276822417cc4e703312c14e20280ec783b3","modified":1730790651183},{"_id":"public/intro/post-bg.jpg","hash":"525fafb2238c27754d8fa751f143ff1de9b8482d","modified":1730790651183},{"_id":"public/scripts/share.js.map","hash":"1e018aa465800a066480e33c848f380880af6743","modified":1730790651183},{"_id":"public/images/docker-2/before.png","hash":"4d6df539061278c5a371d63bbf494a54ac390588","modified":1730790651183},{"_id":"public/images/dump/windbg_1.png","hash":"fec01b96435a46269b0a241c8feb13764458b0e9","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/default-exchange.png","hash":"da48c3eae865c3758c2998b9234193ef1c52e26c","modified":1730790651183},{"_id":"public/scripts/main.js","hash":"11fd75dddcbef7157fbfb8717b3463a80fda1fb3","modified":1730790651183},{"_id":"public/images/https/encrypted.png","hash":"51f01f7c79cbb8e5ace366b423a46c677483d4f3","modified":1730790651183},{"_id":"public/images/daemonset/bg.png","hash":"b1603478da28b1f0e9b0f1e54d6eca8e30537b4b","modified":1730790651183},{"_id":"public/images/docker-2/after.png","hash":"2aa4ca9b53dc8a4270e3174115fcf96887185f64","modified":1730790651183},{"_id":"public/images/https/cipher-suites.png","hash":"e9faeff8e36d3efd82a5a0800c85a8e23d6ebf56","modified":1730790651183},{"_id":"public/images/https/negotiated-cipher-suite.png","hash":"32d7a6f6ad24e6c5755d2ba2626e0ba71520fd50","modified":1730790651183},{"_id":"public/intro/index-bg.jpg","hash":"96b52e177b8bc53e64ec6ee1e10b2b6a4e13083b","modified":1730790651183},{"_id":"public/images/redis-interview/bg.png","hash":"e5be0650aa2343b4a62218b58ebae10c4f4b9ba6","modified":1730790651183},{"_id":"public/images/js-signal/switch-theme.gif","hash":"8e8f0c1a5add7925ac6f7f5931d43a6f829373b7","modified":1730790651183},{"_id":"public/images/hello-bg.png","hash":"f70f2a6805ceb4ab1175e391c03923b7264bc431","modified":1730790651183},{"_id":"public/images/image-search/images.png","hash":"b2a77e00a2290543613f0df77f8c30337c91f441","modified":1730790651183},{"_id":"public/images/https/ca2.png","hash":"e71ae267fc6a9eda8943e4881e2f408b0a84055f","modified":1730790651183},{"_id":"public/images/js-signal/responsive.gif","hash":"32b125a785deeae5ffac981705d6f896369e0f1b","modified":1730790651183},{"_id":"public/images/docker-2/inspect1.png","hash":"e818b04708ae3c4ffa2ca0e3e890c5d2d4c0bb05","modified":1730790651183},{"_id":"public/images/docker-2/inspect2.png","hash":"30515858e2dddad39c76f016c55a02af8f639856","modified":1730790651183},{"_id":"public/scripts/search.js.map","hash":"bd469588b3bee82b3cf72b72d447c854f4d76875","modified":1730790651183},{"_id":"public/images/image-search/search.gif","hash":"eb44e6dcab6b4292eb95ef63cbf64035ed01c878","modified":1730790651183},{"_id":"public/scripts/main.js.map","hash":"79d928070b7e5333ca241c5563ab4fe9cab31b74","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/fanout.mp4","hash":"132a8c24996e91d19467bff53d9fb453c609cb79","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/16elk-ujaxc.gif","hash":"0b01075739b5d1b96d35a878bf55ff2575b50d41","modified":1730790651183},{"_id":"public/images/rabbitmq-basic/vro2s-b2mub.gif","hash":"70b8ce43edd1599dd11a8c8dd529c26405323082","modified":1730790651183}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"C#  TaskCompletionSource","date":"2024-05-30T00:52:16.000Z","published":1,"_content":"\nC# TaskCompletionSource  TaskCompletionSource \n\nTaskCompletionSource<T> .NET TaskCompletionSource <T>Task<TResult> Task \n\n\n# TaskCompletionSource\nTaskCompletionSource<T>Task<T>\n```C#\nusing System;\nusing System.Threading.Tasks;\n\npublic class Program\n{\n    public static void Main(string[] args)\n    {\n        var tcs = new TaskCompletionSource<bool>();\n        tcs.SetResult(true);\n    }\n}\n```\n TaskCompletionSource<bool>  SetResult \n\n# TaskCompletionSource\n TaskCompletionSource\n```C#\nusing System;\nusing System.Threading.Tasks;\n\npublic class CallbackExample\n{\n    public static void Main(string[] args)\n    {\n        Task task = DoSomethingAsync();\n\n        task.ContinueWith(t =>\n        {\n            if (t.IsCompletedSuccessfully)\n            {\n                Console.WriteLine(\"!\");\n            }\n        }).Wait();\n    }\n\n    public static Task DoSomethingAsync()\n    {\n        var tcs = new TaskCompletionSource<bool>();\n\n        // \n        Task.Run(() =>\n        {\n            Task.Delay(2000).Wait(); // \n            tcs.SetResult(true); // \n        });\n\n        return tcs.Task;\n    }\n}\n```\n\n# TaskCompletionSource\nTaskCompletionSource \n TaskCompletionSource \n```C#\nusing System;\nusing System.Threading.Tasks;\n\npublic class PauseExample\n{\n    private static TaskCompletionSource<bool> _pauseTcs;\n\n    public static async Task Main(string[] args)\n    {\n        _pauseTcs = new TaskCompletionSource<bool>();\n\n        Task longRunningTask = LongRunningOperationAsync();\n\n        Console.WriteLine(\"...\");\n        Console.ReadKey();\n        _pauseTcs.SetResult(true); // \n\n        await longRunningTask;\n        Console.WriteLine(\"!\");\n    }\n\n    public static async Task LongRunningOperationAsync()\n    {\n        Console.WriteLine(\"...\");\n\n        await _pauseTcs.Task; // \n\n        Console.WriteLine(\"...\");\n        // \n        await Task.Delay(2000);\n\n        Console.WriteLine(\"\");\n    }\n}\n```\n\n![1](/images/task-completion-source/pause-1.png)\n\n![2](/images/task-completion-source/pause-2.png)\n\n# TaskCompletionSource\n\nTaskCompletionSource \n\n1. \n2. \n3.  Task.WhenAll  Task.WhenAny\n\n# TaskCompletionSource\n\n TaskCompletionSource \n\n1.  SetResultSetException  SetCanceled \n2.  UI  TaskCompletionSource\n3.  TaskCompletionSource\n\n# \nTaskCompletionSource  TaskCompletionSource\n\n","source":"_posts/TaskCompletionSource.md","raw":"---\ntitle: C#  TaskCompletionSource\ndate: 2024-05-30 08:52:16\npublished: true\ntags:\n---\n\nC# TaskCompletionSource  TaskCompletionSource \n\nTaskCompletionSource<T> .NET TaskCompletionSource <T>Task<TResult> Task \n\n\n# TaskCompletionSource\nTaskCompletionSource<T>Task<T>\n```C#\nusing System;\nusing System.Threading.Tasks;\n\npublic class Program\n{\n    public static void Main(string[] args)\n    {\n        var tcs = new TaskCompletionSource<bool>();\n        tcs.SetResult(true);\n    }\n}\n```\n TaskCompletionSource<bool>  SetResult \n\n# TaskCompletionSource\n TaskCompletionSource\n```C#\nusing System;\nusing System.Threading.Tasks;\n\npublic class CallbackExample\n{\n    public static void Main(string[] args)\n    {\n        Task task = DoSomethingAsync();\n\n        task.ContinueWith(t =>\n        {\n            if (t.IsCompletedSuccessfully)\n            {\n                Console.WriteLine(\"!\");\n            }\n        }).Wait();\n    }\n\n    public static Task DoSomethingAsync()\n    {\n        var tcs = new TaskCompletionSource<bool>();\n\n        // \n        Task.Run(() =>\n        {\n            Task.Delay(2000).Wait(); // \n            tcs.SetResult(true); // \n        });\n\n        return tcs.Task;\n    }\n}\n```\n\n# TaskCompletionSource\nTaskCompletionSource \n TaskCompletionSource \n```C#\nusing System;\nusing System.Threading.Tasks;\n\npublic class PauseExample\n{\n    private static TaskCompletionSource<bool> _pauseTcs;\n\n    public static async Task Main(string[] args)\n    {\n        _pauseTcs = new TaskCompletionSource<bool>();\n\n        Task longRunningTask = LongRunningOperationAsync();\n\n        Console.WriteLine(\"...\");\n        Console.ReadKey();\n        _pauseTcs.SetResult(true); // \n\n        await longRunningTask;\n        Console.WriteLine(\"!\");\n    }\n\n    public static async Task LongRunningOperationAsync()\n    {\n        Console.WriteLine(\"...\");\n\n        await _pauseTcs.Task; // \n\n        Console.WriteLine(\"...\");\n        // \n        await Task.Delay(2000);\n\n        Console.WriteLine(\"\");\n    }\n}\n```\n\n![1](/images/task-completion-source/pause-1.png)\n\n![2](/images/task-completion-source/pause-2.png)\n\n# TaskCompletionSource\n\nTaskCompletionSource \n\n1. \n2. \n3.  Task.WhenAll  Task.WhenAny\n\n# TaskCompletionSource\n\n TaskCompletionSource \n\n1.  SetResultSetException  SetCanceled \n2.  UI  TaskCompletionSource\n3.  TaskCompletionSource\n\n# \nTaskCompletionSource  TaskCompletionSource\n\n","slug":"TaskCompletionSource","updated":"2024-06-06T07:22:36.858Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh10000u8p1d7wxed21","content":"<p>C# TaskCompletionSource  TaskCompletionSource </p>\n<p>TaskCompletionSource<T> .NET TaskCompletionSource <T>Task<TResult> Task </p>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p>TaskCompletionSource<T>Task<T></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> tcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\">        tcs.SetResult(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> TaskCompletionSource<bool>  SetResult </p>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p> TaskCompletionSource</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">CallbackExample</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Task task = DoSomethingAsync();</span><br><span class=\"line\"></span><br><span class=\"line\">        task.ContinueWith(t =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t.IsCompletedSuccessfully)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Console.WriteLine(<span class=\"string\">&quot;!&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;).Wait();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">DoSomethingAsync</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> tcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Task.Run(() =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Task.Delay(<span class=\"number\">2000</span>).Wait(); <span class=\"comment\">// </span></span><br><span class=\"line\">            tcs.SetResult(<span class=\"literal\">true</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> tcs.Task;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p>TaskCompletionSource <br> TaskCompletionSource </p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">PauseExample</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt; _pauseTcs;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _pauseTcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        Task longRunningTask = LongRunningOperationAsync();</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        Console.ReadKey();</span><br><span class=\"line\">        _pauseTcs.SetResult(<span class=\"literal\">true</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> longRunningTask;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">LongRunningOperationAsync</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> _pauseTcs.Task; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">await</span> Task.Delay(<span class=\"number\">2000</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/task-completion-source/pause-1.png\" alt=\"1\"><br><br><img src=\"/images/task-completion-source/pause-2.png\" alt=\"2\"></p>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p>TaskCompletionSource </p>\n<ol>\n<li></li>\n<li></li>\n<li> Task.WhenAll  Task.WhenAny</li>\n</ol>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p> TaskCompletionSource </p>\n<ol>\n<li> SetResultSetException  SetCanceled </li>\n<li> UI  TaskCompletionSource</li>\n<li> TaskCompletionSource</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>TaskCompletionSource  TaskCompletionSource</p>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<p>C# TaskCompletionSource  TaskCompletionSource </p>\n<p>TaskCompletionSource<T> .NET TaskCompletionSource <T>Task<TResult> Task </p>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p>TaskCompletionSource<T>Task<T></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> tcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\">        tcs.SetResult(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> TaskCompletionSource<bool>  SetResult </p>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p> TaskCompletionSource</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">CallbackExample</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Task task = DoSomethingAsync();</span><br><span class=\"line\"></span><br><span class=\"line\">        task.ContinueWith(t =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (t.IsCompletedSuccessfully)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Console.WriteLine(<span class=\"string\">&quot;!&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;).Wait();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Task <span class=\"title\">DoSomethingAsync</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> tcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Task.Run(() =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Task.Delay(<span class=\"number\">2000</span>).Wait(); <span class=\"comment\">// </span></span><br><span class=\"line\">            tcs.SetResult(<span class=\"literal\">true</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> tcs.Task;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p>TaskCompletionSource <br> TaskCompletionSource </p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">PauseExample</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt; _pauseTcs;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _pauseTcs = <span class=\"keyword\">new</span> TaskCompletionSource&lt;<span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        Task longRunningTask = LongRunningOperationAsync();</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        Console.ReadKey();</span><br><span class=\"line\">        _pauseTcs.SetResult(<span class=\"literal\">true</span>); <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> longRunningTask;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">async</span> Task <span class=\"title\">LongRunningOperationAsync</span>()</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">await</span> _pauseTcs.Task; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">await</span> Task.Delay(<span class=\"number\">2000</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/task-completion-source/pause-1.png\" alt=\"1\"><br><br><img src=\"/images/task-completion-source/pause-2.png\" alt=\"2\"></p>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p>TaskCompletionSource </p>\n<ol>\n<li></li>\n<li></li>\n<li> Task.WhenAll  Task.WhenAny</li>\n</ol>\n<h1 id=\"TaskCompletionSource\"><a href=\"#TaskCompletionSource\" class=\"headerlink\" title=\"TaskCompletionSource\"></a>TaskCompletionSource</h1><p> TaskCompletionSource </p>\n<ol>\n<li> SetResultSetException  SetCanceled </li>\n<li> UI  TaskCompletionSource</li>\n<li> TaskCompletionSource</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>TaskCompletionSource  TaskCompletionSource</p>\n<p></p>\n"},{"title":"Kubernetes DaemonSet  ","date":"2024-08-01T00:54:53.000Z","_content":"\n Kubernetes  DaemonSet Pod NodeDaemonSet  Kubernetes  DaemonSet  DaemonSet\n\n#  DaemonSet\n![daemonset](/images/daemonset/DaemonSets.png)\n\nDaemonSet  Kubernetes  Pod  Pod  Pod  Pod \n\nDaemonSet  PodFluentdFilebeatPrometheus Node Exporterkube-proxy\n\n# DaemonSet \n\nDaemonSets \n\nDaemonSetDaemonSet \n\nDaemonSet \n\n+ Pod   DaemonSet Kubernetes  Pod PodKubernetes  Pod \n\n+ Pod  DaemonSet Node SelectorNode Affinity Pod  Pod \n\n+   DaemonSet  Pod Kubernetes \n\n# \n\nDaemonSet  Kubernetes \n\n1.   FluentdFilebeatPrometheus Node Exporter \n\n> k8spod Kubernetes \n\n2.   kube-proxy\n\n> k8sCNIDaemonSet\n    ![daemonset-1](/images/daemonset/daemonset-1.png)\n\n3.  \n\n# \n\n Kubernetes DaemonSet \n\nKubernetes  DaemonSet  Pod  Pod  Pod DaemonSet  \n\n### \n\n\n\n+  \n+  \n+  \n\n3nodemaster\n\n![](/images/daemonset/nodes.png)\n\n\n\n### \n DaemonSet  Kubernetes  Node Exporter\n\n1. \n\n      Kubernetes Pod \n\n     \n\n2. \n\n      HTTPS \n\n3. \n\n     \n\n4. \n\n     \n\n     \n\n### Kubernetes\n1DaemonSet \n```yaml\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: txclientx\n  namespace: monitor\nspec:\n  selector:\n    matchLabels:\n      name: txclientx\n  template:\n    metadata:\n      labels:\n        name: txclientx\n    spec:\n      containers:\n      - name: txclientx\n        image: acr/txclientx:5.24.10729.10\n        ports:\n        - containerPort: 80  # \n        env:\n        - name: KhGuid\n          value: \"xxx\"\n        - name: TxCloudSite_Url\n          value: \"https://domain.com\"\n        - name: HttpJsonWriter_Target_Url\n          value: \"http://domain.com/v20/api/loggate/save/{datatype}\"\n        - name: NebulaFides_Url\n          value: \"http://domain.com\"\n        resources:\n          requests:\n            cpu: \"100m\"\n            memory: \"200Mi\"\n          limits:\n            cpu: \"200m\"\n            memory: \"400Mi\"\n\n```\n2Kubernetes\n```bash\nkubectl apply -f agent-daemonset.yaml\n```\n\n3\nk8s\n![pod](/images/daemonset/daemonset-pods.png)\n\n\n# \n\n Kubernetes  DaemonSet  DaemonSetDaemonSet  Kubernetes  Pod  DaemonSet","source":"_posts/daemonset.md","raw":"---\ntitle: Kubernetes DaemonSet  \ndate: 2024-08-01 08:54:53\ntags:\n---\n\n Kubernetes  DaemonSet Pod NodeDaemonSet  Kubernetes  DaemonSet  DaemonSet\n\n#  DaemonSet\n![daemonset](/images/daemonset/DaemonSets.png)\n\nDaemonSet  Kubernetes  Pod  Pod  Pod  Pod \n\nDaemonSet  PodFluentdFilebeatPrometheus Node Exporterkube-proxy\n\n# DaemonSet \n\nDaemonSets \n\nDaemonSetDaemonSet \n\nDaemonSet \n\n+ Pod   DaemonSet Kubernetes  Pod PodKubernetes  Pod \n\n+ Pod  DaemonSet Node SelectorNode Affinity Pod  Pod \n\n+   DaemonSet  Pod Kubernetes \n\n# \n\nDaemonSet  Kubernetes \n\n1.   FluentdFilebeatPrometheus Node Exporter \n\n> k8spod Kubernetes \n\n2.   kube-proxy\n\n> k8sCNIDaemonSet\n    ![daemonset-1](/images/daemonset/daemonset-1.png)\n\n3.  \n\n# \n\n Kubernetes DaemonSet \n\nKubernetes  DaemonSet  Pod  Pod  Pod DaemonSet  \n\n### \n\n\n\n+  \n+  \n+  \n\n3nodemaster\n\n![](/images/daemonset/nodes.png)\n\n\n\n### \n DaemonSet  Kubernetes  Node Exporter\n\n1. \n\n      Kubernetes Pod \n\n     \n\n2. \n\n      HTTPS \n\n3. \n\n     \n\n4. \n\n     \n\n     \n\n### Kubernetes\n1DaemonSet \n```yaml\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: txclientx\n  namespace: monitor\nspec:\n  selector:\n    matchLabels:\n      name: txclientx\n  template:\n    metadata:\n      labels:\n        name: txclientx\n    spec:\n      containers:\n      - name: txclientx\n        image: acr/txclientx:5.24.10729.10\n        ports:\n        - containerPort: 80  # \n        env:\n        - name: KhGuid\n          value: \"xxx\"\n        - name: TxCloudSite_Url\n          value: \"https://domain.com\"\n        - name: HttpJsonWriter_Target_Url\n          value: \"http://domain.com/v20/api/loggate/save/{datatype}\"\n        - name: NebulaFides_Url\n          value: \"http://domain.com\"\n        resources:\n          requests:\n            cpu: \"100m\"\n            memory: \"200Mi\"\n          limits:\n            cpu: \"200m\"\n            memory: \"400Mi\"\n\n```\n2Kubernetes\n```bash\nkubectl apply -f agent-daemonset.yaml\n```\n\n3\nk8s\n![pod](/images/daemonset/daemonset-pods.png)\n\n\n# \n\n Kubernetes  DaemonSet  DaemonSetDaemonSet  Kubernetes  Pod  DaemonSet","slug":"daemonset","published":1,"updated":"2024-08-02T10:01:08.923Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh40001u8p1eclp8ncs","content":"<p> Kubernetes  DaemonSet Pod NodeDaemonSet  Kubernetes  DaemonSet  DaemonSet</p>\n<h1 id=\"-DaemonSet\"><a href=\"#-DaemonSet\" class=\"headerlink\" title=\" DaemonSet\"></a> DaemonSet</h1><p><img src=\"/images/daemonset/DaemonSets.png\" alt=\"daemonset\"></p>\n<p>DaemonSet  Kubernetes  Pod  Pod  Pod  Pod </p>\n<p>DaemonSet  PodFluentdFilebeatPrometheus Node Exporterkube-proxy</p>\n<h1 id=\"DaemonSet-\"><a href=\"#DaemonSet-\" class=\"headerlink\" title=\"DaemonSet \"></a>DaemonSet </h1><p>DaemonSets </p>\n<p>DaemonSetDaemonSet </p>\n<p>DaemonSet </p>\n<ul>\n<li><p>Pod   DaemonSet Kubernetes  Pod PodKubernetes  Pod </p>\n</li>\n<li><p>Pod  DaemonSet Node SelectorNode Affinity Pod  Pod </p>\n</li>\n<li><p>  DaemonSet  Pod Kubernetes </p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>DaemonSet  Kubernetes </p>\n<ol>\n<li>  FluentdFilebeatPrometheus Node Exporter </li>\n</ol>\n<blockquote>\n<p>k8spod Kubernetes </p>\n</blockquote>\n<ol start=\"2\">\n<li>  kube-proxy</li>\n</ol>\n<blockquote>\n<p>k8sCNIDaemonSet<br>    <img src=\"/images/daemonset/daemonset-1.png\" alt=\"daemonset-1\"></p>\n</blockquote>\n<ol start=\"3\">\n<li> </li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Kubernetes DaemonSet </p>\n<p>Kubernetes  DaemonSet  Pod  Pod  Pod DaemonSet  </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li> </li>\n<li> </li>\n<li> </li>\n</ul>\n<p>3nodemaster</p>\n<p><img src=\"/images/daemonset/nodes.png\" alt=\"\"></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> DaemonSet  Kubernetes  Node Exporter</p>\n<ol>\n<li><p></p>\n<p>   Kubernetes Pod </p>\n<p>  </p>\n</li>\n<li><p></p>\n<p>   HTTPS </p>\n</li>\n<li><p></p>\n<p>  </p>\n</li>\n<li><p></p>\n<p>  </p>\n<p>  </p>\n</li>\n</ol>\n<h3 id=\"Kubernetes\"><a href=\"#Kubernetes\" class=\"headerlink\" title=\"Kubernetes\"></a>Kubernetes</h3><p>1DaemonSet </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">DaemonSet</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">monitor</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span></span><br><span class=\"line\">    <span class=\"attr\">matchLabels:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">  <span class=\"attr\">template:</span></span><br><span class=\"line\">    <span class=\"attr\">metadata:</span></span><br><span class=\"line\">      <span class=\"attr\">labels:</span></span><br><span class=\"line\">        <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">    <span class=\"attr\">spec:</span></span><br><span class=\"line\">      <span class=\"attr\">containers:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">        <span class=\"attr\">image:</span> <span class=\"string\">acr/txclientx:5.24.10729.10</span></span><br><span class=\"line\">        <span class=\"attr\">ports:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">containerPort:</span> <span class=\"number\">80</span>  <span class=\"comment\"># </span></span><br><span class=\"line\">        <span class=\"attr\">env:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">KhGuid</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;xxx&quot;</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">TxCloudSite_Url</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;https://domain.com&quot;</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">HttpJsonWriter_Target_Url</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;http://domain.com/v20/api/loggate/save/&#123;datatype&#125;&quot;</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">NebulaFides_Url</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;http://domain.com&quot;</span></span><br><span class=\"line\">        <span class=\"attr\">resources:</span></span><br><span class=\"line\">          <span class=\"attr\">requests:</span></span><br><span class=\"line\">            <span class=\"attr\">cpu:</span> <span class=\"string\">&quot;100m&quot;</span></span><br><span class=\"line\">            <span class=\"attr\">memory:</span> <span class=\"string\">&quot;200Mi&quot;</span></span><br><span class=\"line\">          <span class=\"attr\">limits:</span></span><br><span class=\"line\">            <span class=\"attr\">cpu:</span> <span class=\"string\">&quot;200m&quot;</span></span><br><span class=\"line\">            <span class=\"attr\">memory:</span> <span class=\"string\">&quot;400Mi&quot;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>2Kubernetes</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl apply -f agent-daemonset.yaml</span><br></pre></td></tr></table></figure>\n\n<p>3<br>k8s<br><img src=\"/images/daemonset/daemonset-pods.png\" alt=\"pod\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Kubernetes  DaemonSet  DaemonSetDaemonSet  Kubernetes  Pod  DaemonSet</p>\n","site":{"data":{}},"excerpt":"","more":"<p> Kubernetes  DaemonSet Pod NodeDaemonSet  Kubernetes  DaemonSet  DaemonSet</p>\n<h1 id=\"-DaemonSet\"><a href=\"#-DaemonSet\" class=\"headerlink\" title=\" DaemonSet\"></a> DaemonSet</h1><p><img src=\"/images/daemonset/DaemonSets.png\" alt=\"daemonset\"></p>\n<p>DaemonSet  Kubernetes  Pod  Pod  Pod  Pod </p>\n<p>DaemonSet  PodFluentdFilebeatPrometheus Node Exporterkube-proxy</p>\n<h1 id=\"DaemonSet-\"><a href=\"#DaemonSet-\" class=\"headerlink\" title=\"DaemonSet \"></a>DaemonSet </h1><p>DaemonSets </p>\n<p>DaemonSetDaemonSet </p>\n<p>DaemonSet </p>\n<ul>\n<li><p>Pod   DaemonSet Kubernetes  Pod PodKubernetes  Pod </p>\n</li>\n<li><p>Pod  DaemonSet Node SelectorNode Affinity Pod  Pod </p>\n</li>\n<li><p>  DaemonSet  Pod Kubernetes </p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>DaemonSet  Kubernetes </p>\n<ol>\n<li>  FluentdFilebeatPrometheus Node Exporter </li>\n</ol>\n<blockquote>\n<p>k8spod Kubernetes </p>\n</blockquote>\n<ol start=\"2\">\n<li>  kube-proxy</li>\n</ol>\n<blockquote>\n<p>k8sCNIDaemonSet<br>    <img src=\"/images/daemonset/daemonset-1.png\" alt=\"daemonset-1\"></p>\n</blockquote>\n<ol start=\"3\">\n<li> </li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Kubernetes DaemonSet </p>\n<p>Kubernetes  DaemonSet  Pod  Pod  Pod DaemonSet  </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li> </li>\n<li> </li>\n<li> </li>\n</ul>\n<p>3nodemaster</p>\n<p><img src=\"/images/daemonset/nodes.png\" alt=\"\"></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> DaemonSet  Kubernetes  Node Exporter</p>\n<ol>\n<li><p></p>\n<p>   Kubernetes Pod </p>\n<p>  </p>\n</li>\n<li><p></p>\n<p>   HTTPS </p>\n</li>\n<li><p></p>\n<p>  </p>\n</li>\n<li><p></p>\n<p>  </p>\n<p>  </p>\n</li>\n</ol>\n<h3 id=\"Kubernetes\"><a href=\"#Kubernetes\" class=\"headerlink\" title=\"Kubernetes\"></a>Kubernetes</h3><p>1DaemonSet </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">DaemonSet</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">monitor</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span></span><br><span class=\"line\">    <span class=\"attr\">matchLabels:</span></span><br><span class=\"line\">      <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">  <span class=\"attr\">template:</span></span><br><span class=\"line\">    <span class=\"attr\">metadata:</span></span><br><span class=\"line\">      <span class=\"attr\">labels:</span></span><br><span class=\"line\">        <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">    <span class=\"attr\">spec:</span></span><br><span class=\"line\">      <span class=\"attr\">containers:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">txclientx</span></span><br><span class=\"line\">        <span class=\"attr\">image:</span> <span class=\"string\">acr/txclientx:5.24.10729.10</span></span><br><span class=\"line\">        <span class=\"attr\">ports:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">containerPort:</span> <span class=\"number\">80</span>  <span class=\"comment\"># </span></span><br><span class=\"line\">        <span class=\"attr\">env:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">KhGuid</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;xxx&quot;</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">TxCloudSite_Url</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;https://domain.com&quot;</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">HttpJsonWriter_Target_Url</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;http://domain.com/v20/api/loggate/save/&#123;datatype&#125;&quot;</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">NebulaFides_Url</span></span><br><span class=\"line\">          <span class=\"attr\">value:</span> <span class=\"string\">&quot;http://domain.com&quot;</span></span><br><span class=\"line\">        <span class=\"attr\">resources:</span></span><br><span class=\"line\">          <span class=\"attr\">requests:</span></span><br><span class=\"line\">            <span class=\"attr\">cpu:</span> <span class=\"string\">&quot;100m&quot;</span></span><br><span class=\"line\">            <span class=\"attr\">memory:</span> <span class=\"string\">&quot;200Mi&quot;</span></span><br><span class=\"line\">          <span class=\"attr\">limits:</span></span><br><span class=\"line\">            <span class=\"attr\">cpu:</span> <span class=\"string\">&quot;200m&quot;</span></span><br><span class=\"line\">            <span class=\"attr\">memory:</span> <span class=\"string\">&quot;400Mi&quot;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>2Kubernetes</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl apply -f agent-daemonset.yaml</span><br></pre></td></tr></table></figure>\n\n<p>3<br>k8s<br><img src=\"/images/daemonset/daemonset-pods.png\" alt=\"pod\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Kubernetes  DaemonSet  DaemonSetDaemonSet  Kubernetes  Pod  DaemonSet</p>\n"},{"title":"Docker","date":"2024-07-05T11:59:06.000Z","_content":"## \nDockerDocker\n\ndocker[Docker](https://www.runoob.com/docker/docker-tutorial.html)\n\n## Docker\n![multi-envs](/images/docker-1/multi-env.png)\n\n\n .net .net\n\n\"\"\n\n\n\n## \n### \n+ \n+ cgroups\n\n### \nDockerDocker\n\n## \n### Union File System\nDockerUnionFSAUFSOverlayFS\n\n### \nDockerDocker\n\n### \nCopy-on-WriteCoW\n\n1. \n2. \n3. \n\n### \n1. \nI/O\n\n2. \n\n\n3. \n\n\n\n### \n\n\nDockerVolume\n\n```dockerfile\n# Dockerfile \nFROM python:3.8-slim\nWORKDIR /app\nCOPY . .\nVOLUME /app/data\nCMD [\"python\", \"app.py\"]\n```\n\ndocker-compose.yml\n\n```yaml\nversion: '3.8'\nservices:\n  app:\n    build: .\n    volumes:\n      - ./data:/app/data\n```\n\n## \n### \nDockerbridgehostoverlay\n\n### \nARP\n\n```bash\n# \ndocker network create --driver bridge my_bridge_network\n\n# \ndocker run --network my_bridge_network my_app\n```\n\n## \n### \nDocker\n\n### \n\n\n```bash\n# \ndocker image prune -a\n\n# \ndocker container prune\n\n# \ndocker volume prune\n\n# \ndocker network prune\n```\n\n## \n### \nDocker\n\n### \nDocker\n\n```json\n{\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"10m\",\n    \"max-file\": \"3\"\n  }\n}\n```\nELK\n\n```json\n{\n  \"log-driver\": \"gelf\",\n  \"log-opts\": {\n    \"gelf-address\": \"udp://logstash:12201\"\n  }\n}\n```\n\n## \nDockerDocker\n\n***\n\nDocker","source":"_posts/docker-1.md","raw":"---\ntitle: Docker\ndate: 2024-07-05 19:59:06\ntags:\n---\n## \nDockerDocker\n\ndocker[Docker](https://www.runoob.com/docker/docker-tutorial.html)\n\n## Docker\n![multi-envs](/images/docker-1/multi-env.png)\n\n\n .net .net\n\n\"\"\n\n\n\n## \n### \n+ \n+ cgroups\n\n### \nDockerDocker\n\n## \n### Union File System\nDockerUnionFSAUFSOverlayFS\n\n### \nDockerDocker\n\n### \nCopy-on-WriteCoW\n\n1. \n2. \n3. \n\n### \n1. \nI/O\n\n2. \n\n\n3. \n\n\n\n### \n\n\nDockerVolume\n\n```dockerfile\n# Dockerfile \nFROM python:3.8-slim\nWORKDIR /app\nCOPY . .\nVOLUME /app/data\nCMD [\"python\", \"app.py\"]\n```\n\ndocker-compose.yml\n\n```yaml\nversion: '3.8'\nservices:\n  app:\n    build: .\n    volumes:\n      - ./data:/app/data\n```\n\n## \n### \nDockerbridgehostoverlay\n\n### \nARP\n\n```bash\n# \ndocker network create --driver bridge my_bridge_network\n\n# \ndocker run --network my_bridge_network my_app\n```\n\n## \n### \nDocker\n\n### \n\n\n```bash\n# \ndocker image prune -a\n\n# \ndocker container prune\n\n# \ndocker volume prune\n\n# \ndocker network prune\n```\n\n## \n### \nDocker\n\n### \nDocker\n\n```json\n{\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"10m\",\n    \"max-file\": \"3\"\n  }\n}\n```\nELK\n\n```json\n{\n  \"log-driver\": \"gelf\",\n  \"log-opts\": {\n    \"gelf-address\": \"udp://logstash:12201\"\n  }\n}\n```\n\n## \nDockerDocker\n\n***\n\nDocker","slug":"docker-1","published":1,"updated":"2024-07-06T08:46:28.285Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh50002u8p18dsi7as8","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>DockerDocker</p>\n<p>docker<a href=\"https://www.runoob.com/docker/docker-tutorial.html\">Docker</a></p>\n<h2 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h2><p><img src=\"/images/docker-1/multi-env.png\" alt=\"multi-envs\"><br></p>\n<p> .net .net</p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li>cgroups</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>DockerDocker</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Union-File-System\"><a href=\"#Union-File-System\" class=\"headerlink\" title=\"Union File System\"></a>Union File System</h3><p>DockerUnionFSAUFSOverlayFS</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>DockerDocker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Copy-on-WriteCoW</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p><br>I&#x2F;O</p>\n</li>\n<li><p><br></p>\n</li>\n<li><p><br></p>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>DockerVolume</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Dockerfile </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"language-bash\"> /app/data</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n\n<p>docker-compose.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&#x27;3.8&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">app:</span></span><br><span class=\"line\">    <span class=\"attr\">build:</span> <span class=\"string\">.</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./data:/app/data</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Dockerbridgehostoverlay</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ARP</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker network create --driver bridge my_bridge_network</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker run --network my_bridge_network my_app</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Docker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker image prune -a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker container prune</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker volume prune</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker network prune</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Docker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Docker</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-driver&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;json-file&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-opts&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;max-size&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;10m&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;max-file&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>ELK</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-driver&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;gelf&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-opts&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;gelf-address&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;udp://logstash:12201&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>DockerDocker</p>\n<hr>\n<p>Docker</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>DockerDocker</p>\n<p>docker<a href=\"https://www.runoob.com/docker/docker-tutorial.html\">Docker</a></p>\n<h2 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h2><p><img src=\"/images/docker-1/multi-env.png\" alt=\"multi-envs\"><br></p>\n<p> .net .net</p>\n<p></p>\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li>cgroups</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>DockerDocker</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Union-File-System\"><a href=\"#Union-File-System\" class=\"headerlink\" title=\"Union File System\"></a>Union File System</h3><p>DockerUnionFSAUFSOverlayFS</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>DockerDocker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Copy-on-WriteCoW</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p><br>I&#x2F;O</p>\n</li>\n<li><p><br></p>\n</li>\n<li><p><br></p>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>DockerVolume</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Dockerfile </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">VOLUME</span><span class=\"language-bash\"> /app/data</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n\n<p>docker-compose.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&#x27;3.8&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">app:</span></span><br><span class=\"line\">    <span class=\"attr\">build:</span> <span class=\"string\">.</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./data:/app/data</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Dockerbridgehostoverlay</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ARP</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker network create --driver bridge my_bridge_network</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker run --network my_bridge_network my_app</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Docker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker image prune -a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker container prune</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker volume prune</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker network prune</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Docker</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Docker</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-driver&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;json-file&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-opts&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;max-size&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;10m&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;max-file&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>ELK</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-driver&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;gelf&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;log-opts&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;gelf-address&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;udp://logstash:12201&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>DockerDocker</p>\n<hr>\n<p>Docker</p>\n"},{"title":"Docker","date":"2024-07-08T01:20:55.000Z","_content":"\n# \nDockerDockerfileDockerfileDockerfile\n\n# Dockerfile\nDockerfileRUNCOPYADDDockerUnionFS\n\n```dockerfile\n# \nFROM python:3.8-slim\nWORKDIR /app\nCOPY . .\nRUN pip install -r requirements.txt\nCMD [\"python\", \"app.py\"]\n```\nDockerfileFROMWORKDIRCOPYRUN\n\n\nDockerRUNRUN\n\n1. RUNRUN apt-get install\n\n2. RUN\n\n3. RUN\n\n4. RUN\n\nDockerfile\n\n```dockerfile\nFROM ubuntu:20.04\n\n# \nRUN apt-get update && apt-get install -y curl\n\n# \nRUN echo \"Hello, World!\" > /hello.txt\n\n# \nRUN chmod 644 /hello.txt\n```\nRUN\n\n1. RUN apt-get update && apt-get install -y curl\n- curl\n- curl\n- \n2. RUN echo \"Hello, World!\" > /hello.txt\n- /hello.txt\"Hello, World!\"\n- /hello.txt\n\n3. RUN chmod 644 /hello.txt\n- /hello.txt\n- /hello.txt\n\nDocker\n\n# \nDocker  Union File System Dockerfile \n\n## \n\n\n1.  Docker \n\n2. Docker Docker Docker \n\n3. \n\n## \n Dockerfile\n\n```dockerfile\nFROM python:3.8-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install -r requirements.txt\nCOPY . .\nCMD [\"python\", \"app.py\"]\n```\nrequirements.txtrequirements.txt\n```\n# requirements.txt \nflask\nrequests\n```\n requirements.txt  COPY requirements.txt .  RUN pip install -r requirements.txt  FROM python:3.8-slimWORKDIR /appCOPY . .  CMD [\"python\", \"app.py\"]\n\ninspect\n![inspect1](/images/docker-2/inspect1.png)![inspect2](/images/docker-2/inspect2.png)\n\nhashhash\n![inspect3](/images/docker-2/inspect3.png)\n\n\n# \n\n\n1. \n2. \n3. DockerI/O\n\n# Dockerfile\n\nRUN\n\n```dockerfile\n# RUN\nRUN apt-get update && \\\n    apt-get install -y package1 package2 && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n```\n\n\n\n\n```dockerfile\n# \nRUN wget -qO- https://example.com/file.tar.gz | tar xz -C /path/to/destination\n```\n.dockerignore\n.gitignore.dockerignore\n\n```dockerignore\n# .dockerignore \nnode_modules\n.git\n.tmp\n```\n\n# Dockerfile\nDockerfile\n\n```dockerfile\nFROM python:3.8-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install -r requirements.txt\nCOPY . .\nRUN apt-get update\nRUN apt-get install -y curl\nRUN apt-get clean\nCMD [\"python\", \"app.py\"]\n```\nDockerfile\n\n```dockerfile\n# Dockerfile\nFROM python:3.8-slim\n\nWORKDIR /app\n\n# COPYRUN\nCOPY requirements.txt ./\nRUN apt-get update && \\\n    apt-get install -y curl && \\\n    pip install -r requirements.txt && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\n# .dockerignore\nCOPY . .\n\nCMD [\"python\", \"app.py\"]\n```\n20M\n![dockerfile](/images/docker-2/after.png)\n\n\n# \n## \nDockerfileFROM.net\n.net sdk\n\n```dockerfile\n# \nFROM net8-sdk AS build\nWORKDIR /app\n# \nCOPY . .\n# \nRUN dotnet publish \"src/Uranus.DatacenterMH/Uranus.DatacenterMH.csproj\" -c Release -o /app/publish\n\n# \nFROM net8-runtime\nWORKDIR /app\n# \nCOPY --from=build /app/publish .\n\nEXPOSE 80\nENTRYPOINT [\"dotnet\", \"Uranus.DatacenterMH.dll\"]\n```\n\n\n## \nDocker\n\n```bash\n# \ndocker image prune -a\n\n# \ndocker container prune\n```\n\n\nDockerfile.dockerignoreDocker\n\n\nDocker","source":"_posts/docker-2.md","raw":"---\ntitle: Docker\ndate: 2024-07-08 09:20:55\ntags:\n---\n\n# \nDockerDockerfileDockerfileDockerfile\n\n# Dockerfile\nDockerfileRUNCOPYADDDockerUnionFS\n\n```dockerfile\n# \nFROM python:3.8-slim\nWORKDIR /app\nCOPY . .\nRUN pip install -r requirements.txt\nCMD [\"python\", \"app.py\"]\n```\nDockerfileFROMWORKDIRCOPYRUN\n\n\nDockerRUNRUN\n\n1. RUNRUN apt-get install\n\n2. RUN\n\n3. RUN\n\n4. RUN\n\nDockerfile\n\n```dockerfile\nFROM ubuntu:20.04\n\n# \nRUN apt-get update && apt-get install -y curl\n\n# \nRUN echo \"Hello, World!\" > /hello.txt\n\n# \nRUN chmod 644 /hello.txt\n```\nRUN\n\n1. RUN apt-get update && apt-get install -y curl\n- curl\n- curl\n- \n2. RUN echo \"Hello, World!\" > /hello.txt\n- /hello.txt\"Hello, World!\"\n- /hello.txt\n\n3. RUN chmod 644 /hello.txt\n- /hello.txt\n- /hello.txt\n\nDocker\n\n# \nDocker  Union File System Dockerfile \n\n## \n\n\n1.  Docker \n\n2. Docker Docker Docker \n\n3. \n\n## \n Dockerfile\n\n```dockerfile\nFROM python:3.8-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install -r requirements.txt\nCOPY . .\nCMD [\"python\", \"app.py\"]\n```\nrequirements.txtrequirements.txt\n```\n# requirements.txt \nflask\nrequests\n```\n requirements.txt  COPY requirements.txt .  RUN pip install -r requirements.txt  FROM python:3.8-slimWORKDIR /appCOPY . .  CMD [\"python\", \"app.py\"]\n\ninspect\n![inspect1](/images/docker-2/inspect1.png)![inspect2](/images/docker-2/inspect2.png)\n\nhashhash\n![inspect3](/images/docker-2/inspect3.png)\n\n\n# \n\n\n1. \n2. \n3. DockerI/O\n\n# Dockerfile\n\nRUN\n\n```dockerfile\n# RUN\nRUN apt-get update && \\\n    apt-get install -y package1 package2 && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n```\n\n\n\n\n```dockerfile\n# \nRUN wget -qO- https://example.com/file.tar.gz | tar xz -C /path/to/destination\n```\n.dockerignore\n.gitignore.dockerignore\n\n```dockerignore\n# .dockerignore \nnode_modules\n.git\n.tmp\n```\n\n# Dockerfile\nDockerfile\n\n```dockerfile\nFROM python:3.8-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install -r requirements.txt\nCOPY . .\nRUN apt-get update\nRUN apt-get install -y curl\nRUN apt-get clean\nCMD [\"python\", \"app.py\"]\n```\nDockerfile\n\n```dockerfile\n# Dockerfile\nFROM python:3.8-slim\n\nWORKDIR /app\n\n# COPYRUN\nCOPY requirements.txt ./\nRUN apt-get update && \\\n    apt-get install -y curl && \\\n    pip install -r requirements.txt && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\n# .dockerignore\nCOPY . .\n\nCMD [\"python\", \"app.py\"]\n```\n20M\n![dockerfile](/images/docker-2/after.png)\n\n\n# \n## \nDockerfileFROM.net\n.net sdk\n\n```dockerfile\n# \nFROM net8-sdk AS build\nWORKDIR /app\n# \nCOPY . .\n# \nRUN dotnet publish \"src/Uranus.DatacenterMH/Uranus.DatacenterMH.csproj\" -c Release -o /app/publish\n\n# \nFROM net8-runtime\nWORKDIR /app\n# \nCOPY --from=build /app/publish .\n\nEXPOSE 80\nENTRYPOINT [\"dotnet\", \"Uranus.DatacenterMH.dll\"]\n```\n\n\n## \nDocker\n\n```bash\n# \ndocker image prune -a\n\n# \ndocker container prune\n```\n\n\nDockerfile.dockerignoreDocker\n\n\nDocker","slug":"docker-2","published":1,"updated":"2024-07-08T13:19:28.360Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh60003u8p1a6rr0y7t","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>DockerDockerfileDockerfileDockerfile</p>\n<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><p>DockerfileRUNCOPYADDDockerUnionFS</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> pip install -r requirements.txt</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>DockerfileFROMWORKDIRCOPYRUN</p>\n<p>DockerRUNRUN</p>\n<ol>\n<li><p>RUNRUN apt-get install</p>\n</li>\n<li><p>RUN</p>\n</li>\n<li><p>RUN</p>\n</li>\n<li><p>RUN</p>\n</li>\n</ol>\n<p>Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> ubuntu:<span class=\"number\">20.04</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update &amp;&amp; apt-get install -y curl</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Hello, World!&quot;</span> &gt; /hello.txt</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> <span class=\"built_in\">chmod</span> 644 /hello.txt</span></span><br></pre></td></tr></table></figure>\n<p>RUN</p>\n<ol>\n<li>RUN apt-get update &amp;&amp; apt-get install -y curl</li>\n</ol>\n<ul>\n<li>curl</li>\n<li>curl</li>\n<li></li>\n</ul>\n<ol start=\"2\">\n<li>RUN echo Hello, World! &gt; &#x2F;hello.txt</li>\n</ol>\n<ul>\n<li>&#x2F;hello.txtHello, World!</li>\n<li>&#x2F;hello.txt</li>\n</ul>\n<ol start=\"3\">\n<li>RUN chmod 644 &#x2F;hello.txt</li>\n</ol>\n<ul>\n<li>&#x2F;hello.txt</li>\n<li>&#x2F;hello.txt</li>\n</ul>\n<p>Docker</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Docker  Union File System Dockerfile </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li><p> Docker </p>\n</li>\n<li><p>Docker Docker Docker </p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> requirements.txt .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> pip install -r requirements.txt</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>requirements.txtrequirements.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># requirements.txt </span><br><span class=\"line\">flask</span><br><span class=\"line\">requests</span><br></pre></td></tr></table></figure>\n<p> requirements.txt  COPY requirements.txt .  RUN pip install -r requirements.txt  FROM python:3.8-slimWORKDIR &#x2F;appCOPY . .  CMD [python, app.py]</p>\n<p>inspect<br><img src=\"/images/docker-2/inspect1.png\" alt=\"inspect1\"><img src=\"/images/docker-2/inspect2.png\" alt=\"inspect2\"></p>\n<p>hashhash<br><img src=\"/images/docker-2/inspect3.png\" alt=\"inspect3\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li></li>\n<li></li>\n<li>DockerI&#x2F;O</li>\n</ol>\n<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><p><br>RUN</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># RUN</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get install -y package1 package2 &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get clean &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    <span class=\"built_in\">rm</span> -rf /var/lib/apt/lists/*</span></span><br></pre></td></tr></table></figure>\n\n<p><br></p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> wget -qO- https://example.com/file.tar.gz | tar xz -C /path/to/destination</span></span><br></pre></td></tr></table></figure>\n<p>.dockerignore<br>.gitignore.dockerignore</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># .dockerignore </span><br><span class=\"line\">node_modules</span><br><span class=\"line\">.git</span><br><span class=\"line\">.tmp</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><p>Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> requirements.txt .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> pip install -r requirements.txt</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get install -y curl</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get clean</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Dockerfile</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># COPYRUN</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> requirements.txt ./</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get install -y curl &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    pip install -r requirements.txt &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get clean &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    <span class=\"built_in\">rm</span> -rf /var/lib/apt/lists/*</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># .dockerignore</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>20M<br><img src=\"/images/docker-2/after.png\" alt=\"dockerfile\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>DockerfileFROM.net<br>.net sdk</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> net8-sdk AS build</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> dotnet publish <span class=\"string\">&quot;src/Uranus.DatacenterMH/Uranus.DatacenterMH.csproj&quot;</span> -c Release -o /app/publish</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> net8-runtime</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> --from=build /app/publish .</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">80</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"language-bash\"> [<span class=\"string\">&quot;dotnet&quot;</span>, <span class=\"string\">&quot;Uranus.DatacenterMH.dll&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Docker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker image prune -a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker container prune</span><br></pre></td></tr></table></figure>\n\n<p><br>Dockerfile.dockerignoreDocker</p>\n<p>Docker</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>DockerDockerfileDockerfileDockerfile</p>\n<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><p>DockerfileRUNCOPYADDDockerUnionFS</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> pip install -r requirements.txt</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>DockerfileFROMWORKDIRCOPYRUN</p>\n<p>DockerRUNRUN</p>\n<ol>\n<li><p>RUNRUN apt-get install</p>\n</li>\n<li><p>RUN</p>\n</li>\n<li><p>RUN</p>\n</li>\n<li><p>RUN</p>\n</li>\n</ol>\n<p>Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> ubuntu:<span class=\"number\">20.04</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update &amp;&amp; apt-get install -y curl</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> <span class=\"built_in\">echo</span> <span class=\"string\">&quot;Hello, World!&quot;</span> &gt; /hello.txt</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> <span class=\"built_in\">chmod</span> 644 /hello.txt</span></span><br></pre></td></tr></table></figure>\n<p>RUN</p>\n<ol>\n<li>RUN apt-get update &amp;&amp; apt-get install -y curl</li>\n</ol>\n<ul>\n<li>curl</li>\n<li>curl</li>\n<li></li>\n</ul>\n<ol start=\"2\">\n<li>RUN echo Hello, World! &gt; &#x2F;hello.txt</li>\n</ol>\n<ul>\n<li>&#x2F;hello.txtHello, World!</li>\n<li>&#x2F;hello.txt</li>\n</ul>\n<ol start=\"3\">\n<li>RUN chmod 644 &#x2F;hello.txt</li>\n</ol>\n<ul>\n<li>&#x2F;hello.txt</li>\n<li>&#x2F;hello.txt</li>\n</ul>\n<p>Docker</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Docker  Union File System Dockerfile </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li><p> Docker </p>\n</li>\n<li><p>Docker Docker Docker </p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> requirements.txt .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> pip install -r requirements.txt</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>requirements.txtrequirements.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># requirements.txt </span><br><span class=\"line\">flask</span><br><span class=\"line\">requests</span><br></pre></td></tr></table></figure>\n<p> requirements.txt  COPY requirements.txt .  RUN pip install -r requirements.txt  FROM python:3.8-slimWORKDIR &#x2F;appCOPY . .  CMD [python, app.py]</p>\n<p>inspect<br><img src=\"/images/docker-2/inspect1.png\" alt=\"inspect1\"><img src=\"/images/docker-2/inspect2.png\" alt=\"inspect2\"></p>\n<p>hashhash<br><img src=\"/images/docker-2/inspect3.png\" alt=\"inspect3\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li></li>\n<li></li>\n<li>DockerI&#x2F;O</li>\n</ol>\n<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><p><br>RUN</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># RUN</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get install -y package1 package2 &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get clean &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    <span class=\"built_in\">rm</span> -rf /var/lib/apt/lists/*</span></span><br></pre></td></tr></table></figure>\n\n<p><br></p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> wget -qO- https://example.com/file.tar.gz | tar xz -C /path/to/destination</span></span><br></pre></td></tr></table></figure>\n<p>.dockerignore<br>.gitignore.dockerignore</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># .dockerignore </span><br><span class=\"line\">node_modules</span><br><span class=\"line\">.git</span><br><span class=\"line\">.tmp</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><p>Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> requirements.txt .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> pip install -r requirements.txt</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get install -y curl</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get clean</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>Dockerfile</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Dockerfile</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> python:<span class=\"number\">3.8</span>-slim</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># COPYRUN</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> requirements.txt ./</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apt-get update &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get install -y curl &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    pip install -r requirements.txt &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    apt-get clean &amp;&amp; \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    <span class=\"built_in\">rm</span> -rf /var/lib/apt/lists/*</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># .dockerignore</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> [<span class=\"string\">&quot;python&quot;</span>, <span class=\"string\">&quot;app.py&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n<p>20M<br><img src=\"/images/docker-2/after.png\" alt=\"dockerfile\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>DockerfileFROM.net<br>.net sdk</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> net8-sdk AS build</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> dotnet publish <span class=\"string\">&quot;src/Uranus.DatacenterMH/Uranus.DatacenterMH.csproj&quot;</span> -c Release -o /app/publish</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> net8-runtime</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /app</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> --from=build /app/publish .</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">80</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"language-bash\"> [<span class=\"string\">&quot;dotnet&quot;</span>, <span class=\"string\">&quot;Uranus.DatacenterMH.dll&quot;</span>]</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Docker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker image prune -a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">docker container prune</span><br></pre></td></tr></table></figure>\n\n<p><br>Dockerfile.dockerignoreDocker</p>\n<p>Docker</p>\n"},{"title":"","date":"2024-08-08T06:58:18.000Z","_content":"\nDockerDocker\n\n\n\n# \n Dockerfile\n```\nFROM alpine\nRUN echo \"hello\" > /usr/file1.txt\nCOPY requirements.txt /usr/file2.txt\nRUN rm -rf /usr/file1.txt\n```\n\n\n\n\n1. FROM alpine/img/layer1\n\n2. /img/layer2/img/layer1 Dockerfile hello/img/layer2/usr/file1.txt\n\n3. /img/layer3img/layer2requirement.txt\n\n4. /img/layer4img/layer3img/layer4/usr/file1.txt\n\n.tar.gz.wh. .wh.file1.txt  .wh. \n\n\n\n|||\n|  ----  | ----  |\n|layer1.tar.gz|\tlinux|\n|layer2.tar.gz|\t/usr/file1.txt|\n|layer3.tar.gz|\t/usr/file2.txtfile1.txt|\n|layer4.tar.gz|\t/usr/.wh.file1.txtfile1.txtfile2.txt|\n\nlayer1 Git \n\n---\n\nCOPY --link\n\n# \n\n\n\n\n\n\n1. FROM alpinelinux\n\n2. layer2layer2.tar.gz/work/file1.txt \n\n3. layer3layer2layer3.tar.gz/work/file1.txt/work/file2.txt\n\n4. layer4layer3 layer4.tar.gzdiff applier whiteout  /work/.wh.file1.txt/work/file1.txt/work/file2.txt\n\n5. layer4layer4\n\n \n\n```\n \"RootFS\": {\n    \"Type\": \"layers\",\n    \"Layers\": [\n        \"sha256:78561cef0761903dd2f7d09856150a6d4fb48967a8f113f3e33d79effbf59a07\",\n        \"sha256:48dcbf93fac08ef430c39a4924c0622c13f17548cec0ca5588a665a773f5d091\",\n        \"sha256:53e113db23922a5cc6d6c916a2a796f87e8db900d5a8ece3237cbcc4db9e5b7e\",\n        \"sha256:df7fa7c302ca914532aaa453ec101e5f21b1c3bb81b2f5046321aa40f2de1399\"\n    ]\n},\n``` \n\n\n\n# \n\n![](/images/docker-layer/filesystem.png)\n\n\nOverlay \n\n 100 \n\n\n\n ext4  xfs \n\n 300MB 100  300MB*100= 30GB  30GB \n\n 30GB  100 30GB\n\n\nLinux\n\n\n\n tmpfs  overlayfs \n\nLinux \n\n## \n\n\n1. tmpfs\n```\nmkdir /mytmpfs\nmount -t tmpfs tmpfs /mytmpfs\n```\n\n2. lowerdirupperdirworkdirmerged\n```\nsudo mkdir -p /mytmpfs/lowerdir   # \nsudo mkdir -p /mytmpfs/upperdir   #  tmpfs \nsudo mkdir -p /mytmpfs/workdir    #  overlayfs \nsudo mkdir -p /mytmpfs/merged     # \n```\n\n3. \n```\ncd /mytmpfs\necho hello > lowerdir/hello.txt\necho \"delete me\" > lowerdir/delete-me.txt\necho message > upperdir/upper-message.txt\n```\n4. overlaymergedlowerupperwork\n```\nmount -t overlay overlay -o lowerdir=lowerdir,upperdir=upperdir,workdir=workdir merged\n```\n\n5. mergedupperlower\n![merged](/images/docker-layer/merged.png)\n```\nrm -rf merged/delete-me.txt\necho \"I'm new one\" > merged/new.txt\necho world >> merged/hello.txt\n```\n6. delete-me.txtmergednew.txt\n![directory tree](/images/docker-layer/tree.png)\n\n merged  rm -rf merged/delete-me.txt overlayfs  lowerdir  upperdir  .wh.delete-me.txt\n   \n\n## \n\nupperdir/ \n\nls -l upperdir \n![directory tree](/images/docker-layer/ls_upper.png)\n\n+ delete-me.txt lowerdir  .wh.delete-me.txt \n+ hello.txt lowerdir \n+ new.txt merged  upperdir\n+ upper-message.txt upperdir \n\nmountlowerdir  \n\n\n","source":"_posts/docker-layer.md","raw":"---\ntitle: \ndate: 2024-08-08 14:58:18\ntags:\n---\n\nDockerDocker\n\n\n\n# \n Dockerfile\n```\nFROM alpine\nRUN echo \"hello\" > /usr/file1.txt\nCOPY requirements.txt /usr/file2.txt\nRUN rm -rf /usr/file1.txt\n```\n\n\n\n\n1. FROM alpine/img/layer1\n\n2. /img/layer2/img/layer1 Dockerfile hello/img/layer2/usr/file1.txt\n\n3. /img/layer3img/layer2requirement.txt\n\n4. /img/layer4img/layer3img/layer4/usr/file1.txt\n\n.tar.gz.wh. .wh.file1.txt  .wh. \n\n\n\n|||\n|  ----  | ----  |\n|layer1.tar.gz|\tlinux|\n|layer2.tar.gz|\t/usr/file1.txt|\n|layer3.tar.gz|\t/usr/file2.txtfile1.txt|\n|layer4.tar.gz|\t/usr/.wh.file1.txtfile1.txtfile2.txt|\n\nlayer1 Git \n\n---\n\nCOPY --link\n\n# \n\n\n\n\n\n\n1. FROM alpinelinux\n\n2. layer2layer2.tar.gz/work/file1.txt \n\n3. layer3layer2layer3.tar.gz/work/file1.txt/work/file2.txt\n\n4. layer4layer3 layer4.tar.gzdiff applier whiteout  /work/.wh.file1.txt/work/file1.txt/work/file2.txt\n\n5. layer4layer4\n\n \n\n```\n \"RootFS\": {\n    \"Type\": \"layers\",\n    \"Layers\": [\n        \"sha256:78561cef0761903dd2f7d09856150a6d4fb48967a8f113f3e33d79effbf59a07\",\n        \"sha256:48dcbf93fac08ef430c39a4924c0622c13f17548cec0ca5588a665a773f5d091\",\n        \"sha256:53e113db23922a5cc6d6c916a2a796f87e8db900d5a8ece3237cbcc4db9e5b7e\",\n        \"sha256:df7fa7c302ca914532aaa453ec101e5f21b1c3bb81b2f5046321aa40f2de1399\"\n    ]\n},\n``` \n\n\n\n# \n\n![](/images/docker-layer/filesystem.png)\n\n\nOverlay \n\n 100 \n\n\n\n ext4  xfs \n\n 300MB 100  300MB*100= 30GB  30GB \n\n 30GB  100 30GB\n\n\nLinux\n\n\n\n tmpfs  overlayfs \n\nLinux \n\n## \n\n\n1. tmpfs\n```\nmkdir /mytmpfs\nmount -t tmpfs tmpfs /mytmpfs\n```\n\n2. lowerdirupperdirworkdirmerged\n```\nsudo mkdir -p /mytmpfs/lowerdir   # \nsudo mkdir -p /mytmpfs/upperdir   #  tmpfs \nsudo mkdir -p /mytmpfs/workdir    #  overlayfs \nsudo mkdir -p /mytmpfs/merged     # \n```\n\n3. \n```\ncd /mytmpfs\necho hello > lowerdir/hello.txt\necho \"delete me\" > lowerdir/delete-me.txt\necho message > upperdir/upper-message.txt\n```\n4. overlaymergedlowerupperwork\n```\nmount -t overlay overlay -o lowerdir=lowerdir,upperdir=upperdir,workdir=workdir merged\n```\n\n5. mergedupperlower\n![merged](/images/docker-layer/merged.png)\n```\nrm -rf merged/delete-me.txt\necho \"I'm new one\" > merged/new.txt\necho world >> merged/hello.txt\n```\n6. delete-me.txtmergednew.txt\n![directory tree](/images/docker-layer/tree.png)\n\n merged  rm -rf merged/delete-me.txt overlayfs  lowerdir  upperdir  .wh.delete-me.txt\n   \n\n## \n\nupperdir/ \n\nls -l upperdir \n![directory tree](/images/docker-layer/ls_upper.png)\n\n+ delete-me.txt lowerdir  .wh.delete-me.txt \n+ hello.txt lowerdir \n+ new.txt merged  upperdir\n+ upper-message.txt upperdir \n\nmountlowerdir  \n\n\n","slug":"docker-layer","published":1,"updated":"2024-08-12T07:41:01.339Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh60004u8p10rur428e","content":"<p>DockerDocker</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Dockerfile</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM alpine</span><br><span class=\"line\">RUN echo &quot;hello&quot; &gt; /usr/file1.txt</span><br><span class=\"line\">COPY requirements.txt /usr/file2.txt</span><br><span class=\"line\">RUN rm -rf /usr/file1.txt</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<ol>\n<li><p>FROM alpine&#x2F;img&#x2F;layer1</p>\n</li>\n<li><p>&#x2F;img&#x2F;layer2&#x2F;img&#x2F;layer1 Dockerfile hello&#x2F;img&#x2F;layer2&#x2F;usr&#x2F;file1.txt</p>\n</li>\n<li><p>&#x2F;img&#x2F;layer3img&#x2F;layer2requirement.txt</p>\n</li>\n<li><p>&#x2F;img&#x2F;layer4img&#x2F;layer3img&#x2F;layer4&#x2F;usr&#x2F;file1.txt</p>\n</li>\n</ol>\n<p>.tar.gz.wh. .wh.file1.txt  .wh. </p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>layer1.tar.gz</td>\n<td>linux</td>\n</tr>\n<tr>\n<td>layer2.tar.gz</td>\n<td>&#x2F;usr&#x2F;file1.txt</td>\n</tr>\n<tr>\n<td>layer3.tar.gz</td>\n<td>&#x2F;usr&#x2F;file2.txtfile1.txt</td>\n</tr>\n<tr>\n<td>layer4.tar.gz</td>\n<td>&#x2F;usr&#x2F;.wh.file1.txtfile1.txtfile2.txt</td>\n</tr>\n</tbody></table>\n<p>layer1 Git </p>\n<p></p>\n<p>COPY link</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<ol>\n<li><p>FROM alpinelinux</p>\n</li>\n<li><p>layer2layer2.tar.gz&#x2F;work&#x2F;file1.txt </p>\n</li>\n<li><p>layer3layer2layer3.tar.gz&#x2F;work&#x2F;file1.txt&#x2F;work&#x2F;file2.txt</p>\n</li>\n<li><p>layer4layer3 layer4.tar.gzdiff applier whiteout  &#x2F;work&#x2F;.wh.file1.txt&#x2F;work&#x2F;file1.txt&#x2F;work&#x2F;file2.txt</p>\n</li>\n<li><p>layer4layer4</p>\n</li>\n</ol>\n<p> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &quot;RootFS&quot;: &#123;</span><br><span class=\"line\">    &quot;Type&quot;: &quot;layers&quot;,</span><br><span class=\"line\">    &quot;Layers&quot;: [</span><br><span class=\"line\">        &quot;sha256:78561cef0761903dd2f7d09856150a6d4fb48967a8f113f3e33d79effbf59a07&quot;,</span><br><span class=\"line\">        &quot;sha256:48dcbf93fac08ef430c39a4924c0622c13f17548cec0ca5588a665a773f5d091&quot;,</span><br><span class=\"line\">        &quot;sha256:53e113db23922a5cc6d6c916a2a796f87e8db900d5a8ece3237cbcc4db9e5b7e&quot;,</span><br><span class=\"line\">        &quot;sha256:df7fa7c302ca914532aaa453ec101e5f21b1c3bb81b2f5046321aa40f2de1399&quot;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><br><img src=\"/images/docker-layer/filesystem.png\" alt=\"\"></p>\n<p>Overlay </p>\n<p> 100 </p>\n<p></p>\n<p> ext4  xfs </p>\n<p> 300MB 100  300MB*100&#x3D; 30GB  30GB </p>\n<p> 30GB  100 30GB</p>\n<p>Linux</p>\n<p></p>\n<p> tmpfs  overlayfs </p>\n<p>Linux </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li><p>tmpfs</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /mytmpfs</span><br><span class=\"line\">mount -t tmpfs tmpfs /mytmpfs</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>lowerdirupperdirworkdirmerged</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo mkdir -p /mytmpfs/lowerdir   # </span><br><span class=\"line\">sudo mkdir -p /mytmpfs/upperdir   #  tmpfs </span><br><span class=\"line\">sudo mkdir -p /mytmpfs/workdir    #  overlayfs </span><br><span class=\"line\">sudo mkdir -p /mytmpfs/merged     # </span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /mytmpfs</span><br><span class=\"line\">echo hello &gt; lowerdir/hello.txt</span><br><span class=\"line\">echo &quot;delete me&quot; &gt; lowerdir/delete-me.txt</span><br><span class=\"line\">echo message &gt; upperdir/upper-message.txt</span><br></pre></td></tr></table></figure></li>\n<li><p>overlaymergedlowerupperwork</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mount -t overlay overlay -o lowerdir=lowerdir,upperdir=upperdir,workdir=workdir merged</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>mergedupperlower<br><img src=\"/images/docker-layer/merged.png\" alt=\"merged\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf merged/delete-me.txt</span><br><span class=\"line\">echo &quot;I&#x27;m new one&quot; &gt; merged/new.txt</span><br><span class=\"line\">echo world &gt;&gt; merged/hello.txt</span><br></pre></td></tr></table></figure></li>\n<li><p>delete-me.txtmergednew.txt<br><img src=\"/images/docker-layer/tree.png\" alt=\"directory tree\"></p>\n</li>\n</ol>\n<p> merged  rm -rf merged&#x2F;delete-me.txt overlayfs  lowerdir  upperdir  .wh.delete-me.txt</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>upperdir&#x2F; </p>\n<p>ls -l upperdir <br><img src=\"/images/docker-layer/ls_upper.png\" alt=\"directory tree\"></p>\n<ul>\n<li>delete-me.txt lowerdir  .wh.delete-me.txt </li>\n<li>hello.txt lowerdir </li>\n<li>new.txt merged  upperdir</li>\n<li>upper-message.txt upperdir </li>\n</ul>\n<p>mountlowerdir  </p>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<p>DockerDocker</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Dockerfile</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM alpine</span><br><span class=\"line\">RUN echo &quot;hello&quot; &gt; /usr/file1.txt</span><br><span class=\"line\">COPY requirements.txt /usr/file2.txt</span><br><span class=\"line\">RUN rm -rf /usr/file1.txt</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<ol>\n<li><p>FROM alpine&#x2F;img&#x2F;layer1</p>\n</li>\n<li><p>&#x2F;img&#x2F;layer2&#x2F;img&#x2F;layer1 Dockerfile hello&#x2F;img&#x2F;layer2&#x2F;usr&#x2F;file1.txt</p>\n</li>\n<li><p>&#x2F;img&#x2F;layer3img&#x2F;layer2requirement.txt</p>\n</li>\n<li><p>&#x2F;img&#x2F;layer4img&#x2F;layer3img&#x2F;layer4&#x2F;usr&#x2F;file1.txt</p>\n</li>\n</ol>\n<p>.tar.gz.wh. .wh.file1.txt  .wh. </p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>layer1.tar.gz</td>\n<td>linux</td>\n</tr>\n<tr>\n<td>layer2.tar.gz</td>\n<td>&#x2F;usr&#x2F;file1.txt</td>\n</tr>\n<tr>\n<td>layer3.tar.gz</td>\n<td>&#x2F;usr&#x2F;file2.txtfile1.txt</td>\n</tr>\n<tr>\n<td>layer4.tar.gz</td>\n<td>&#x2F;usr&#x2F;.wh.file1.txtfile1.txtfile2.txt</td>\n</tr>\n</tbody></table>\n<p>layer1 Git </p>\n<p></p>\n<p>COPY link</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<ol>\n<li><p>FROM alpinelinux</p>\n</li>\n<li><p>layer2layer2.tar.gz&#x2F;work&#x2F;file1.txt </p>\n</li>\n<li><p>layer3layer2layer3.tar.gz&#x2F;work&#x2F;file1.txt&#x2F;work&#x2F;file2.txt</p>\n</li>\n<li><p>layer4layer3 layer4.tar.gzdiff applier whiteout  &#x2F;work&#x2F;.wh.file1.txt&#x2F;work&#x2F;file1.txt&#x2F;work&#x2F;file2.txt</p>\n</li>\n<li><p>layer4layer4</p>\n</li>\n</ol>\n<p> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &quot;RootFS&quot;: &#123;</span><br><span class=\"line\">    &quot;Type&quot;: &quot;layers&quot;,</span><br><span class=\"line\">    &quot;Layers&quot;: [</span><br><span class=\"line\">        &quot;sha256:78561cef0761903dd2f7d09856150a6d4fb48967a8f113f3e33d79effbf59a07&quot;,</span><br><span class=\"line\">        &quot;sha256:48dcbf93fac08ef430c39a4924c0622c13f17548cec0ca5588a665a773f5d091&quot;,</span><br><span class=\"line\">        &quot;sha256:53e113db23922a5cc6d6c916a2a796f87e8db900d5a8ece3237cbcc4db9e5b7e&quot;,</span><br><span class=\"line\">        &quot;sha256:df7fa7c302ca914532aaa453ec101e5f21b1c3bb81b2f5046321aa40f2de1399&quot;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><br><img src=\"/images/docker-layer/filesystem.png\" alt=\"\"></p>\n<p>Overlay </p>\n<p> 100 </p>\n<p></p>\n<p> ext4  xfs </p>\n<p> 300MB 100  300MB*100&#x3D; 30GB  30GB </p>\n<p> 30GB  100 30GB</p>\n<p>Linux</p>\n<p></p>\n<p> tmpfs  overlayfs </p>\n<p>Linux </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li><p>tmpfs</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir /mytmpfs</span><br><span class=\"line\">mount -t tmpfs tmpfs /mytmpfs</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>lowerdirupperdirworkdirmerged</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo mkdir -p /mytmpfs/lowerdir   # </span><br><span class=\"line\">sudo mkdir -p /mytmpfs/upperdir   #  tmpfs </span><br><span class=\"line\">sudo mkdir -p /mytmpfs/workdir    #  overlayfs </span><br><span class=\"line\">sudo mkdir -p /mytmpfs/merged     # </span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /mytmpfs</span><br><span class=\"line\">echo hello &gt; lowerdir/hello.txt</span><br><span class=\"line\">echo &quot;delete me&quot; &gt; lowerdir/delete-me.txt</span><br><span class=\"line\">echo message &gt; upperdir/upper-message.txt</span><br></pre></td></tr></table></figure></li>\n<li><p>overlaymergedlowerupperwork</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mount -t overlay overlay -o lowerdir=lowerdir,upperdir=upperdir,workdir=workdir merged</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>mergedupperlower<br><img src=\"/images/docker-layer/merged.png\" alt=\"merged\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf merged/delete-me.txt</span><br><span class=\"line\">echo &quot;I&#x27;m new one&quot; &gt; merged/new.txt</span><br><span class=\"line\">echo world &gt;&gt; merged/hello.txt</span><br></pre></td></tr></table></figure></li>\n<li><p>delete-me.txtmergednew.txt<br><img src=\"/images/docker-layer/tree.png\" alt=\"directory tree\"></p>\n</li>\n</ol>\n<p> merged  rm -rf merged&#x2F;delete-me.txt overlayfs  lowerdir  upperdir  .wh.delete-me.txt</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>upperdir&#x2F; </p>\n<p>ls -l upperdir <br><img src=\"/images/docker-layer/ls_upper.png\" alt=\"directory tree\"></p>\n<ul>\n<li>delete-me.txt lowerdir  .wh.delete-me.txt </li>\n<li>hello.txt lowerdir </li>\n<li>new.txt merged  upperdir</li>\n<li>upper-message.txt upperdir </li>\n</ul>\n<p>mountlowerdir  </p>\n<p></p>\n"},{"title":"Dump","date":"2024-04-28T06:18:14.000Z","_content":"\n\n\n\n![crash](./images/dump/crash.jpeg)\n\nDump  Dump  Dump \n\n\n# Dump \nDump Dump  .dmp  .core \n\n##  Dump \n+ Full Memory Dump  Dump \n+ Mini Dump  Dump \n+ Core Dump  Unix/Linux \n\n# Dump \n1.  Dump   Dump \n2.   Dump  WinDbgGDBVisual Studio \n3. dump\n    +  \n    +  \n    +  \n    +  \n4.  \n\n# Dump \n\n\n\n1.  .NET  Web \n2. docker \n3. createdump .NET Core runtime  dump \n3. \n\n## dump\n### \n```\ndocker exec -it wpp bash\n```\n### .net\n```\nroot@4aa6a7d51e1e:/# \nroot@4aa6a7d51e1e:/# find / -name createdump\n/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0/createdump\nroot@4aa6a7d51e1e:/# cd /usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0           \nroot@4aa6a7d51e1e:/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0# \n\n```\n### createdump\n```\ncreatedump [options] pid\n-f, --name - dump path and file name. The default is '/tmp/coredump.%p'. These specifiers are substituted with following values:\n   %p  PID of dumped process.\n   %e  The process executable filename.\n   %h  Hostname return by gethostname().\n   %t  Time of dump, expressed as seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC).\n-n, --normal - create minidump.\n-h, --withheap - create minidump with heap (default).\n-t, --triage - create triage minidump.\n-u, --full - create full core dump.\n-d, --diag - enable diagnostic messages.\n```\ntopid\n```\n PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND\n    1     0 root     S     261g7842%   0% dotnet SubscriptionAccount.dll\n11480     0 root     S     4188   0%   0% bash\n11845 11480 root     R     3268   0%   0% top\n\n```\n\n```\n./createdump -f /tmp/wpp_dump -u 1\n```\n> docker --privileged=true \n\n### dump\n```\nsudo docker cp wpp:/tmp/wpp_dump /tmp/wpp_dump\n```\n## WinDbg dump\n\n\nSystem.Byte[]\n\n![](/images/dump/windbg_1.png)\n![](/images/dump/windbg_2.png)\n\n![](/images/dump/windbg_3.png)\n\n![bug](/images/dump/windbg_4.png)\nsql\n 85,000 .NET Large Object HeapLOH\n\n\n# \n Dump Dump  Dump ","source":"_posts/dump.md","raw":"---\ntitle: Dump\ndate: 2024-04-28 14:18:14\ntags: dump  \n---\n\n\n\n\n![crash](./images/dump/crash.jpeg)\n\nDump  Dump  Dump \n\n\n# Dump \nDump Dump  .dmp  .core \n\n##  Dump \n+ Full Memory Dump  Dump \n+ Mini Dump  Dump \n+ Core Dump  Unix/Linux \n\n# Dump \n1.  Dump   Dump \n2.   Dump  WinDbgGDBVisual Studio \n3. dump\n    +  \n    +  \n    +  \n    +  \n4.  \n\n# Dump \n\n\n\n1.  .NET  Web \n2. docker \n3. createdump .NET Core runtime  dump \n3. \n\n## dump\n### \n```\ndocker exec -it wpp bash\n```\n### .net\n```\nroot@4aa6a7d51e1e:/# \nroot@4aa6a7d51e1e:/# find / -name createdump\n/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0/createdump\nroot@4aa6a7d51e1e:/# cd /usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0           \nroot@4aa6a7d51e1e:/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0# \n\n```\n### createdump\n```\ncreatedump [options] pid\n-f, --name - dump path and file name. The default is '/tmp/coredump.%p'. These specifiers are substituted with following values:\n   %p  PID of dumped process.\n   %e  The process executable filename.\n   %h  Hostname return by gethostname().\n   %t  Time of dump, expressed as seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC).\n-n, --normal - create minidump.\n-h, --withheap - create minidump with heap (default).\n-t, --triage - create triage minidump.\n-u, --full - create full core dump.\n-d, --diag - enable diagnostic messages.\n```\ntopid\n```\n PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND\n    1     0 root     S     261g7842%   0% dotnet SubscriptionAccount.dll\n11480     0 root     S     4188   0%   0% bash\n11845 11480 root     R     3268   0%   0% top\n\n```\n\n```\n./createdump -f /tmp/wpp_dump -u 1\n```\n> docker --privileged=true \n\n### dump\n```\nsudo docker cp wpp:/tmp/wpp_dump /tmp/wpp_dump\n```\n## WinDbg dump\n\n\nSystem.Byte[]\n\n![](/images/dump/windbg_1.png)\n![](/images/dump/windbg_2.png)\n\n![](/images/dump/windbg_3.png)\n\n![bug](/images/dump/windbg_4.png)\nsql\n 85,000 .NET Large Object HeapLOH\n\n\n# \n Dump Dump  Dump ","slug":"dump","published":1,"updated":"2024-05-08T08:37:58.693Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh70005u8p1d7vcawvp","content":"<p><br></p>\n<p><img src=\"/./images/dump/crash.jpeg\" alt=\"crash\"></p>\n<p>Dump  Dump  Dump </p>\n<h1 id=\"Dump-\"><a href=\"#Dump-\" class=\"headerlink\" title=\"Dump \"></a>Dump </h1><p>Dump Dump  .dmp  .core </p>\n<h2 id=\"-Dump-\"><a href=\"#-Dump-\" class=\"headerlink\" title=\" Dump \"></a> Dump </h2><ul>\n<li>Full Memory Dump  Dump </li>\n<li>Mini Dump  Dump </li>\n<li>Core Dump  Unix&#x2F;Linux </li>\n</ul>\n<h1 id=\"Dump-\"><a href=\"#Dump-\" class=\"headerlink\" title=\"Dump \"></a>Dump </h1><ol>\n<li> Dump   Dump </li>\n<li>  Dump  WinDbgGDBVisual Studio </li>\n<li>dump<ul>\n<li> </li>\n<li> </li>\n<li> </li>\n<li> </li>\n</ul>\n</li>\n<li> </li>\n</ol>\n<h1 id=\"Dump-\"><a href=\"#Dump-\" class=\"headerlink\" title=\"Dump \"></a>Dump </h1><p></p>\n<p></p>\n<ol>\n<li> .NET  Web </li>\n<li>docker </li>\n<li>createdump .NET Core runtime  dump </li>\n<li></li>\n</ol>\n<h2 id=\"dump\"><a href=\"#dump\" class=\"headerlink\" title=\"dump\"></a>dump</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it wpp bash</span><br></pre></td></tr></table></figure>\n<h3 id=\"-net\"><a href=\"#-net\" class=\"headerlink\" title=\".net\"></a>.net</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@4aa6a7d51e1e:/# </span><br><span class=\"line\">root@4aa6a7d51e1e:/# find / -name createdump</span><br><span class=\"line\">/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0/createdump</span><br><span class=\"line\">root@4aa6a7d51e1e:/# cd /usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0           </span><br><span class=\"line\">root@4aa6a7d51e1e:/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0# </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"createdump\"><a href=\"#createdump\" class=\"headerlink\" title=\"createdump\"></a>createdump</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">createdump [options] pid</span><br><span class=\"line\">-f, --name - dump path and file name. The default is &#x27;/tmp/coredump.%p&#x27;. These specifiers are substituted with following values:</span><br><span class=\"line\">   %p  PID of dumped process.</span><br><span class=\"line\">   %e  The process executable filename.</span><br><span class=\"line\">   %h  Hostname return by gethostname().</span><br><span class=\"line\">   %t  Time of dump, expressed as seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC).</span><br><span class=\"line\">-n, --normal - create minidump.</span><br><span class=\"line\">-h, --withheap - create minidump with heap (default).</span><br><span class=\"line\">-t, --triage - create triage minidump.</span><br><span class=\"line\">-u, --full - create full core dump.</span><br><span class=\"line\">-d, --diag - enable diagnostic messages.</span><br></pre></td></tr></table></figure>\n<p>topid</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND</span><br><span class=\"line\">    1     0 root     S     261g7842%   0% dotnet SubscriptionAccount.dll</span><br><span class=\"line\">11480     0 root     S     4188   0%   0% bash</span><br><span class=\"line\">11845 11480 root     R     3268   0%   0% top</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./createdump -f /tmp/wpp_dump -u 1</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>docker privileged&#x3D;true </p>\n</blockquote>\n<h3 id=\"dump\"><a href=\"#dump\" class=\"headerlink\" title=\"dump\"></a>dump</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker cp wpp:/tmp/wpp_dump /tmp/wpp_dump</span><br></pre></td></tr></table></figure>\n<h2 id=\"WinDbg-dump\"><a href=\"#WinDbg-dump\" class=\"headerlink\" title=\"WinDbg dump\"></a>WinDbg dump</h2><p></p>\n<p>System.Byte[]<br><br><img src=\"/images/dump/windbg_1.png\" alt=\"\"><br><img src=\"/images/dump/windbg_2.png\" alt=\"\"><br><br><img src=\"/images/dump/windbg_3.png\" alt=\"\"><br><br><img src=\"/images/dump/windbg_4.png\" alt=\"bug\"><br>sql<br> 85,000 .NET Large Object HeapLOH</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Dump Dump  Dump </p>\n","site":{"data":{}},"excerpt":"","more":"<p><br></p>\n<p><img src=\"/./images/dump/crash.jpeg\" alt=\"crash\"></p>\n<p>Dump  Dump  Dump </p>\n<h1 id=\"Dump-\"><a href=\"#Dump-\" class=\"headerlink\" title=\"Dump \"></a>Dump </h1><p>Dump Dump  .dmp  .core </p>\n<h2 id=\"-Dump-\"><a href=\"#-Dump-\" class=\"headerlink\" title=\" Dump \"></a> Dump </h2><ul>\n<li>Full Memory Dump  Dump </li>\n<li>Mini Dump  Dump </li>\n<li>Core Dump  Unix&#x2F;Linux </li>\n</ul>\n<h1 id=\"Dump-\"><a href=\"#Dump-\" class=\"headerlink\" title=\"Dump \"></a>Dump </h1><ol>\n<li> Dump   Dump </li>\n<li>  Dump  WinDbgGDBVisual Studio </li>\n<li>dump<ul>\n<li> </li>\n<li> </li>\n<li> </li>\n<li> </li>\n</ul>\n</li>\n<li> </li>\n</ol>\n<h1 id=\"Dump-\"><a href=\"#Dump-\" class=\"headerlink\" title=\"Dump \"></a>Dump </h1><p></p>\n<p></p>\n<ol>\n<li> .NET  Web </li>\n<li>docker </li>\n<li>createdump .NET Core runtime  dump </li>\n<li></li>\n</ol>\n<h2 id=\"dump\"><a href=\"#dump\" class=\"headerlink\" title=\"dump\"></a>dump</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it wpp bash</span><br></pre></td></tr></table></figure>\n<h3 id=\"-net\"><a href=\"#-net\" class=\"headerlink\" title=\".net\"></a>.net</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@4aa6a7d51e1e:/# </span><br><span class=\"line\">root@4aa6a7d51e1e:/# find / -name createdump</span><br><span class=\"line\">/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0/createdump</span><br><span class=\"line\">root@4aa6a7d51e1e:/# cd /usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0           </span><br><span class=\"line\">root@4aa6a7d51e1e:/usr/share/dotnet/shared/Microsoft.NETCore.App/8.0.0# </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"createdump\"><a href=\"#createdump\" class=\"headerlink\" title=\"createdump\"></a>createdump</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">createdump [options] pid</span><br><span class=\"line\">-f, --name - dump path and file name. The default is &#x27;/tmp/coredump.%p&#x27;. These specifiers are substituted with following values:</span><br><span class=\"line\">   %p  PID of dumped process.</span><br><span class=\"line\">   %e  The process executable filename.</span><br><span class=\"line\">   %h  Hostname return by gethostname().</span><br><span class=\"line\">   %t  Time of dump, expressed as seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC).</span><br><span class=\"line\">-n, --normal - create minidump.</span><br><span class=\"line\">-h, --withheap - create minidump with heap (default).</span><br><span class=\"line\">-t, --triage - create triage minidump.</span><br><span class=\"line\">-u, --full - create full core dump.</span><br><span class=\"line\">-d, --diag - enable diagnostic messages.</span><br></pre></td></tr></table></figure>\n<p>topid</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND</span><br><span class=\"line\">    1     0 root     S     261g7842%   0% dotnet SubscriptionAccount.dll</span><br><span class=\"line\">11480     0 root     S     4188   0%   0% bash</span><br><span class=\"line\">11845 11480 root     R     3268   0%   0% top</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./createdump -f /tmp/wpp_dump -u 1</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>docker privileged&#x3D;true </p>\n</blockquote>\n<h3 id=\"dump\"><a href=\"#dump\" class=\"headerlink\" title=\"dump\"></a>dump</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker cp wpp:/tmp/wpp_dump /tmp/wpp_dump</span><br></pre></td></tr></table></figure>\n<h2 id=\"WinDbg-dump\"><a href=\"#WinDbg-dump\" class=\"headerlink\" title=\"WinDbg dump\"></a>WinDbg dump</h2><p></p>\n<p>System.Byte[]<br><br><img src=\"/images/dump/windbg_1.png\" alt=\"\"><br><img src=\"/images/dump/windbg_2.png\" alt=\"\"><br><br><img src=\"/images/dump/windbg_3.png\" alt=\"\"><br><br><img src=\"/images/dump/windbg_4.png\" alt=\"bug\"><br>sql<br> 85,000 .NET Large Object HeapLOH</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Dump Dump  Dump </p>\n"},{"title":"","date":"2024-05-22T07:37:54.000Z","_content":"\n>MQDead Letter Queue, DLQ\n\n# \nDead Letter QueueDLQ\n\n![](/images/dead-message/dead-letter-exchange-1.png)\n\n# \n\n\n+ \n+ \n+ \n# \n+ \n+ \n+ \n+ \n# \n\n\n1. \n2. \n```C#\nvar properties = channel.CreateBasicProperties();\nproperties.Expiration = \"60000\"; // 60\n\nchannel.BasicPublish(\n    exchange: \"\",\n    routingKey: \"normal_queue\",\n    basicProperties: properties,\n    body: Encoding.UTF8.GetBytes(\"Test Message\")\n);\n```\n3. \n```C#\nvar consumer = new EventingBasicConsumer(channel);\nconsumer.Received += (model, ea) =>\n{\n    var body = ea.Body.ToArray();\n    var message = Encoding.UTF8.GetString(body);\n    \n    // \n    channel.BasicReject(deliveryTag: ea.DeliveryTag, requeue: false);\n};\n\nchannel.BasicConsume(queue: \"normal_queue\", autoAck: false, consumer: consumer);\n```\n4. \n# \n\n\n1. \n2. \n3. \n4. \n\n![](/images/dead-message/dead-letter-exchange-1.png)\n\n# RabbitMQ\n\n\n\n\n\n\n1. \n\n\n```C#\n//\nclient.CreateQueueBind(\"Alert-Notify2.voice\");\nDictionary<string, object> args = new Dictionary<string, object>\n{\n    [\"x-dead-letter-exchange\"] = Exchanges.Direct,\n    //\n    [\"x-dead-letter-routing-key\"] = \"Alert-Notify2.voice\"\n};\nclient.CreateQueueBind(\"Alert-Notify2.voice_wait\", null, null, args);\n\n```\n\n2. \n\n\n```C#\n //\n RabbitSubscriber.StartAsync<AlertNotifyPackage, NotifyVoiceMessageHandler>(new RabbitSubscriberArgs\n {\n     SettingName = RabbitSettings.Rabbit,\n     QueueName = \"Alert-Notify2.voice\",\n     SubscriberCount = Settings.GetInt(\"Alert_Notify2_voice_SubscriberCount\", 2)\n });\n```\n![1](/images/dead-message/delay_comsuption_1.png)\n\n![](/images/dead-message/delay_comsuption_2.png)\n\n3. \n```C#\nusing (RabbitClient client = new RabbitClient(RabbitSettings.Rabbit, \"NotifyService.Rabbit.MQ\"))\n{\n    //SendMessage(Alert-Notify2.voice)\n    IBasicProperties properties = client.GetBasicProperties();\n    properties.Expiration = (60 * 1000 * Notify2RabbitInit.VoiceConfig.TimeOut).ToString();                \n    client.SendMessage(package, null, \"Alert-Notify2.voice_wait\", properties);\n}\n\n```\n\n![](/images/dead-message/dead-letter-3.png)\n\n# \n","source":"_posts/dead-message.md","raw":"---\ntitle: \ndate: 2024-05-22 15:37:54\ntags:\n---\n\n>MQDead Letter Queue, DLQ\n\n# \nDead Letter QueueDLQ\n\n![](/images/dead-message/dead-letter-exchange-1.png)\n\n# \n\n\n+ \n+ \n+ \n# \n+ \n+ \n+ \n+ \n# \n\n\n1. \n2. \n```C#\nvar properties = channel.CreateBasicProperties();\nproperties.Expiration = \"60000\"; // 60\n\nchannel.BasicPublish(\n    exchange: \"\",\n    routingKey: \"normal_queue\",\n    basicProperties: properties,\n    body: Encoding.UTF8.GetBytes(\"Test Message\")\n);\n```\n3. \n```C#\nvar consumer = new EventingBasicConsumer(channel);\nconsumer.Received += (model, ea) =>\n{\n    var body = ea.Body.ToArray();\n    var message = Encoding.UTF8.GetString(body);\n    \n    // \n    channel.BasicReject(deliveryTag: ea.DeliveryTag, requeue: false);\n};\n\nchannel.BasicConsume(queue: \"normal_queue\", autoAck: false, consumer: consumer);\n```\n4. \n# \n\n\n1. \n2. \n3. \n4. \n\n![](/images/dead-message/dead-letter-exchange-1.png)\n\n# RabbitMQ\n\n\n\n\n\n\n1. \n\n\n```C#\n//\nclient.CreateQueueBind(\"Alert-Notify2.voice\");\nDictionary<string, object> args = new Dictionary<string, object>\n{\n    [\"x-dead-letter-exchange\"] = Exchanges.Direct,\n    //\n    [\"x-dead-letter-routing-key\"] = \"Alert-Notify2.voice\"\n};\nclient.CreateQueueBind(\"Alert-Notify2.voice_wait\", null, null, args);\n\n```\n\n2. \n\n\n```C#\n //\n RabbitSubscriber.StartAsync<AlertNotifyPackage, NotifyVoiceMessageHandler>(new RabbitSubscriberArgs\n {\n     SettingName = RabbitSettings.Rabbit,\n     QueueName = \"Alert-Notify2.voice\",\n     SubscriberCount = Settings.GetInt(\"Alert_Notify2_voice_SubscriberCount\", 2)\n });\n```\n![1](/images/dead-message/delay_comsuption_1.png)\n\n![](/images/dead-message/delay_comsuption_2.png)\n\n3. \n```C#\nusing (RabbitClient client = new RabbitClient(RabbitSettings.Rabbit, \"NotifyService.Rabbit.MQ\"))\n{\n    //SendMessage(Alert-Notify2.voice)\n    IBasicProperties properties = client.GetBasicProperties();\n    properties.Expiration = (60 * 1000 * Notify2RabbitInit.VoiceConfig.TimeOut).ToString();                \n    client.SendMessage(package, null, \"Alert-Notify2.voice_wait\", properties);\n}\n\n```\n\n![](/images/dead-message/dead-letter-3.png)\n\n# \n","slug":"dead-message","published":1,"updated":"2024-05-25T09:23:07.803Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh70006u8p1cynmchso","content":"<blockquote>\n<p>MQDead Letter Queue, DLQ</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Dead Letter QueueDLQ</p>\n<p><img src=\"/images/dead-message/dead-letter-exchange-1.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li></li>\n<li><figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> properties = channel.CreateBasicProperties();</span><br><span class=\"line\">properties.Expiration = <span class=\"string\">&quot;60000&quot;</span>; <span class=\"comment\">// 60</span></span><br><span class=\"line\"></span><br><span class=\"line\">channel.BasicPublish(</span><br><span class=\"line\">    exchange: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">    routingKey: <span class=\"string\">&quot;normal_queue&quot;</span>,</span><br><span class=\"line\">    basicProperties: properties,</span><br><span class=\"line\">    body: Encoding.UTF8.GetBytes(<span class=\"string\">&quot;Test Message&quot;</span>)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure></li>\n<li><figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> consumer = <span class=\"keyword\">new</span> EventingBasicConsumer(channel);</span><br><span class=\"line\">consumer.Received += (model, ea) =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    channel.BasicReject(deliveryTag: ea.DeliveryTag, requeue: <span class=\"literal\">false</span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">channel.BasicConsume(queue: <span class=\"string\">&quot;normal_queue&quot;</span>, autoAck: <span class=\"literal\">false</span>, consumer: consumer);</span><br></pre></td></tr></table></figure></li>\n<li></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><img src=\"/images/dead-message/dead-letter-exchange-1.png\" alt=\"\"></p>\n<h1 id=\"RabbitMQ\"><a href=\"#RabbitMQ\" class=\"headerlink\" title=\"RabbitMQ\"></a>RabbitMQ</h1><p></p>\n<p><br></p>\n<ol>\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">client.CreateQueueBind(<span class=\"string\">&quot;Alert-Notify2.voice&quot;</span>);</span><br><span class=\"line\">Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt; args = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    [<span class=\"string\">&quot;x-dead-letter-exchange&quot;</span>] = Exchanges.Direct,</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    [<span class=\"string\">&quot;x-dead-letter-routing-key&quot;</span>] = <span class=\"string\">&quot;Alert-Notify2.voice&quot;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">client.CreateQueueBind(<span class=\"string\">&quot;Alert-Notify2.voice_wait&quot;</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, args);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">RabbitSubscriber.StartAsync&lt;AlertNotifyPackage, NotifyVoiceMessageHandler&gt;(<span class=\"keyword\">new</span> RabbitSubscriberArgs</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    SettingName = RabbitSettings.Rabbit,</span><br><span class=\"line\">    QueueName = <span class=\"string\">&quot;Alert-Notify2.voice&quot;</span>,</span><br><span class=\"line\">    SubscriberCount = Settings.GetInt(<span class=\"string\">&quot;Alert_Notify2_voice_SubscriberCount&quot;</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/dead-message/delay_comsuption_1.png\" alt=\"1\"></p>\n<p><img src=\"/images/dead-message/delay_comsuption_2.png\" alt=\"\"></p>\n<ol start=\"3\">\n<li><figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> (RabbitClient client = <span class=\"keyword\">new</span> RabbitClient(RabbitSettings.Rabbit, <span class=\"string\">&quot;NotifyService.Rabbit.MQ&quot;</span>))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">//SendMessage(Alert-Notify2.voice)</span></span><br><span class=\"line\">    IBasicProperties properties = client.GetBasicProperties();</span><br><span class=\"line\">    properties.Expiration = (<span class=\"number\">60</span> * <span class=\"number\">1000</span> * Notify2RabbitInit.VoiceConfig.TimeOut).ToString();                </span><br><span class=\"line\">    client.SendMessage(package, <span class=\"literal\">null</span>, <span class=\"string\">&quot;Alert-Notify2.voice_wait&quot;</span>, properties);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<br><img src=\"/images/dead-message/dead-letter-3.png\" alt=\"\"></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>MQDead Letter Queue, DLQ</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Dead Letter QueueDLQ</p>\n<p><img src=\"/images/dead-message/dead-letter-exchange-1.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li></li>\n<li><figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> properties = channel.CreateBasicProperties();</span><br><span class=\"line\">properties.Expiration = <span class=\"string\">&quot;60000&quot;</span>; <span class=\"comment\">// 60</span></span><br><span class=\"line\"></span><br><span class=\"line\">channel.BasicPublish(</span><br><span class=\"line\">    exchange: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">    routingKey: <span class=\"string\">&quot;normal_queue&quot;</span>,</span><br><span class=\"line\">    basicProperties: properties,</span><br><span class=\"line\">    body: Encoding.UTF8.GetBytes(<span class=\"string\">&quot;Test Message&quot;</span>)</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure></li>\n<li><figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> consumer = <span class=\"keyword\">new</span> EventingBasicConsumer(channel);</span><br><span class=\"line\">consumer.Received += (model, ea) =&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    channel.BasicReject(deliveryTag: ea.DeliveryTag, requeue: <span class=\"literal\">false</span>);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">channel.BasicConsume(queue: <span class=\"string\">&quot;normal_queue&quot;</span>, autoAck: <span class=\"literal\">false</span>, consumer: consumer);</span><br></pre></td></tr></table></figure></li>\n<li></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><img src=\"/images/dead-message/dead-letter-exchange-1.png\" alt=\"\"></p>\n<h1 id=\"RabbitMQ\"><a href=\"#RabbitMQ\" class=\"headerlink\" title=\"RabbitMQ\"></a>RabbitMQ</h1><p></p>\n<p><br></p>\n<ol>\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">client.CreateQueueBind(<span class=\"string\">&quot;Alert-Notify2.voice&quot;</span>);</span><br><span class=\"line\">Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt; args = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt;</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    [<span class=\"string\">&quot;x-dead-letter-exchange&quot;</span>] = Exchanges.Direct,</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    [<span class=\"string\">&quot;x-dead-letter-routing-key&quot;</span>] = <span class=\"string\">&quot;Alert-Notify2.voice&quot;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">client.CreateQueueBind(<span class=\"string\">&quot;Alert-Notify2.voice_wait&quot;</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, args);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">RabbitSubscriber.StartAsync&lt;AlertNotifyPackage, NotifyVoiceMessageHandler&gt;(<span class=\"keyword\">new</span> RabbitSubscriberArgs</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    SettingName = RabbitSettings.Rabbit,</span><br><span class=\"line\">    QueueName = <span class=\"string\">&quot;Alert-Notify2.voice&quot;</span>,</span><br><span class=\"line\">    SubscriberCount = Settings.GetInt(<span class=\"string\">&quot;Alert_Notify2_voice_SubscriberCount&quot;</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/dead-message/delay_comsuption_1.png\" alt=\"1\"></p>\n<p><img src=\"/images/dead-message/delay_comsuption_2.png\" alt=\"\"></p>\n<ol start=\"3\">\n<li><figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> (RabbitClient client = <span class=\"keyword\">new</span> RabbitClient(RabbitSettings.Rabbit, <span class=\"string\">&quot;NotifyService.Rabbit.MQ&quot;</span>))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">//SendMessage(Alert-Notify2.voice)</span></span><br><span class=\"line\">    IBasicProperties properties = client.GetBasicProperties();</span><br><span class=\"line\">    properties.Expiration = (<span class=\"number\">60</span> * <span class=\"number\">1000</span> * Notify2RabbitInit.VoiceConfig.TimeOut).ToString();                </span><br><span class=\"line\">    client.SendMessage(package, <span class=\"literal\">null</span>, <span class=\"string\">&quot;Alert-Notify2.voice_wait&quot;</span>, properties);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<br><img src=\"/images/dead-message/dead-letter-3.png\" alt=\"\"></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n"},{"title":" ITProHub","_content":"![background](/images/hello-bg.png)\n#   ITProHub\n\n##   \n\n ITProHub\n\n###  ITPro: \n\nITITProHubIT\n\n###  Hub: \n\nITProHubITIT\n\n####  \n\n IT\n\n \n\n \n\n \n\n \n\n\n\n\n\n\n\nITITProHub\n\n\n##   ITProHub \n\n\n\n#ITProHub # # #\n\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","source":"_posts/hello-world.md","raw":"---\ntitle:  ITProHub\n---\n![background](/images/hello-bg.png)\n#   ITProHub\n\n##   \n\n ITProHub\n\n###  ITPro: \n\nITITProHubIT\n\n###  Hub: \n\nITProHubITIT\n\n####  \n\n IT\n\n \n\n \n\n \n\n \n\n\n\n\n\n\n\nITITProHub\n\n\n##   ITProHub \n\n\n\n#ITProHub # # #\n\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","slug":"hello-world","published":1,"date":"2024-03-13T07:54:13.172Z","updated":"2024-04-26T03:07:16.002Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fh90008u8p1361o5ppp","content":"<p><img src=\"/images/hello-bg.png\" alt=\"background\"></p>\n<h1 id=\"--ITProHub\"><a href=\"#--ITProHub\" class=\"headerlink\" title=\"  ITProHub\"></a>  ITProHub</h1><h2 id=\"--\"><a href=\"#--\" class=\"headerlink\" title=\"  \"></a>  </h2><p> ITProHub</p>\n<h3 id=\"-ITPro-\"><a href=\"#-ITPro-\" class=\"headerlink\" title=\" ITPro: \"></a> ITPro: </h3><p>ITITProHubIT</p>\n<h3 id=\"-Hub-\"><a href=\"#-Hub-\" class=\"headerlink\" title=\" Hub: \"></a> Hub: </h3><p>ITProHubITIT</p>\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h4><p> IT</p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p></p>\n<p></p>\n<p></p>\n<p>ITITProHub</p>\n<h2 id=\"--ITProHub-\"><a href=\"#--ITProHub-\" class=\"headerlink\" title=\"  ITProHub \"></a>  ITProHub </h2><p></p>\n<p>#ITProHub # # #</p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"/images/hello-bg.png\" alt=\"background\"></p>\n<h1 id=\"--ITProHub\"><a href=\"#--ITProHub\" class=\"headerlink\" title=\"  ITProHub\"></a>  ITProHub</h1><h2 id=\"--\"><a href=\"#--\" class=\"headerlink\" title=\"  \"></a>  </h2><p> ITProHub</p>\n<h3 id=\"-ITPro-\"><a href=\"#-ITPro-\" class=\"headerlink\" title=\" ITPro: \"></a> ITPro: </h3><p>ITITProHubIT</p>\n<h3 id=\"-Hub-\"><a href=\"#-Hub-\" class=\"headerlink\" title=\" Hub: \"></a> Hub: </h3><p>ITProHubITIT</p>\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h4><p> IT</p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p></p>\n<p></p>\n<p></p>\n<p>ITITProHub</p>\n<h2 id=\"--ITProHub-\"><a href=\"#--ITProHub-\" class=\"headerlink\" title=\"  ITProHub \"></a>  ITProHub </h2><p></p>\n<p>#ITProHub # # #</p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n"},{"title":"Garnet","date":"2024-04-07T07:24:24.000Z","_content":"\n\n1. redis\n2. Garnet\n\n#  Garnet\nGarnet\n\n# \n1. \n\n   &nbsp; Garnet\n  Garnet\n\n2. \n\n   &nbsp; Garnet\n\n3. \n\n   &nbsp; Garnet\n\n4. \n\n   &nbsp; Garnet\n\n5. \n\n   &nbsp; Garnet\n\n# \n\n\n [Evaluating Garnet's Performance Benefits](https://microsoft.github.io/garnet/docs/benchmarking/results-resp-bench)\n\n\n\ngarnetredis\n```C#\n[HttpGet]\n[ActionTitle(Name = \"Garnet\")]\n[Route(\"test.svc\")]\npublic void Start()\n{\n    // Redis connection\n    var redis = ConnectionMultiplexer.Connect(\"localhost\");\n    var redisDb = redis.GetDatabase();\n\n    // Garnet connection\n    var garnet = new GarnetClient(\"localhost\", 3278);\n\n    // Test data\n    string key = \"test_key\";\n    string value = \"test_value\";\n\n    // Test with Redis\n   var redisStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       redisDb.StringSet(key + i, value + i);\n   }\n   var redisEndTime = DateTime.Now;\n   Console.WriteLine($\"StringSet Time taken by Redis: {(redisEndTime - redisStartTime).TotalMilliseconds} ms\");\n   \n   // Test with Garnet\n   var garnetStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       garnet.StringSet(key + i, value + i, null);\n   }\n   var garnetEndTime = DateTime.Now;\n   Console.WriteLine($\"StringSet Time taken by Garnet: {(garnetEndTime - garnetStartTime).TotalMilliseconds} ms\");\n   \n   // Test with Redis\n   redisStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       string a = redisDb.StringGet(key + i).ToString();\n   }\n   redisEndTime = DateTime.Now;\n   Console.WriteLine($\"StringGet Time taken by Redis: {(redisEndTime - redisStartTime).TotalMilliseconds} ms\");\n   \n   // Test with Garnet\n   garnetStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       garnet.StringGet(key + i, null);\n   }\n   garnetEndTime = DateTime.Now;\n   Console.WriteLine($\"StringGet Time taken by Garnet: {(garnetEndTime - garnetStartTime).TotalMilliseconds} ms\");\n}\n```\n!\n\n![1](/images/garnet/compare1.png)\n\n# \n\n\n\n> Garnet  Redis 100%  Garnet  Redis  Garnet StackExchange.Redis\n\ndemo\n```C#\n[HttpGet]\n[ActionTitle(Name = \"Garnet\")]\n[Route(\"connect.svc\")]\npublic void Connect()\n{\n    // Redis connection\n    var redis = ConnectionMultiplexer.Connect(\"localhost\");\n    var redisDb = redis.GetDatabase();\n\n    // Garnet connection\n    var garnet = ConnectionMultiplexer.Connect(\"localhost:3278\");\n    var garnetDb = garnet.GetDatabase();\n\n    // Test data\n    string key = \"test_key\";\n\n    // Test with Redis\n    string a = redisDb.StringGet(key + 1).ToString();\n    Console.WriteLine($\"StringGet by Redis : {a}\");\n\n    // Test with Garnet\n    string b = garnetDb.StringGet(key + 1).ToString();\n    Console.WriteLine($\"StringGet by Garnet : {b}\");\n}\n```\n \n\nGarnet\n![connect](/images/garnet/connect.png)\n\nredisGarnet\n![client](/images/garnet/client.png)\n\n\n# \nGarnet  Garnet \n\n1. Garnet \n\n2. Garnet \n\n3. Garnet \n\n4. Garnet \n\n```C#\nstatic void Main(string[] args)\n{\n    try\n    {\n\n        var loggerFactory = LoggerFactory.Create(x =>\n        {\n            x.ClearProviders();\n            x.SetMinimumLevel(LogLevel.Trace);\n            x.AddZLoggerConsole(options =>\n            {\n                options.UsePlainTextFormatter(formatter =>\n                {\n                    formatter.SetPrefixFormatter($\"[{0}]\", (in MessageTemplate template, in LogInfo info) => template.Format(info.Category));\n                });\n            });\n        });\n\n\n        using var server = new GarnetServer(args, loggerFactory);\n\n        // Optional: register custom extensions\n        RegisterExtensions(server);\n\n        // Start the server\n        server.Start();\n\n        Thread.Sleep(Timeout.Infinite);\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"Unable to initialize server due to exception: {ex.Message}\");\n    }\n}\n```\n![](/images/garnet/log.png)\n\n\n\n# \n Redis  Redis  Lua  Garnet C#   LUA  LUA   RESP PHP  Go  C#\n\nTESTHello Garnet!\n\n\n\n```Garnet Server\n// \nserver.Register.NewTransactionProc(\"TEST\", 0, () => new TestCustomCommand());\n\n\nsealed class TestCustomCommand : CustomTransactionProcedure\n{\n    /// <summary>\n    /// No transactional phase, skip Prepare\n    /// </summary>\n    public override bool Prepare<TGarnetReadApi>(TGarnetReadApi api, ArgSlice input)\n        => false;\n\n    /// <summary>\n    /// Main will not be called because Prepare returns false\n    /// </summary>\n    public override void Main<TGarnetApi>(TGarnetApi api, ArgSlice input, ref MemoryResult<byte> output)\n        => throw new InvalidOperationException();\n\n    /// <summary>\n    /// Finalize reads two keys (non-transactionally) and return their values as an array of bulk strings\n    /// </summary>\n    public override void Finalize<TGarnetApi>(TGarnetApi api, ArgSlice input, ref MemoryResult<byte> output)\n    {\n        // Return the two keys as an array of bulk strings\n        WriteSimpleString(ref output, \"Hello Garnet!\");\n    }\n}\n\n```\n\nGarnet RESP C# Garnet  redisGarnet\n```Garnet client\n [HttpGet]\n [ActionTitle(Name = \"Garnet \")]\n [Route(\"custom-command.svc\")]\n public async void Test()\n {       \n     // Garnet connection\n     var garnet = new GarnetClient(\"localhost\", 3278);\n     garnet.Connect();\n     // Test data\n     string result = await garnet.ExecuteForStringResultAsync(\"TEST\");\n\n     Console.WriteLine($\"Garnet Custom Command Result: {result}\");\n\n     // redis\n     var client = ConnectionMultiplexer.Connect(\"localhost:3278\");\n     var db = client.GetDatabase();\n\n     RedisResult redisResult = db.Execute(\"TEST\");\n\n     Console.WriteLine($\"Redis Client Custom Command Result: {((string?)redisResult)}\");\n }\n```\n\n![custom command result](/images/garnet/custom-command.png)\n\n# \nGarnetGarnet\n\n# \n+ [Garnet ](https://microsoft.github.io/garnet/docs)\n\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","source":"_posts/garnet.md","raw":"---\ntitle: Garnet\ndate: 2024-04-07 15:24:24\ntags: Garnet  \n---\n\n\n1. redis\n2. Garnet\n\n#  Garnet\nGarnet\n\n# \n1. \n\n   &nbsp; Garnet\n  Garnet\n\n2. \n\n   &nbsp; Garnet\n\n3. \n\n   &nbsp; Garnet\n\n4. \n\n   &nbsp; Garnet\n\n5. \n\n   &nbsp; Garnet\n\n# \n\n\n [Evaluating Garnet's Performance Benefits](https://microsoft.github.io/garnet/docs/benchmarking/results-resp-bench)\n\n\n\ngarnetredis\n```C#\n[HttpGet]\n[ActionTitle(Name = \"Garnet\")]\n[Route(\"test.svc\")]\npublic void Start()\n{\n    // Redis connection\n    var redis = ConnectionMultiplexer.Connect(\"localhost\");\n    var redisDb = redis.GetDatabase();\n\n    // Garnet connection\n    var garnet = new GarnetClient(\"localhost\", 3278);\n\n    // Test data\n    string key = \"test_key\";\n    string value = \"test_value\";\n\n    // Test with Redis\n   var redisStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       redisDb.StringSet(key + i, value + i);\n   }\n   var redisEndTime = DateTime.Now;\n   Console.WriteLine($\"StringSet Time taken by Redis: {(redisEndTime - redisStartTime).TotalMilliseconds} ms\");\n   \n   // Test with Garnet\n   var garnetStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       garnet.StringSet(key + i, value + i, null);\n   }\n   var garnetEndTime = DateTime.Now;\n   Console.WriteLine($\"StringSet Time taken by Garnet: {(garnetEndTime - garnetStartTime).TotalMilliseconds} ms\");\n   \n   // Test with Redis\n   redisStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       string a = redisDb.StringGet(key + i).ToString();\n   }\n   redisEndTime = DateTime.Now;\n   Console.WriteLine($\"StringGet Time taken by Redis: {(redisEndTime - redisStartTime).TotalMilliseconds} ms\");\n   \n   // Test with Garnet\n   garnetStartTime = DateTime.Now;\n   for( int i = 0; i < 1000; i++ ) {\n       garnet.StringGet(key + i, null);\n   }\n   garnetEndTime = DateTime.Now;\n   Console.WriteLine($\"StringGet Time taken by Garnet: {(garnetEndTime - garnetStartTime).TotalMilliseconds} ms\");\n}\n```\n!\n\n![1](/images/garnet/compare1.png)\n\n# \n\n\n\n> Garnet  Redis 100%  Garnet  Redis  Garnet StackExchange.Redis\n\ndemo\n```C#\n[HttpGet]\n[ActionTitle(Name = \"Garnet\")]\n[Route(\"connect.svc\")]\npublic void Connect()\n{\n    // Redis connection\n    var redis = ConnectionMultiplexer.Connect(\"localhost\");\n    var redisDb = redis.GetDatabase();\n\n    // Garnet connection\n    var garnet = ConnectionMultiplexer.Connect(\"localhost:3278\");\n    var garnetDb = garnet.GetDatabase();\n\n    // Test data\n    string key = \"test_key\";\n\n    // Test with Redis\n    string a = redisDb.StringGet(key + 1).ToString();\n    Console.WriteLine($\"StringGet by Redis : {a}\");\n\n    // Test with Garnet\n    string b = garnetDb.StringGet(key + 1).ToString();\n    Console.WriteLine($\"StringGet by Garnet : {b}\");\n}\n```\n \n\nGarnet\n![connect](/images/garnet/connect.png)\n\nredisGarnet\n![client](/images/garnet/client.png)\n\n\n# \nGarnet  Garnet \n\n1. Garnet \n\n2. Garnet \n\n3. Garnet \n\n4. Garnet \n\n```C#\nstatic void Main(string[] args)\n{\n    try\n    {\n\n        var loggerFactory = LoggerFactory.Create(x =>\n        {\n            x.ClearProviders();\n            x.SetMinimumLevel(LogLevel.Trace);\n            x.AddZLoggerConsole(options =>\n            {\n                options.UsePlainTextFormatter(formatter =>\n                {\n                    formatter.SetPrefixFormatter($\"[{0}]\", (in MessageTemplate template, in LogInfo info) => template.Format(info.Category));\n                });\n            });\n        });\n\n\n        using var server = new GarnetServer(args, loggerFactory);\n\n        // Optional: register custom extensions\n        RegisterExtensions(server);\n\n        // Start the server\n        server.Start();\n\n        Thread.Sleep(Timeout.Infinite);\n    }\n    catch (Exception ex)\n    {\n        Console.WriteLine($\"Unable to initialize server due to exception: {ex.Message}\");\n    }\n}\n```\n![](/images/garnet/log.png)\n\n\n\n# \n Redis  Redis  Lua  Garnet C#   LUA  LUA   RESP PHP  Go  C#\n\nTESTHello Garnet!\n\n\n\n```Garnet Server\n// \nserver.Register.NewTransactionProc(\"TEST\", 0, () => new TestCustomCommand());\n\n\nsealed class TestCustomCommand : CustomTransactionProcedure\n{\n    /// <summary>\n    /// No transactional phase, skip Prepare\n    /// </summary>\n    public override bool Prepare<TGarnetReadApi>(TGarnetReadApi api, ArgSlice input)\n        => false;\n\n    /// <summary>\n    /// Main will not be called because Prepare returns false\n    /// </summary>\n    public override void Main<TGarnetApi>(TGarnetApi api, ArgSlice input, ref MemoryResult<byte> output)\n        => throw new InvalidOperationException();\n\n    /// <summary>\n    /// Finalize reads two keys (non-transactionally) and return their values as an array of bulk strings\n    /// </summary>\n    public override void Finalize<TGarnetApi>(TGarnetApi api, ArgSlice input, ref MemoryResult<byte> output)\n    {\n        // Return the two keys as an array of bulk strings\n        WriteSimpleString(ref output, \"Hello Garnet!\");\n    }\n}\n\n```\n\nGarnet RESP C# Garnet  redisGarnet\n```Garnet client\n [HttpGet]\n [ActionTitle(Name = \"Garnet \")]\n [Route(\"custom-command.svc\")]\n public async void Test()\n {       \n     // Garnet connection\n     var garnet = new GarnetClient(\"localhost\", 3278);\n     garnet.Connect();\n     // Test data\n     string result = await garnet.ExecuteForStringResultAsync(\"TEST\");\n\n     Console.WriteLine($\"Garnet Custom Command Result: {result}\");\n\n     // redis\n     var client = ConnectionMultiplexer.Connect(\"localhost:3278\");\n     var db = client.GetDatabase();\n\n     RedisResult redisResult = db.Execute(\"TEST\");\n\n     Console.WriteLine($\"Redis Client Custom Command Result: {((string?)redisResult)}\");\n }\n```\n\n![custom command result](/images/garnet/custom-command.png)\n\n# \nGarnetGarnet\n\n# \n+ [Garnet ](https://microsoft.github.io/garnet/docs)\n\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","slug":"garnet","published":1,"updated":"2024-04-26T03:07:22.478Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fha0009u8p1bpeu9l1y","content":"<p></p>\n<ol>\n<li>redis</li>\n<li>Garnet</li>\n</ol>\n<h1 id=\"Garnet\"><a href=\"#Garnet\" class=\"headerlink\" title=\"Garnet\"></a>Garnet</h1><p>Garnet</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n</ol>\n<p>  Garnet</p>\n<ol start=\"2\">\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p> <a href=\"https://microsoft.github.io/garnet/docs/benchmarking/results-resp-bench\">Evaluating Garnets Performance Benefits</a></p>\n<p></p>\n<p>garnetredis</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;Garnet&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;test.svc&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Start</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Redis connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> redis = ConnectionMultiplexer.Connect(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> redisDb = redis.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Garnet connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> garnet = <span class=\"keyword\">new</span> GarnetClient(<span class=\"string\">&quot;localhost&quot;</span>, <span class=\"number\">3278</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test data</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> key = <span class=\"string\">&quot;test_key&quot;</span>;</span><br><span class=\"line\">    <span class=\"built_in\">string</span> <span class=\"keyword\">value</span> = <span class=\"string\">&quot;test_value&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test with Redis</span></span><br><span class=\"line\">   <span class=\"keyword\">var</span> redisStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       redisDb.StringSet(key + i, <span class=\"keyword\">value</span> + i);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">var</span> redisEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringSet Time taken by Redis: <span class=\"subst\">&#123;(redisEndTime - redisStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"comment\">// Test with Garnet</span></span><br><span class=\"line\">   <span class=\"keyword\">var</span> garnetStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       garnet.StringSet(key + i, <span class=\"keyword\">value</span> + i, <span class=\"literal\">null</span>);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">var</span> garnetEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringSet Time taken by Garnet: <span class=\"subst\">&#123;(garnetEndTime - garnetStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"comment\">// Test with Redis</span></span><br><span class=\"line\">   redisStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       <span class=\"built_in\">string</span> a = redisDb.StringGet(key + i).ToString();</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   redisEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringGet Time taken by Redis: <span class=\"subst\">&#123;(redisEndTime - redisStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"comment\">// Test with Garnet</span></span><br><span class=\"line\">   garnetStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       garnet.StringGet(key + i, <span class=\"literal\">null</span>);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   garnetEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringGet Time taken by Garnet: <span class=\"subst\">&#123;(garnetEndTime - garnetStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>!</p>\n<p><img src=\"/images/garnet/compare1.png\" alt=\"1\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<blockquote>\n<p>Garnet  Redis 100%  Garnet  Redis  Garnet StackExchange.Redis</p>\n</blockquote>\n<p>demo</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;Garnet&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;connect.svc&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Connect</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Redis connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> redis = ConnectionMultiplexer.Connect(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> redisDb = redis.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Garnet connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> garnet = ConnectionMultiplexer.Connect(<span class=\"string\">&quot;localhost:3278&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> garnetDb = garnet.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test data</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> key = <span class=\"string\">&quot;test_key&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test with Redis</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> a = redisDb.StringGet(key + <span class=\"number\">1</span>).ToString();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">$&quot;StringGet by Redis : <span class=\"subst\">&#123;a&#125;</span>&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test with Garnet</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> b = garnetDb.StringGet(key + <span class=\"number\">1</span>).ToString();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">$&quot;StringGet by Garnet : <span class=\"subst\">&#123;b&#125;</span>&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> </p>\n<p>Garnet<br><img src=\"/images/garnet/connect.png\" alt=\"connect\"></p>\n<p>redisGarnet<br><img src=\"/images/garnet/client.png\" alt=\"client\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Garnet  Garnet </p>\n<ol>\n<li><p>Garnet </p>\n</li>\n<li><p>Garnet </p>\n</li>\n<li><p>Garnet </p>\n</li>\n<li><p>Garnet </p>\n</li>\n</ol>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> loggerFactory = LoggerFactory.Create(x =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x.ClearProviders();</span><br><span class=\"line\">            x.SetMinimumLevel(LogLevel.Trace);</span><br><span class=\"line\">            x.AddZLoggerConsole(options =&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                options.UsePlainTextFormatter(formatter =&gt;</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    formatter.SetPrefixFormatter(<span class=\"string\">$&quot;[<span class=\"subst\">&#123;<span class=\"number\">0</span>&#125;</span>]&quot;</span>, (<span class=\"keyword\">in</span> MessageTemplate template, <span class=\"keyword\">in</span> LogInfo info) =&gt; template.Format(info.Category));</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">using</span> <span class=\"keyword\">var</span> server = <span class=\"keyword\">new</span> GarnetServer(args, loggerFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Optional: register custom extensions</span></span><br><span class=\"line\">        RegisterExtensions(server);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Start the server</span></span><br><span class=\"line\">        server.Start();</span><br><span class=\"line\"></span><br><span class=\"line\">        Thread.Sleep(Timeout.Infinite);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">$&quot;Unable to initialize server due to exception: <span class=\"subst\">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/garnet/log.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Redis  Redis  Lua  Garnet C#   LUA  LUA   RESP PHP  Go  C#</p>\n<p>TESTHello Garnet!</p>\n<p></p>\n<figure class=\"highlight plaintext\"><figcaption><span>Server</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// </span><br><span class=\"line\">server.Register.NewTransactionProc(&quot;TEST&quot;, 0, () =&gt; new TestCustomCommand());</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">sealed class TestCustomCommand : CustomTransactionProcedure</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    /// &lt;summary&gt;</span><br><span class=\"line\">    /// No transactional phase, skip Prepare</span><br><span class=\"line\">    /// &lt;/summary&gt;</span><br><span class=\"line\">    public override bool Prepare&lt;TGarnetReadApi&gt;(TGarnetReadApi api, ArgSlice input)</span><br><span class=\"line\">        =&gt; false;</span><br><span class=\"line\"></span><br><span class=\"line\">    /// &lt;summary&gt;</span><br><span class=\"line\">    /// Main will not be called because Prepare returns false</span><br><span class=\"line\">    /// &lt;/summary&gt;</span><br><span class=\"line\">    public override void Main&lt;TGarnetApi&gt;(TGarnetApi api, ArgSlice input, ref MemoryResult&lt;byte&gt; output)</span><br><span class=\"line\">        =&gt; throw new InvalidOperationException();</span><br><span class=\"line\"></span><br><span class=\"line\">    /// &lt;summary&gt;</span><br><span class=\"line\">    /// Finalize reads two keys (non-transactionally) and return their values as an array of bulk strings</span><br><span class=\"line\">    /// &lt;/summary&gt;</span><br><span class=\"line\">    public override void Finalize&lt;TGarnetApi&gt;(TGarnetApi api, ArgSlice input, ref MemoryResult&lt;byte&gt; output)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        // Return the two keys as an array of bulk strings</span><br><span class=\"line\">        WriteSimpleString(ref output, &quot;Hello Garnet!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Garnet RESP C# Garnet  redisGarnet</p>\n<figure class=\"highlight plaintext\"><figcaption><span>client</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[HttpGet]</span><br><span class=\"line\">[ActionTitle(Name = &quot;Garnet &quot;)]</span><br><span class=\"line\">[Route(&quot;custom-command.svc&quot;)]</span><br><span class=\"line\">public async void Test()</span><br><span class=\"line\">&#123;       </span><br><span class=\"line\">    // Garnet connection</span><br><span class=\"line\">    var garnet = new GarnetClient(&quot;localhost&quot;, 3278);</span><br><span class=\"line\">    garnet.Connect();</span><br><span class=\"line\">    // Test data</span><br><span class=\"line\">    string result = await garnet.ExecuteForStringResultAsync(&quot;TEST&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.WriteLine($&quot;Garnet Custom Command Result: &#123;result&#125;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    // redis</span><br><span class=\"line\">    var client = ConnectionMultiplexer.Connect(&quot;localhost:3278&quot;);</span><br><span class=\"line\">    var db = client.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    RedisResult redisResult = db.Execute(&quot;TEST&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.WriteLine($&quot;Redis Client Custom Command Result: &#123;((string?)redisResult)&#125;&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/garnet/custom-command.png\" alt=\"custom command result\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>GarnetGarnet</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://microsoft.github.io/garnet/docs\">Garnet </a></li>\n</ul>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p></p>\n<ol>\n<li>redis</li>\n<li>Garnet</li>\n</ol>\n<h1 id=\"Garnet\"><a href=\"#Garnet\" class=\"headerlink\" title=\"Garnet\"></a>Garnet</h1><p>Garnet</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n</ol>\n<p>  Garnet</p>\n<ol start=\"2\">\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n<li><p></p>\n<p>&nbsp; Garnet</p>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p> <a href=\"https://microsoft.github.io/garnet/docs/benchmarking/results-resp-bench\">Evaluating Garnets Performance Benefits</a></p>\n<p></p>\n<p>garnetredis</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;Garnet&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;test.svc&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Start</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Redis connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> redis = ConnectionMultiplexer.Connect(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> redisDb = redis.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Garnet connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> garnet = <span class=\"keyword\">new</span> GarnetClient(<span class=\"string\">&quot;localhost&quot;</span>, <span class=\"number\">3278</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test data</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> key = <span class=\"string\">&quot;test_key&quot;</span>;</span><br><span class=\"line\">    <span class=\"built_in\">string</span> <span class=\"keyword\">value</span> = <span class=\"string\">&quot;test_value&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test with Redis</span></span><br><span class=\"line\">   <span class=\"keyword\">var</span> redisStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       redisDb.StringSet(key + i, <span class=\"keyword\">value</span> + i);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">var</span> redisEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringSet Time taken by Redis: <span class=\"subst\">&#123;(redisEndTime - redisStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"comment\">// Test with Garnet</span></span><br><span class=\"line\">   <span class=\"keyword\">var</span> garnetStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       garnet.StringSet(key + i, <span class=\"keyword\">value</span> + i, <span class=\"literal\">null</span>);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   <span class=\"keyword\">var</span> garnetEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringSet Time taken by Garnet: <span class=\"subst\">&#123;(garnetEndTime - garnetStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"comment\">// Test with Redis</span></span><br><span class=\"line\">   redisStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       <span class=\"built_in\">string</span> a = redisDb.StringGet(key + i).ToString();</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   redisEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringGet Time taken by Redis: <span class=\"subst\">&#123;(redisEndTime - redisStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">   </span><br><span class=\"line\">   <span class=\"comment\">// Test with Garnet</span></span><br><span class=\"line\">   garnetStartTime = DateTime.Now;</span><br><span class=\"line\">   <span class=\"keyword\">for</span>( <span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++ ) &#123;</span><br><span class=\"line\">       garnet.StringGet(key + i, <span class=\"literal\">null</span>);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   garnetEndTime = DateTime.Now;</span><br><span class=\"line\">   Console.WriteLine(<span class=\"string\">$&quot;StringGet Time taken by Garnet: <span class=\"subst\">&#123;(garnetEndTime - garnetStartTime).TotalMilliseconds&#125;</span> ms&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>!</p>\n<p><img src=\"/images/garnet/compare1.png\" alt=\"1\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<blockquote>\n<p>Garnet  Redis 100%  Garnet  Redis  Garnet StackExchange.Redis</p>\n</blockquote>\n<p>demo</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;Garnet&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;connect.svc&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Connect</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Redis connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> redis = ConnectionMultiplexer.Connect(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> redisDb = redis.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Garnet connection</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> garnet = ConnectionMultiplexer.Connect(<span class=\"string\">&quot;localhost:3278&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> garnetDb = garnet.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test data</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> key = <span class=\"string\">&quot;test_key&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test with Redis</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> a = redisDb.StringGet(key + <span class=\"number\">1</span>).ToString();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">$&quot;StringGet by Redis : <span class=\"subst\">&#123;a&#125;</span>&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Test with Garnet</span></span><br><span class=\"line\">    <span class=\"built_in\">string</span> b = garnetDb.StringGet(key + <span class=\"number\">1</span>).ToString();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">$&quot;StringGet by Garnet : <span class=\"subst\">&#123;b&#125;</span>&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> </p>\n<p>Garnet<br><img src=\"/images/garnet/connect.png\" alt=\"connect\"></p>\n<p>redisGarnet<br><img src=\"/images/garnet/client.png\" alt=\"client\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Garnet  Garnet </p>\n<ol>\n<li><p>Garnet </p>\n</li>\n<li><p>Garnet </p>\n</li>\n<li><p>Garnet </p>\n</li>\n<li><p>Garnet </p>\n</li>\n</ol>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">var</span> loggerFactory = LoggerFactory.Create(x =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            x.ClearProviders();</span><br><span class=\"line\">            x.SetMinimumLevel(LogLevel.Trace);</span><br><span class=\"line\">            x.AddZLoggerConsole(options =&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                options.UsePlainTextFormatter(formatter =&gt;</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    formatter.SetPrefixFormatter(<span class=\"string\">$&quot;[<span class=\"subst\">&#123;<span class=\"number\">0</span>&#125;</span>]&quot;</span>, (<span class=\"keyword\">in</span> MessageTemplate template, <span class=\"keyword\">in</span> LogInfo info) =&gt; template.Format(info.Category));</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">using</span> <span class=\"keyword\">var</span> server = <span class=\"keyword\">new</span> GarnetServer(args, loggerFactory);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Optional: register custom extensions</span></span><br><span class=\"line\">        RegisterExtensions(server);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Start the server</span></span><br><span class=\"line\">        server.Start();</span><br><span class=\"line\"></span><br><span class=\"line\">        Thread.Sleep(Timeout.Infinite);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">$&quot;Unable to initialize server due to exception: <span class=\"subst\">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/garnet/log.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Redis  Redis  Lua  Garnet C#   LUA  LUA   RESP PHP  Go  C#</p>\n<p>TESTHello Garnet!</p>\n<p></p>\n<figure class=\"highlight plaintext\"><figcaption><span>Server</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// </span><br><span class=\"line\">server.Register.NewTransactionProc(&quot;TEST&quot;, 0, () =&gt; new TestCustomCommand());</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">sealed class TestCustomCommand : CustomTransactionProcedure</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    /// &lt;summary&gt;</span><br><span class=\"line\">    /// No transactional phase, skip Prepare</span><br><span class=\"line\">    /// &lt;/summary&gt;</span><br><span class=\"line\">    public override bool Prepare&lt;TGarnetReadApi&gt;(TGarnetReadApi api, ArgSlice input)</span><br><span class=\"line\">        =&gt; false;</span><br><span class=\"line\"></span><br><span class=\"line\">    /// &lt;summary&gt;</span><br><span class=\"line\">    /// Main will not be called because Prepare returns false</span><br><span class=\"line\">    /// &lt;/summary&gt;</span><br><span class=\"line\">    public override void Main&lt;TGarnetApi&gt;(TGarnetApi api, ArgSlice input, ref MemoryResult&lt;byte&gt; output)</span><br><span class=\"line\">        =&gt; throw new InvalidOperationException();</span><br><span class=\"line\"></span><br><span class=\"line\">    /// &lt;summary&gt;</span><br><span class=\"line\">    /// Finalize reads two keys (non-transactionally) and return their values as an array of bulk strings</span><br><span class=\"line\">    /// &lt;/summary&gt;</span><br><span class=\"line\">    public override void Finalize&lt;TGarnetApi&gt;(TGarnetApi api, ArgSlice input, ref MemoryResult&lt;byte&gt; output)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        // Return the two keys as an array of bulk strings</span><br><span class=\"line\">        WriteSimpleString(ref output, &quot;Hello Garnet!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Garnet RESP C# Garnet  redisGarnet</p>\n<figure class=\"highlight plaintext\"><figcaption><span>client</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[HttpGet]</span><br><span class=\"line\">[ActionTitle(Name = &quot;Garnet &quot;)]</span><br><span class=\"line\">[Route(&quot;custom-command.svc&quot;)]</span><br><span class=\"line\">public async void Test()</span><br><span class=\"line\">&#123;       </span><br><span class=\"line\">    // Garnet connection</span><br><span class=\"line\">    var garnet = new GarnetClient(&quot;localhost&quot;, 3278);</span><br><span class=\"line\">    garnet.Connect();</span><br><span class=\"line\">    // Test data</span><br><span class=\"line\">    string result = await garnet.ExecuteForStringResultAsync(&quot;TEST&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.WriteLine($&quot;Garnet Custom Command Result: &#123;result&#125;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    // redis</span><br><span class=\"line\">    var client = ConnectionMultiplexer.Connect(&quot;localhost:3278&quot;);</span><br><span class=\"line\">    var db = client.GetDatabase();</span><br><span class=\"line\"></span><br><span class=\"line\">    RedisResult redisResult = db.Execute(&quot;TEST&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.WriteLine($&quot;Redis Client Custom Command Result: &#123;((string?)redisResult)&#125;&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/garnet/custom-command.png\" alt=\"custom command result\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>GarnetGarnet</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"https://microsoft.github.io/garnet/docs\">Garnet </a></li>\n</ul>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n"},{"title":"HTTPS","date":"2024-04-11T07:36:46.000Z","_content":"\n#  HTTPS\nHTTP Web  HTTPS HTTP\nHTTP \n\nHTTP HTTP \n\n![](/images/https/security.png)\n\nHTTPS \n\n+ HTTPS \n+ \n+ HTTPS  SHA-256\n\n\n# \n SSL \n\n\nDigiCertGeoTrustGlobalSignCFCATrustAsia\n\n![ca](/images/https/ca2.png)\n\n# SSL \nSSL  Web  SSL  TLS\n\n![](/images/https/handshake.png)https://code-maze.com/wp-content/uploads/2017/07/TLS-handshake.png\n\n\n\n1. SSL XTLS X\n2. \n3. \n4. \n5. \n\n\n\n\nhttpswireshark\n![](/images/https/client-hello.png)\n\n![](/images/https/encrypted.png)\n\n\n\n\n# \nHTTPS \nHTTPS  HTTP  SSL  TLS \nPOODLESSL V2 SSL V3 \nTLS v1.0v1.1v1.2\n\nSSLTLS\n\n 128  RC4 \n\n Web  HTTPS \n\n## client hello\nwireshar\n![](/images/https/cipher-suites.png)\n\n## server hello\n, \n![](/images/https/negotiated-cipher-suite.png)\n\n## \nECDHE\nECDSA\nAES_128_CBC\nSHAMAC \n\n\n#  Web  HTTPS\n Web  HTTPS \n\n\n\n+  SSL \n+  Web \n+ \n\n\n\n+ IP-/\n+ TLS/SSL\n+ \n\n```nginx\nserver {\n    listen 443 ssl;\n    server_name xxx;\n\n    ssl_certificate /cert/xxx.crt;\n    ssl_certificate_key /cert/xxx.key;\n\n    location / {\n        proxy_pass http://localhost:4000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n```\n\n Web  SSL \nApache  https://wiki.apache.org/httpd/SSL\nIIS http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis\nNginx http://nginx.org/en/docs/http/configuring_https_servers.html\n\nMozilla  HTTPS \n\n[Mozilla SSL ](https://mozilla.github.io/server-side-tls/ssl-config-generator/)\n\n\n#  HTTPS \nHTTPS \nbugopenSSL([Heartbleed](https://baike.baidu.com/item/Heartbleed/13580882)),  HTTPS \n\n\n\n\n\n\n![](/images/https/expire.png)\n\n\n# HTTPS \n HTTPS \n\n## HTTPS \n1. \n\n DNS DNS  HTTPS  TipTopSecurity.comDNSSEC\n\n2. \n\nHTTPS \n\n3. \n\nHTTPS  IP  IP \n\n4. \n\nHTTPS  HTTPS  Web  HTTPS  HTTPS\n\n5. \n\nHTTPS  Web  HTTPS \n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","source":"_posts/https.md","raw":"---\ntitle: HTTPS\ndate: 2024-04-11 15:36:46\ntags: https http ssl tls\n---\n\n#  HTTPS\nHTTP Web  HTTPS HTTP\nHTTP \n\nHTTP HTTP \n\n![](/images/https/security.png)\n\nHTTPS \n\n+ HTTPS \n+ \n+ HTTPS  SHA-256\n\n\n# \n SSL \n\n\nDigiCertGeoTrustGlobalSignCFCATrustAsia\n\n![ca](/images/https/ca2.png)\n\n# SSL \nSSL  Web  SSL  TLS\n\n![](/images/https/handshake.png)https://code-maze.com/wp-content/uploads/2017/07/TLS-handshake.png\n\n\n\n1. SSL XTLS X\n2. \n3. \n4. \n5. \n\n\n\n\nhttpswireshark\n![](/images/https/client-hello.png)\n\n![](/images/https/encrypted.png)\n\n\n\n\n# \nHTTPS \nHTTPS  HTTP  SSL  TLS \nPOODLESSL V2 SSL V3 \nTLS v1.0v1.1v1.2\n\nSSLTLS\n\n 128  RC4 \n\n Web  HTTPS \n\n## client hello\nwireshar\n![](/images/https/cipher-suites.png)\n\n## server hello\n, \n![](/images/https/negotiated-cipher-suite.png)\n\n## \nECDHE\nECDSA\nAES_128_CBC\nSHAMAC \n\n\n#  Web  HTTPS\n Web  HTTPS \n\n\n\n+  SSL \n+  Web \n+ \n\n\n\n+ IP-/\n+ TLS/SSL\n+ \n\n```nginx\nserver {\n    listen 443 ssl;\n    server_name xxx;\n\n    ssl_certificate /cert/xxx.crt;\n    ssl_certificate_key /cert/xxx.key;\n\n    location / {\n        proxy_pass http://localhost:4000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n```\n\n Web  SSL \nApache  https://wiki.apache.org/httpd/SSL\nIIS http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis\nNginx http://nginx.org/en/docs/http/configuring_https_servers.html\n\nMozilla  HTTPS \n\n[Mozilla SSL ](https://mozilla.github.io/server-side-tls/ssl-config-generator/)\n\n\n#  HTTPS \nHTTPS \nbugopenSSL([Heartbleed](https://baike.baidu.com/item/Heartbleed/13580882)),  HTTPS \n\n\n\n\n\n\n![](/images/https/expire.png)\n\n\n# HTTPS \n HTTPS \n\n## HTTPS \n1. \n\n DNS DNS  HTTPS  TipTopSecurity.comDNSSEC\n\n2. \n\nHTTPS \n\n3. \n\nHTTPS  IP  IP \n\n4. \n\nHTTPS  HTTPS  Web  HTTPS  HTTPS\n\n5. \n\nHTTPS  Web  HTTPS \n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","slug":"https","published":1,"updated":"2024-04-26T03:06:40.272Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fha000au8p16lf23fe1","content":"<h1 id=\"-HTTPS\"><a href=\"#-HTTPS\" class=\"headerlink\" title=\" HTTPS\"></a> HTTPS</h1><p>HTTP Web  HTTPS HTTP<br>HTTP </p>\n<p>HTTP HTTP </p>\n<p><img src=\"/images/https/security.png\" alt=\"\"></p>\n<p>HTTPS </p>\n<ul>\n<li>HTTPS </li>\n<li></li>\n<li>HTTPS  SHA-256</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> SSL <br></p>\n<p>DigiCertGeoTrustGlobalSignCFCATrustAsia</p>\n<p><img src=\"/images/https/ca2.png\" alt=\"ca\"></p>\n<h1 id=\"SSL-\"><a href=\"#SSL-\" class=\"headerlink\" title=\"SSL \"></a>SSL </h1><p>SSL  Web  SSL  TLS</p>\n<p><img src=\"/images/https/handshake.png\" alt=\"\"><a href=\"https://code-maze.com/wp-content/uploads/2017/07/TLS-handshake.png\">https://code-maze.com/wp-content/uploads/2017/07/TLS-handshake.png</a></p>\n<p></p>\n<ol>\n<li>SSL XTLS X</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>httpswireshark<br><img src=\"/images/https/client-hello.png\" alt=\"\"><br><br><img src=\"/images/https/encrypted.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>HTTPS <br>HTTPS  HTTP  SSL  TLS <br>POODLESSL V2 SSL V3 <br>TLS v1.0v1.1v1.2</p>\n<p>SSLTLS<br><br> 128  RC4 </p>\n<p> Web  HTTPS </p>\n<h2 id=\"client-hello\"><a href=\"#client-hello\" class=\"headerlink\" title=\"client hello\"></a>client hello</h2><p>wireshar<br><img src=\"/images/https/cipher-suites.png\" alt=\"\"></p>\n<h2 id=\"server-hello\"><a href=\"#server-hello\" class=\"headerlink\" title=\"server hello\"></a>server hello</h2><p>, <br><img src=\"/images/https/negotiated-cipher-suite.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ECDHE<br>ECDSA<br>AES_128_CBC<br>SHAMAC </p>\n<h1 id=\"-Web--HTTPS\"><a href=\"#-Web--HTTPS\" class=\"headerlink\" title=\" Web  HTTPS\"></a> Web  HTTPS</h1><p> Web  HTTPS </p>\n<p></p>\n<ul>\n<li> SSL </li>\n<li> Web </li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li>IP-&#x2F;</li>\n<li>TLS&#x2F;SSL</li>\n<li></li>\n</ul>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">listen</span> <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">    <span class=\"attribute\">server_name</span> xxx;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">ssl_certificate</span> /cert/xxx.crt;</span><br><span class=\"line\">    <span class=\"attribute\">ssl_certificate_key</span> /cert/xxx.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"section\">location</span> / &#123;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_pass</span> http://localhost:4000;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> X-Forwarded-Proto <span class=\"variable\">$scheme</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> Web  SSL <br>Apache  <a href=\"https://wiki.apache.org/httpd/SSL\">https://wiki.apache.org/httpd/SSL</a><br>IIS <a href=\"http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis\">http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis</a><br>Nginx <a href=\"http://nginx.org/en/docs/http/configuring_https_servers.html\">http://nginx.org/en/docs/http/configuring_https_servers.html</a></p>\n<p>Mozilla  HTTPS </p>\n<p><a href=\"https://mozilla.github.io/server-side-tls/ssl-config-generator/\">Mozilla SSL </a></p>\n<h1 id=\"-HTTPS-\"><a href=\"#-HTTPS-\" class=\"headerlink\" title=\" HTTPS \"></a> HTTPS </h1><p>HTTPS <br>bugopenSSL(<a href=\"https://baike.baidu.com/item/Heartbleed/13580882\">Heartbleed</a>),  HTTPS </p>\n<p></p>\n<p></p>\n<p><br><img src=\"/images/https/expire.png\" alt=\"\"></p>\n<h1 id=\"HTTPS-\"><a href=\"#HTTPS-\" class=\"headerlink\" title=\"HTTPS \"></a>HTTPS </h1><p> HTTPS </p>\n<h2 id=\"HTTPS-\"><a href=\"#HTTPS-\" class=\"headerlink\" title=\"HTTPS \"></a>HTTPS </h2><ol>\n<li></li>\n</ol>\n<p> DNS DNS  HTTPS  TipTopSecurity.comDNSSEC</p>\n<ol start=\"2\">\n<li></li>\n</ol>\n<p>HTTPS </p>\n<ol start=\"3\">\n<li></li>\n</ol>\n<p>HTTPS  IP  IP </p>\n<ol start=\"4\">\n<li></li>\n</ol>\n<p>HTTPS  HTTPS  Web  HTTPS  HTTPS</p>\n<ol start=\"5\">\n<li></li>\n</ol>\n<p>HTTPS  Web  HTTPS </p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"-HTTPS\"><a href=\"#-HTTPS\" class=\"headerlink\" title=\" HTTPS\"></a> HTTPS</h1><p>HTTP Web  HTTPS HTTP<br>HTTP </p>\n<p>HTTP HTTP </p>\n<p><img src=\"/images/https/security.png\" alt=\"\"></p>\n<p>HTTPS </p>\n<ul>\n<li>HTTPS </li>\n<li></li>\n<li>HTTPS  SHA-256</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> SSL <br></p>\n<p>DigiCertGeoTrustGlobalSignCFCATrustAsia</p>\n<p><img src=\"/images/https/ca2.png\" alt=\"ca\"></p>\n<h1 id=\"SSL-\"><a href=\"#SSL-\" class=\"headerlink\" title=\"SSL \"></a>SSL </h1><p>SSL  Web  SSL  TLS</p>\n<p><img src=\"/images/https/handshake.png\" alt=\"\"><a href=\"https://code-maze.com/wp-content/uploads/2017/07/TLS-handshake.png\">https://code-maze.com/wp-content/uploads/2017/07/TLS-handshake.png</a></p>\n<p></p>\n<ol>\n<li>SSL XTLS X</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>httpswireshark<br><img src=\"/images/https/client-hello.png\" alt=\"\"><br><br><img src=\"/images/https/encrypted.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>HTTPS <br>HTTPS  HTTP  SSL  TLS <br>POODLESSL V2 SSL V3 <br>TLS v1.0v1.1v1.2</p>\n<p>SSLTLS<br><br> 128  RC4 </p>\n<p> Web  HTTPS </p>\n<h2 id=\"client-hello\"><a href=\"#client-hello\" class=\"headerlink\" title=\"client hello\"></a>client hello</h2><p>wireshar<br><img src=\"/images/https/cipher-suites.png\" alt=\"\"></p>\n<h2 id=\"server-hello\"><a href=\"#server-hello\" class=\"headerlink\" title=\"server hello\"></a>server hello</h2><p>, <br><img src=\"/images/https/negotiated-cipher-suite.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ECDHE<br>ECDSA<br>AES_128_CBC<br>SHAMAC </p>\n<h1 id=\"-Web--HTTPS\"><a href=\"#-Web--HTTPS\" class=\"headerlink\" title=\" Web  HTTPS\"></a> Web  HTTPS</h1><p> Web  HTTPS </p>\n<p></p>\n<ul>\n<li> SSL </li>\n<li> Web </li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li>IP-&#x2F;</li>\n<li>TLS&#x2F;SSL</li>\n<li></li>\n</ul>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">listen</span> <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">    <span class=\"attribute\">server_name</span> xxx;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">ssl_certificate</span> /cert/xxx.crt;</span><br><span class=\"line\">    <span class=\"attribute\">ssl_certificate_key</span> /cert/xxx.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"section\">location</span> / &#123;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_pass</span> http://localhost:4000;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> Host <span class=\"variable\">$host</span>;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_set_header</span> X-Forwarded-Proto <span class=\"variable\">$scheme</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> Web  SSL <br>Apache  <a href=\"https://wiki.apache.org/httpd/SSL\">https://wiki.apache.org/httpd/SSL</a><br>IIS <a href=\"http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis\">http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis</a><br>Nginx <a href=\"http://nginx.org/en/docs/http/configuring_https_servers.html\">http://nginx.org/en/docs/http/configuring_https_servers.html</a></p>\n<p>Mozilla  HTTPS </p>\n<p><a href=\"https://mozilla.github.io/server-side-tls/ssl-config-generator/\">Mozilla SSL </a></p>\n<h1 id=\"-HTTPS-\"><a href=\"#-HTTPS-\" class=\"headerlink\" title=\" HTTPS \"></a> HTTPS </h1><p>HTTPS <br>bugopenSSL(<a href=\"https://baike.baidu.com/item/Heartbleed/13580882\">Heartbleed</a>),  HTTPS </p>\n<p></p>\n<p></p>\n<p><br><img src=\"/images/https/expire.png\" alt=\"\"></p>\n<h1 id=\"HTTPS-\"><a href=\"#HTTPS-\" class=\"headerlink\" title=\"HTTPS \"></a>HTTPS </h1><p> HTTPS </p>\n<h2 id=\"HTTPS-\"><a href=\"#HTTPS-\" class=\"headerlink\" title=\"HTTPS \"></a>HTTPS </h2><ol>\n<li></li>\n</ol>\n<p> DNS DNS  HTTPS  TipTopSecurity.comDNSSEC</p>\n<ol start=\"2\">\n<li></li>\n</ol>\n<p>HTTPS </p>\n<ol start=\"3\">\n<li></li>\n</ol>\n<p>HTTPS  IP  IP </p>\n<ol start=\"4\">\n<li></li>\n</ol>\n<p>HTTPS  HTTPS  Web  HTTPS  HTTPS</p>\n<ol start=\"5\">\n<li></li>\n</ol>\n<p>HTTPS  Web  HTTPS </p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n"},{"title":"","date":"2024-03-28T09:49:50.000Z","_content":"\n\n![](/images/internal-loss/depressed.jpg)\n\n\n\n\n\n****** \n\n# \n\n## 1. \n\n  \n\n120%20%\n****\n\n\n\n\n## 2. \n\n\n\n\n\n\n\n\n\n+ \n+ 996\n\n![996](/images/internal-loss/996.jpg)\n\n\n2h\n\n\n\n\n\n\n## 3. \n\n\n\n\n+ \n+ \n+ \n\n\n# \n<font size=\"2\" color=\"#A9A9A9\"></font>\n\nyy\n\n\n\n1. \n\n2. \n\n\n\n# \n\n\n\n\n\n\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","source":"_posts/organization-internal-loss.md","raw":"---\ntitle: \ndate: 2024-03-28 17:49:50\ntags:  \n---\n\n\n![](/images/internal-loss/depressed.jpg)\n\n\n\n\n\n****** \n\n# \n\n## 1. \n\n  \n\n120%20%\n****\n\n\n\n\n## 2. \n\n\n\n\n\n\n\n\n\n+ \n+ 996\n\n![996](/images/internal-loss/996.jpg)\n\n\n2h\n\n\n\n\n\n\n## 3. \n\n\n\n\n+ \n+ \n+ \n\n\n# \n<font size=\"2\" color=\"#A9A9A9\"></font>\n\nyy\n\n\n\n1. \n\n2. \n\n\n\n# \n\n\n\n\n\n\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","slug":"organization-internal-loss","published":1,"updated":"2024-04-26T03:06:35.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhc000du8p155z813xo","content":"<p><br><img src=\"/images/internal-loss/depressed.jpg\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p><em><strong></strong></em> </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h2><p>  </p>\n<p>120%20%<br><strong></strong></p>\n<p></p>\n<p></p>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h2><p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li>996</li>\n</ul>\n<p><img src=\"/images/internal-loss/996.jpg\" alt=\"996\"></p>\n<p><br>2h</p>\n<p></p>\n<p><br></p>\n<h2 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h2><p><br></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><font size=\"2\" color=\"#A9A9A9\"></font></p>\n<p>yy</p>\n<p></p>\n<ol>\n<li><br></li>\n<li><br></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><br><img src=\"/images/internal-loss/depressed.jpg\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p><em><strong></strong></em> </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h2><p>  </p>\n<p>120%20%<br><strong></strong></p>\n<p></p>\n<p></p>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h2><p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li>996</li>\n</ul>\n<p><img src=\"/images/internal-loss/996.jpg\" alt=\"996\"></p>\n<p><br>2h</p>\n<p></p>\n<p><br></p>\n<h2 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h2><p><br></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><font size=\"2\" color=\"#A9A9A9\"></font></p>\n<p>yy</p>\n<p></p>\n<ol>\n<li><br></li>\n<li><br></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n"},{"title":"","date":"2024-06-20T02:06:56.000Z","_content":"\n\n\n\n\n# \nProxy Server\n\n# \n## \nForward Proxy\n\n## \n![](/images/proxy/forward-proxy.png)\n1. \n2. \n3. \n4. \n\n## \n1. \n2. \n3. IP\n\n## \n```\n# Python\nfrom http.server import BaseHTTPRequestHandler, HTTPServer\nimport requests\n\nclass Proxy(BaseHTTPRequestHandler):\n    def do_GET(self):\n        url = self.path[1:]\n        response = requests.get(url)\n        self.send_response(response.status_code)\n        self.send_header('Content-type', response.headers['Content-Type'])\n        self.end_headers()\n        self.wfile.write(response.content)\n\nif __name__ == \"__main__\":\n    server = HTTPServer(('localhost', 8080), Proxy)\n    print(\"Starting proxy server on port 8080\")\n    server.serve_forever()\n\n```\n\n# \n## \nReverse Proxy\n\n\n\n\n## \n\n\n\n\n\nNginxApache Web \n\n## \n![](/images/proxy/reverse-proxy.png)\n1. \n2. \n3. \n4. \n\n## \n1. \n2. IP\n3. SSLSSL\n\n## \n```\n# Nginx \nserver {\n    listen 80;\n    server_name example.com;\n\n    location / {\n        proxy_pass http://backend_server;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n```\n\n# \n## \nTransparent Proxy\n\n\n\nIPISP\n\n## \n![](/images/proxy/transparent-proxy.png)\n1. \n2. \n3. \n4. \n\n## \n1. \n2. \n3. \n\n## \n```shell\n# iptables\n# IP192.168.1.18080\niptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1:8080\niptables -t nat -A POSTROUTING -j MASQUERADE\n```\n\n# \n","source":"_posts/proxy.md","raw":"---\ntitle: \ndate: 2024-06-20 10:06:56\ntags:\n---\n\n\n\n\n\n# \nProxy Server\n\n# \n## \nForward Proxy\n\n## \n![](/images/proxy/forward-proxy.png)\n1. \n2. \n3. \n4. \n\n## \n1. \n2. \n3. IP\n\n## \n```\n# Python\nfrom http.server import BaseHTTPRequestHandler, HTTPServer\nimport requests\n\nclass Proxy(BaseHTTPRequestHandler):\n    def do_GET(self):\n        url = self.path[1:]\n        response = requests.get(url)\n        self.send_response(response.status_code)\n        self.send_header('Content-type', response.headers['Content-Type'])\n        self.end_headers()\n        self.wfile.write(response.content)\n\nif __name__ == \"__main__\":\n    server = HTTPServer(('localhost', 8080), Proxy)\n    print(\"Starting proxy server on port 8080\")\n    server.serve_forever()\n\n```\n\n# \n## \nReverse Proxy\n\n\n\n\n## \n\n\n\n\n\nNginxApache Web \n\n## \n![](/images/proxy/reverse-proxy.png)\n1. \n2. \n3. \n4. \n\n## \n1. \n2. IP\n3. SSLSSL\n\n## \n```\n# Nginx \nserver {\n    listen 80;\n    server_name example.com;\n\n    location / {\n        proxy_pass http://backend_server;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n```\n\n# \n## \nTransparent Proxy\n\n\n\nIPISP\n\n## \n![](/images/proxy/transparent-proxy.png)\n1. \n2. \n3. \n4. \n\n## \n1. \n2. \n3. \n\n## \n```shell\n# iptables\n# IP192.168.1.18080\niptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1:8080\niptables -t nat -A POSTROUTING -j MASQUERADE\n```\n\n# \n","slug":"proxy","published":1,"updated":"2024-06-21T01:04:32.131Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhc000eu8p1dqxqfp2l","content":"<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Proxy Server</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Forward Proxy</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/images/proxy/forward-proxy.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li></li>\n<li>IP</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Python</span><br><span class=\"line\">from http.server import BaseHTTPRequestHandler, HTTPServer</span><br><span class=\"line\">import requests</span><br><span class=\"line\"></span><br><span class=\"line\">class Proxy(BaseHTTPRequestHandler):</span><br><span class=\"line\">    def do_GET(self):</span><br><span class=\"line\">        url = self.path[1:]</span><br><span class=\"line\">        response = requests.get(url)</span><br><span class=\"line\">        self.send_response(response.status_code)</span><br><span class=\"line\">        self.send_header(&#x27;Content-type&#x27;, response.headers[&#x27;Content-Type&#x27;])</span><br><span class=\"line\">        self.end_headers()</span><br><span class=\"line\">        self.wfile.write(response.content)</span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &quot;__main__&quot;:</span><br><span class=\"line\">    server = HTTPServer((&#x27;localhost&#x27;, 8080), Proxy)</span><br><span class=\"line\">    print(&quot;Starting proxy server on port 8080&quot;)</span><br><span class=\"line\">    server.serve_forever()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>Reverse Proxy</p>\n<p><br></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><br><br></p>\n<p>NginxApache Web </p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/images/proxy/reverse-proxy.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li>IP</li>\n<li>SSLSSL</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Nginx </span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name example.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://backend_server;</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><p>Transparent Proxy</p>\n<p></p>\n<p>IPISP</p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/images/proxy/transparent-proxy.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">iptables</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">IP192.168.1.18080</span></span><br><span class=\"line\">iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1:8080</span><br><span class=\"line\">iptables -t nat -A POSTROUTING -j MASQUERADE</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n","site":{"data":{}},"excerpt":"","more":"<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Proxy Server</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Forward Proxy</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/images/proxy/forward-proxy.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li></li>\n<li>IP</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Python</span><br><span class=\"line\">from http.server import BaseHTTPRequestHandler, HTTPServer</span><br><span class=\"line\">import requests</span><br><span class=\"line\"></span><br><span class=\"line\">class Proxy(BaseHTTPRequestHandler):</span><br><span class=\"line\">    def do_GET(self):</span><br><span class=\"line\">        url = self.path[1:]</span><br><span class=\"line\">        response = requests.get(url)</span><br><span class=\"line\">        self.send_response(response.status_code)</span><br><span class=\"line\">        self.send_header(&#x27;Content-type&#x27;, response.headers[&#x27;Content-Type&#x27;])</span><br><span class=\"line\">        self.end_headers()</span><br><span class=\"line\">        self.wfile.write(response.content)</span><br><span class=\"line\"></span><br><span class=\"line\">if __name__ == &quot;__main__&quot;:</span><br><span class=\"line\">    server = HTTPServer((&#x27;localhost&#x27;, 8080), Proxy)</span><br><span class=\"line\">    print(&quot;Starting proxy server on port 8080&quot;)</span><br><span class=\"line\">    server.serve_forever()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>Reverse Proxy</p>\n<p><br></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><br><br></p>\n<p>NginxApache Web </p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/images/proxy/reverse-proxy.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li>IP</li>\n<li>SSLSSL</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Nginx </span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name example.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://backend_server;</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><p>Transparent Proxy</p>\n<p></p>\n<p>IPISP</p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/images/proxy/transparent-proxy.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">iptables</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">IP192.168.1.18080</span></span><br><span class=\"line\">iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1:8080</span><br><span class=\"line\">iptables -t nat -A POSTROUTING -j MASQUERADE</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n"},{"title":" RabbitMQ ","date":"2024-07-09T08:28:36.000Z","_content":"\nRabbitMQ  RabbitMQ  RabbitMQ  ChannelExchangeQueueVhostRoute \n\n#  RabbitMQ \n1. \n2. \n3. \n4. \n5. \n![mq-flow](/images/rabbitmq-basic/exchanges-bidings-routing-keys.svg)\n\n# 1. \n## 1.1 broker\n Broker \n\n RabbitMQ  BrokerBroker  2 \n\n+  Broker  Broker \n+  Broker  Broker \n## 1.2 Channel\nChannel  RabbitMQ  TCP  Channel TCP  Channel  Channel \n\nChannel / RabbitMQ  publish  RabbitMQ  TCP \n\n Channel Channel \n\n###  Channel  TCP \n1. \n   -  TCP  Channel \n   - TCP \n   - Channel \n\n2. \n   -  Channel  Channel  QoSQuality of Service\n   -  TCP \n\n3. \n   -  TCP \n   -  Channel  TCP \n\n2Channel2ConnectionConnection\n![channelconnection](/images/rabbitmq-basic/channel1.png)\n```CSharp\nvar factory = new ConnectionFactory() {\n    HostName = \"127.0.0.1\"\n};\nstring clientProvidedName = $\"{EnvUtils.GetAppName()}({EnvUtils.GetHostName()})-Subscriber\";\n\n//  TCP \nvar connection = factory.CreateConnection(clientProvidedName);\nstring consumerTag = $\"{EnvUtils.GetAppName()}({EnvUtils.GetHostName()})\";\n\n//  Channel\nvar channel1 = connection.CreateModel();\nvar queueName1 = \"TestMQ.Rabbit.WeChat\";\n\nvar consumer1 = new EventingBasicConsumer(channel1);\nconsumer1.Received += (model, ea) => {\n    var body = ea.Body.ToArray();\n    var message = Encoding.UTF8.GetString(body);\n};\nchannel1.BasicConsume(queue: queueName1, autoAck: true, consumerTag, consumer: consumer1);\n\n//  Channel\nvar channel2 = connection.CreateModel();\nvar queueName2 = \"TestMQ.Rabbit.Email\";\n\nvar consumer2 = new EventingBasicConsumer(channel2);\nconsumer2.Received += (model, ea) => {\n    var body = ea.Body.ToArray();\n    var message = Encoding.UTF8.GetString(body);\n};\nchannel2.BasicConsume(queue: queueName2, autoAck: true, consumerTag, consumer: consumer2);\n```\n![channelconnection](/images/rabbitmq-basic/channel2.png)\n\n## 1.3 Exchange\nExchange  RabbitMQ  Queue  Exchange \n\n+ Direct Exchangerouting key Queue\n+ Topic Exchange logs.* Queue\n+ Fanout Exchange Queue\n+ Headers Exchange\n## 1.4 Queue\nQueue  RabbitMQ  Queue Queue  ExchangeQueue  FIFOFirst In, First Out\n\n## 1.5 VhostVirtual Host\nvhost()RabbitMQ\n\n\n### \n1. \n   -  vhost  vhost  vhost \n   -  vhost A  B  vhost \n2.\n   - tenant vhost SaaS \n3. \n   -  vhost \n4. \n   -  vhost RabbitMQ  vhost \n\n\n4Exchangevhostmqvhost47Exchange\n![](/images/rabbitmq-basic/default-exchange.png)\n\n## 1.6 Routing Key\nRouting Key Exchange  Routing Key  Queue Exchange  Routing Key \n\n### Exchange  RoutingKeyBindingKey \n RoutingKey  BindingKey \n\n1. Direct Exchange\n   -  RoutingKey \n   - RoutingKey  \"orange\"  BindingKey  \"orange\" \n    ![direct exchange](/images/rabbitmq-basic/direct-exchange.svg)\n2. Topic Exchange\n   -  RoutingKey  BindingKey \n   - RoutingKey BindingKey  * #\n   - RoutingKey  \"user.update.info\"  BindingKey  \"user.*.info\"  \"user.#\"\n![direct exchange](/images/rabbitmq-basic/topic-exchange.svg)\n3. Fanout Exchange\n   -  RoutingKey\n   - BindingKey \n![direct exchange](/images/rabbitmq-basic/fanout-exchange.svg)\nfanoutdemo4\n   ![fanout](/images/rabbitmq-basic/vro2s-b2mub.gif)\n4. Headers Exchange\n   - Headers RoutingKey \n   - BindingKey \n![direct exchange](/images/rabbitmq-basic/rabbitmq-headers-exchange.svg)\n\n ExchangeQueueRoutingKey  Exchange  Queue \n\n\n# 3. \nmqmq\n\n## 3.1 \n RabbitMQ \n\n## 3.2 \n RabbitMQ \n\n## 3.3 \n Fanout Exchange\n\n# 4. \nRabbitMQ  ChannelExchangeQueueVhostRouting Key  RabbitMQ\n\n\n\n[RabbitMq](https://www.rabbitmq.com/docs/classic-queues)\n\n\nDocker","source":"_posts/rabbitmq-basic.md","raw":"---\ntitle:  RabbitMQ \ndate: 2024-07-09 16:28:36\ntags:\n---\n\nRabbitMQ  RabbitMQ  RabbitMQ  ChannelExchangeQueueVhostRoute \n\n#  RabbitMQ \n1. \n2. \n3. \n4. \n5. \n![mq-flow](/images/rabbitmq-basic/exchanges-bidings-routing-keys.svg)\n\n# 1. \n## 1.1 broker\n Broker \n\n RabbitMQ  BrokerBroker  2 \n\n+  Broker  Broker \n+  Broker  Broker \n## 1.2 Channel\nChannel  RabbitMQ  TCP  Channel TCP  Channel  Channel \n\nChannel / RabbitMQ  publish  RabbitMQ  TCP \n\n Channel Channel \n\n###  Channel  TCP \n1. \n   -  TCP  Channel \n   - TCP \n   - Channel \n\n2. \n   -  Channel  Channel  QoSQuality of Service\n   -  TCP \n\n3. \n   -  TCP \n   -  Channel  TCP \n\n2Channel2ConnectionConnection\n![channelconnection](/images/rabbitmq-basic/channel1.png)\n```CSharp\nvar factory = new ConnectionFactory() {\n    HostName = \"127.0.0.1\"\n};\nstring clientProvidedName = $\"{EnvUtils.GetAppName()}({EnvUtils.GetHostName()})-Subscriber\";\n\n//  TCP \nvar connection = factory.CreateConnection(clientProvidedName);\nstring consumerTag = $\"{EnvUtils.GetAppName()}({EnvUtils.GetHostName()})\";\n\n//  Channel\nvar channel1 = connection.CreateModel();\nvar queueName1 = \"TestMQ.Rabbit.WeChat\";\n\nvar consumer1 = new EventingBasicConsumer(channel1);\nconsumer1.Received += (model, ea) => {\n    var body = ea.Body.ToArray();\n    var message = Encoding.UTF8.GetString(body);\n};\nchannel1.BasicConsume(queue: queueName1, autoAck: true, consumerTag, consumer: consumer1);\n\n//  Channel\nvar channel2 = connection.CreateModel();\nvar queueName2 = \"TestMQ.Rabbit.Email\";\n\nvar consumer2 = new EventingBasicConsumer(channel2);\nconsumer2.Received += (model, ea) => {\n    var body = ea.Body.ToArray();\n    var message = Encoding.UTF8.GetString(body);\n};\nchannel2.BasicConsume(queue: queueName2, autoAck: true, consumerTag, consumer: consumer2);\n```\n![channelconnection](/images/rabbitmq-basic/channel2.png)\n\n## 1.3 Exchange\nExchange  RabbitMQ  Queue  Exchange \n\n+ Direct Exchangerouting key Queue\n+ Topic Exchange logs.* Queue\n+ Fanout Exchange Queue\n+ Headers Exchange\n## 1.4 Queue\nQueue  RabbitMQ  Queue Queue  ExchangeQueue  FIFOFirst In, First Out\n\n## 1.5 VhostVirtual Host\nvhost()RabbitMQ\n\n\n### \n1. \n   -  vhost  vhost  vhost \n   -  vhost A  B  vhost \n2.\n   - tenant vhost SaaS \n3. \n   -  vhost \n4. \n   -  vhost RabbitMQ  vhost \n\n\n4Exchangevhostmqvhost47Exchange\n![](/images/rabbitmq-basic/default-exchange.png)\n\n## 1.6 Routing Key\nRouting Key Exchange  Routing Key  Queue Exchange  Routing Key \n\n### Exchange  RoutingKeyBindingKey \n RoutingKey  BindingKey \n\n1. Direct Exchange\n   -  RoutingKey \n   - RoutingKey  \"orange\"  BindingKey  \"orange\" \n    ![direct exchange](/images/rabbitmq-basic/direct-exchange.svg)\n2. Topic Exchange\n   -  RoutingKey  BindingKey \n   - RoutingKey BindingKey  * #\n   - RoutingKey  \"user.update.info\"  BindingKey  \"user.*.info\"  \"user.#\"\n![direct exchange](/images/rabbitmq-basic/topic-exchange.svg)\n3. Fanout Exchange\n   -  RoutingKey\n   - BindingKey \n![direct exchange](/images/rabbitmq-basic/fanout-exchange.svg)\nfanoutdemo4\n   ![fanout](/images/rabbitmq-basic/vro2s-b2mub.gif)\n4. Headers Exchange\n   - Headers RoutingKey \n   - BindingKey \n![direct exchange](/images/rabbitmq-basic/rabbitmq-headers-exchange.svg)\n\n ExchangeQueueRoutingKey  Exchange  Queue \n\n\n# 3. \nmqmq\n\n## 3.1 \n RabbitMQ \n\n## 3.2 \n RabbitMQ \n\n## 3.3 \n Fanout Exchange\n\n# 4. \nRabbitMQ  ChannelExchangeQueueVhostRouting Key  RabbitMQ\n\n\n\n[RabbitMq](https://www.rabbitmq.com/docs/classic-queues)\n\n\nDocker","slug":"rabbitmq-basic","published":1,"updated":"2024-07-10T12:42:57.682Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhd000fu8p1aj4y1z3x","content":"<p>RabbitMQ  RabbitMQ  RabbitMQ  ChannelExchangeQueueVhostRoute </p>\n<h1 id=\"-RabbitMQ-\"><a href=\"#-RabbitMQ-\" class=\"headerlink\" title=\" RabbitMQ \"></a> RabbitMQ </h1><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li><br><img src=\"/images/rabbitmq-basic/exchanges-bidings-routing-keys.svg\" alt=\"mq-flow\"></li>\n</ol>\n<h1 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h1><h2 id=\"1-1-broker\"><a href=\"#1-1-broker\" class=\"headerlink\" title=\"1.1 broker\"></a>1.1 broker</h2><p> Broker </p>\n<p> RabbitMQ  BrokerBroker  2 </p>\n<ul>\n<li> Broker  Broker </li>\n<li> Broker  Broker </li>\n</ul>\n<h2 id=\"1-2-Channel\"><a href=\"#1-2-Channel\" class=\"headerlink\" title=\"1.2 Channel\"></a>1.2 Channel</h2><p>Channel  RabbitMQ  TCP  Channel TCP  Channel  Channel </p>\n<p>Channel &#x2F; RabbitMQ  publish  RabbitMQ  TCP </p>\n<p> Channel Channel </p>\n<h3 id=\"-Channel--TCP-\"><a href=\"#-Channel--TCP-\" class=\"headerlink\" title=\" Channel  TCP \"></a> Channel  TCP </h3><ol>\n<li><p></p>\n<ul>\n<li> TCP  Channel </li>\n<li>TCP </li>\n<li>Channel </li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> Channel  Channel  QoSQuality of Service</li>\n<li> TCP </li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> TCP </li>\n<li> Channel  TCP </li>\n</ul>\n</li>\n</ol>\n<p>2Channel2ConnectionConnection<br><img src=\"/images/rabbitmq-basic/channel1.png\" alt=\"channelconnection\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> factory = <span class=\"keyword\">new</span> ConnectionFactory() &#123;</span><br><span class=\"line\">    HostName = <span class=\"string\">&quot;127.0.0.1&quot;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">string</span> clientProvidedName = <span class=\"string\">$&quot;<span class=\"subst\">&#123;EnvUtils.GetAppName()&#125;</span>(<span class=\"subst\">&#123;EnvUtils.GetHostName()&#125;</span>)-Subscriber&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  TCP </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> connection = factory.CreateConnection(clientProvidedName);</span><br><span class=\"line\"><span class=\"built_in\">string</span> consumerTag = <span class=\"string\">$&quot;<span class=\"subst\">&#123;EnvUtils.GetAppName()&#125;</span>(<span class=\"subst\">&#123;EnvUtils.GetHostName()&#125;</span>)&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Channel</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> channel1 = connection.CreateModel();</span><br><span class=\"line\"><span class=\"keyword\">var</span> queueName1 = <span class=\"string\">&quot;TestMQ.Rabbit.WeChat&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> consumer1 = <span class=\"keyword\">new</span> EventingBasicConsumer(channel1);</span><br><span class=\"line\">consumer1.Received += (model, ea) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">channel1.BasicConsume(queue: queueName1, autoAck: <span class=\"literal\">true</span>, consumerTag, consumer: consumer1);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Channel</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> channel2 = connection.CreateModel();</span><br><span class=\"line\"><span class=\"keyword\">var</span> queueName2 = <span class=\"string\">&quot;TestMQ.Rabbit.Email&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> consumer2 = <span class=\"keyword\">new</span> EventingBasicConsumer(channel2);</span><br><span class=\"line\">consumer2.Received += (model, ea) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">channel2.BasicConsume(queue: queueName2, autoAck: <span class=\"literal\">true</span>, consumerTag, consumer: consumer2);</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/rabbitmq-basic/channel2.png\" alt=\"channelconnection\"></p>\n<h2 id=\"1-3-Exchange\"><a href=\"#1-3-Exchange\" class=\"headerlink\" title=\"1.3 Exchange\"></a>1.3 Exchange</h2><p>Exchange  RabbitMQ  Queue  Exchange </p>\n<ul>\n<li>Direct Exchangerouting key Queue</li>\n<li>Topic Exchange logs.* Queue</li>\n<li>Fanout Exchange Queue</li>\n<li>Headers Exchange</li>\n</ul>\n<h2 id=\"1-4-Queue\"><a href=\"#1-4-Queue\" class=\"headerlink\" title=\"1.4 Queue\"></a>1.4 Queue</h2><p>Queue  RabbitMQ  Queue Queue  ExchangeQueue  FIFOFirst In, First Out</p>\n<h2 id=\"1-5-VhostVirtual-Host\"><a href=\"#1-5-VhostVirtual-Host\" class=\"headerlink\" title=\"1.5 VhostVirtual Host\"></a>1.5 VhostVirtual Host</h2><p>vhost()RabbitMQ</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><ul>\n<li> vhost  vhost  vhost </li>\n<li> vhost A  B  vhost <br>2.</li>\n<li>tenant vhost SaaS </li>\n</ul>\n</li>\n<li><ul>\n<li> vhost </li>\n</ul>\n</li>\n<li><ul>\n<li> vhost RabbitMQ  vhost </li>\n</ul>\n</li>\n</ol>\n<p>4Exchangevhostmqvhost47Exchange<br><img src=\"/images/rabbitmq-basic/default-exchange.png\" alt=\"\"></p>\n<h2 id=\"1-6-Routing-Key\"><a href=\"#1-6-Routing-Key\" class=\"headerlink\" title=\"1.6 Routing Key\"></a>1.6 Routing Key</h2><p>Routing Key Exchange  Routing Key  Queue Exchange  Routing Key </p>\n<h3 id=\"Exchange--RoutingKeyBindingKey-\"><a href=\"#Exchange--RoutingKeyBindingKey-\" class=\"headerlink\" title=\"Exchange  RoutingKeyBindingKey \"></a>Exchange  RoutingKeyBindingKey </h3><p> RoutingKey  BindingKey </p>\n<ol>\n<li>Direct Exchange<ul>\n<li> RoutingKey </li>\n<li>RoutingKey  orange  BindingKey  orange <br> <img src=\"/images/rabbitmq-basic/direct-exchange.svg\" alt=\"direct exchange\"></li>\n</ul>\n</li>\n<li>Topic Exchange<ul>\n<li> RoutingKey  BindingKey </li>\n<li>RoutingKey BindingKey  * #</li>\n<li>RoutingKey  user.update.info  BindingKey  user.*.info  user.#<br><img src=\"/images/rabbitmq-basic/topic-exchange.svg\" alt=\"direct exchange\"></li>\n</ul>\n</li>\n<li>Fanout Exchange<ul>\n<li> RoutingKey</li>\n<li>BindingKey <br><img src=\"/images/rabbitmq-basic/fanout-exchange.svg\" alt=\"direct exchange\"><br>fanoutdemo4<br><img src=\"/images/rabbitmq-basic/vro2s-b2mub.gif\" alt=\"fanout\"></li>\n</ul>\n</li>\n<li>Headers Exchange<ul>\n<li>Headers RoutingKey </li>\n<li>BindingKey <br><img src=\"/images/rabbitmq-basic/rabbitmq-headers-exchange.svg\" alt=\"direct exchange\"></li>\n</ul>\n</li>\n</ol>\n<p> ExchangeQueueRoutingKey  Exchange  Queue </p>\n<h1 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h1><p>mqmq</p>\n<h2 id=\"3-1-\"><a href=\"#3-1-\" class=\"headerlink\" title=\"3.1 \"></a>3.1 </h2><p> RabbitMQ </p>\n<h2 id=\"3-2-\"><a href=\"#3-2-\" class=\"headerlink\" title=\"3.2 \"></a>3.2 </h2><p> RabbitMQ </p>\n<h2 id=\"3-3-\"><a href=\"#3-3-\" class=\"headerlink\" title=\"3.3 \"></a>3.3 </h2><p> Fanout Exchange</p>\n<h1 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h1><p>RabbitMQ  ChannelExchangeQueueVhostRouting Key  RabbitMQ</p>\n<p><br><a href=\"https://www.rabbitmq.com/docs/classic-queues\">RabbitMq</a></p>\n<p>Docker</p>\n","site":{"data":{}},"excerpt":"","more":"<p>RabbitMQ  RabbitMQ  RabbitMQ  ChannelExchangeQueueVhostRoute </p>\n<h1 id=\"-RabbitMQ-\"><a href=\"#-RabbitMQ-\" class=\"headerlink\" title=\" RabbitMQ \"></a> RabbitMQ </h1><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li><br><img src=\"/images/rabbitmq-basic/exchanges-bidings-routing-keys.svg\" alt=\"mq-flow\"></li>\n</ol>\n<h1 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h1><h2 id=\"1-1-broker\"><a href=\"#1-1-broker\" class=\"headerlink\" title=\"1.1 broker\"></a>1.1 broker</h2><p> Broker </p>\n<p> RabbitMQ  BrokerBroker  2 </p>\n<ul>\n<li> Broker  Broker </li>\n<li> Broker  Broker </li>\n</ul>\n<h2 id=\"1-2-Channel\"><a href=\"#1-2-Channel\" class=\"headerlink\" title=\"1.2 Channel\"></a>1.2 Channel</h2><p>Channel  RabbitMQ  TCP  Channel TCP  Channel  Channel </p>\n<p>Channel &#x2F; RabbitMQ  publish  RabbitMQ  TCP </p>\n<p> Channel Channel </p>\n<h3 id=\"-Channel--TCP-\"><a href=\"#-Channel--TCP-\" class=\"headerlink\" title=\" Channel  TCP \"></a> Channel  TCP </h3><ol>\n<li><p></p>\n<ul>\n<li> TCP  Channel </li>\n<li>TCP </li>\n<li>Channel </li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> Channel  Channel  QoSQuality of Service</li>\n<li> TCP </li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> TCP </li>\n<li> Channel  TCP </li>\n</ul>\n</li>\n</ol>\n<p>2Channel2ConnectionConnection<br><img src=\"/images/rabbitmq-basic/channel1.png\" alt=\"channelconnection\"></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> factory = <span class=\"keyword\">new</span> ConnectionFactory() &#123;</span><br><span class=\"line\">    HostName = <span class=\"string\">&quot;127.0.0.1&quot;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">string</span> clientProvidedName = <span class=\"string\">$&quot;<span class=\"subst\">&#123;EnvUtils.GetAppName()&#125;</span>(<span class=\"subst\">&#123;EnvUtils.GetHostName()&#125;</span>)-Subscriber&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  TCP </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> connection = factory.CreateConnection(clientProvidedName);</span><br><span class=\"line\"><span class=\"built_in\">string</span> consumerTag = <span class=\"string\">$&quot;<span class=\"subst\">&#123;EnvUtils.GetAppName()&#125;</span>(<span class=\"subst\">&#123;EnvUtils.GetHostName()&#125;</span>)&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Channel</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> channel1 = connection.CreateModel();</span><br><span class=\"line\"><span class=\"keyword\">var</span> queueName1 = <span class=\"string\">&quot;TestMQ.Rabbit.WeChat&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> consumer1 = <span class=\"keyword\">new</span> EventingBasicConsumer(channel1);</span><br><span class=\"line\">consumer1.Received += (model, ea) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">channel1.BasicConsume(queue: queueName1, autoAck: <span class=\"literal\">true</span>, consumerTag, consumer: consumer1);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//  Channel</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> channel2 = connection.CreateModel();</span><br><span class=\"line\"><span class=\"keyword\">var</span> queueName2 = <span class=\"string\">&quot;TestMQ.Rabbit.Email&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> consumer2 = <span class=\"keyword\">new</span> EventingBasicConsumer(channel2);</span><br><span class=\"line\">consumer2.Received += (model, ea) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">channel2.BasicConsume(queue: queueName2, autoAck: <span class=\"literal\">true</span>, consumerTag, consumer: consumer2);</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/rabbitmq-basic/channel2.png\" alt=\"channelconnection\"></p>\n<h2 id=\"1-3-Exchange\"><a href=\"#1-3-Exchange\" class=\"headerlink\" title=\"1.3 Exchange\"></a>1.3 Exchange</h2><p>Exchange  RabbitMQ  Queue  Exchange </p>\n<ul>\n<li>Direct Exchangerouting key Queue</li>\n<li>Topic Exchange logs.* Queue</li>\n<li>Fanout Exchange Queue</li>\n<li>Headers Exchange</li>\n</ul>\n<h2 id=\"1-4-Queue\"><a href=\"#1-4-Queue\" class=\"headerlink\" title=\"1.4 Queue\"></a>1.4 Queue</h2><p>Queue  RabbitMQ  Queue Queue  ExchangeQueue  FIFOFirst In, First Out</p>\n<h2 id=\"1-5-VhostVirtual-Host\"><a href=\"#1-5-VhostVirtual-Host\" class=\"headerlink\" title=\"1.5 VhostVirtual Host\"></a>1.5 VhostVirtual Host</h2><p>vhost()RabbitMQ</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><ul>\n<li> vhost  vhost  vhost </li>\n<li> vhost A  B  vhost <br>2.</li>\n<li>tenant vhost SaaS </li>\n</ul>\n</li>\n<li><ul>\n<li> vhost </li>\n</ul>\n</li>\n<li><ul>\n<li> vhost RabbitMQ  vhost </li>\n</ul>\n</li>\n</ol>\n<p>4Exchangevhostmqvhost47Exchange<br><img src=\"/images/rabbitmq-basic/default-exchange.png\" alt=\"\"></p>\n<h2 id=\"1-6-Routing-Key\"><a href=\"#1-6-Routing-Key\" class=\"headerlink\" title=\"1.6 Routing Key\"></a>1.6 Routing Key</h2><p>Routing Key Exchange  Routing Key  Queue Exchange  Routing Key </p>\n<h3 id=\"Exchange--RoutingKeyBindingKey-\"><a href=\"#Exchange--RoutingKeyBindingKey-\" class=\"headerlink\" title=\"Exchange  RoutingKeyBindingKey \"></a>Exchange  RoutingKeyBindingKey </h3><p> RoutingKey  BindingKey </p>\n<ol>\n<li>Direct Exchange<ul>\n<li> RoutingKey </li>\n<li>RoutingKey  orange  BindingKey  orange <br> <img src=\"/images/rabbitmq-basic/direct-exchange.svg\" alt=\"direct exchange\"></li>\n</ul>\n</li>\n<li>Topic Exchange<ul>\n<li> RoutingKey  BindingKey </li>\n<li>RoutingKey BindingKey  * #</li>\n<li>RoutingKey  user.update.info  BindingKey  user.*.info  user.#<br><img src=\"/images/rabbitmq-basic/topic-exchange.svg\" alt=\"direct exchange\"></li>\n</ul>\n</li>\n<li>Fanout Exchange<ul>\n<li> RoutingKey</li>\n<li>BindingKey <br><img src=\"/images/rabbitmq-basic/fanout-exchange.svg\" alt=\"direct exchange\"><br>fanoutdemo4<br><img src=\"/images/rabbitmq-basic/vro2s-b2mub.gif\" alt=\"fanout\"></li>\n</ul>\n</li>\n<li>Headers Exchange<ul>\n<li>Headers RoutingKey </li>\n<li>BindingKey <br><img src=\"/images/rabbitmq-basic/rabbitmq-headers-exchange.svg\" alt=\"direct exchange\"></li>\n</ul>\n</li>\n</ol>\n<p> ExchangeQueueRoutingKey  Exchange  Queue </p>\n<h1 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h1><p>mqmq</p>\n<h2 id=\"3-1-\"><a href=\"#3-1-\" class=\"headerlink\" title=\"3.1 \"></a>3.1 </h2><p> RabbitMQ </p>\n<h2 id=\"3-2-\"><a href=\"#3-2-\" class=\"headerlink\" title=\"3.2 \"></a>3.2 </h2><p> RabbitMQ </p>\n<h2 id=\"3-3-\"><a href=\"#3-3-\" class=\"headerlink\" title=\"3.3 \"></a>3.3 </h2><p> Fanout Exchange</p>\n<h1 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h1><p>RabbitMQ  ChannelExchangeQueueVhostRouting Key  RabbitMQ</p>\n<p><br><a href=\"https://www.rabbitmq.com/docs/classic-queues\">RabbitMq</a></p>\n<p>Docker</p>\n"},{"title":"QUIC:","date":"2024-08-16T08:45:11.000Z","_content":"HTTPTCPTCPWeb\n\n TCP Google QUICQUICQuick UDP Internet ConnectionsGoogle2012HTTP/2QUICUDPQUICIETFQUICHTTP/3\n\n QUIC  TCP TCP  UDP  QUIC  QUIC  TCP \n\n\n# QUIC\n\nHTTP/2TCPTCP\n\n1. TCPTLS\n![](/images/http/TCP-connection-1.png)<center>()</center>\n\n2. Head-of-Line BlockingHTTP/2TCP\n\n    >HTTP\n\n![](/images/quic/head_of_line_blocking.png)<center>()</center>\n\nQUIC\n\n1. QUIC0-RTT0-RTT Resumption\n2. QUICTLS 1.3TLS\n3. QUIC\n4. QUICWi-Fi4G\n\n# QUIC\n\n1. UDPQUICUDPTCP\n \n    >  QUIC  UDP QUIC  UDP -  5\n\n2. QUIC\n\n3. QUICIPWi-Fi4G\n\n4. QUICTLS 1.3\n\n5. QUIC\n\n# TCP\n||\tTCP |\tQUIC |\n|--|--|--|\n||\tTCP|\tUDP|\n||\tTCP|\t|\n||\tTLS|\tTLS 1.3|\n||\tRTT|\t0-RTT|\n||\t |\t|\n||\t|\t|\n\n# QUIC\nQUICTLS 1.3\n![handshake](/images/quic/handshake.png)\n\n## \n\n1. ClientHello -> \n2. ServerHello -> \n3. Certificate -> \n4. Finished -> \n5.  -> QUIC\n\n## \n\n+ \n+ \n+ \n\nQUICTLS 1.3QUIC\n\n# \nQUIC\n\nTCPUDPnginxTCPQUIC\n```\nserver {\n    listen 443 ssl;\n    listen [::]:443 ssl;\n    listen 443 quic reuseport;\n    listen [::]:443 quic reuseport;\n\n    http2 on;\n    server_name itprohub.site www.itprohub.site;\n\n    ssl_certificate /etc/ssh/itprohub.site_bundle.crt;\n    ssl_certificate_key /etc/ssh/itprohub.site.key;\n\n    #  QUIC  HTTP/3 \n    #add_header Alt-Svc 'h3=\":443\"; ma=86400';  # HTTP/3 ALPN\n\n    ssl_protocols TLSv1.3;\n    ssl_prefer_server_ciphers on;\n    ssl_ciphers \"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256\";  #  TLS 1.3 \n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n\n    location / {\n        proxy_pass http://localhost:4000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n```\n\n```\nsudo tcpdump -i eth0 udp port 443 -w quic_capture.pcap\n```\nwireshark \n\nTCP\n![TCP](/images/quic/tcp.png)\n\nQUIC\n![QUIC](/images/quic/quic.png)\n\nTCPipQUICip\n\nQUIC  IP QUIC QUIC  IP  Wireshark  IP \n\nQUIC Path ValidationQUIC  Wireshark  QUIC  IP  TCP  IP \n\n# QUIC\n\n1. QUIC\n\n2. VoIPQUIC\n\n3. Wi-Fi4GQUIC\n\n4. WebHTTP/3HTTP/2WebQUICHTTP/3\n\n# QUIC\n\nQUIC\n\n1. UDPQUICUDPNATUDPQUIC\n\n2. QUICQUIC\n\n3. QUICTCP\n\n\n# \n\nQUICHTTP/3QUICWeb5GQUIC\n\nQUICTCPQUICQUIC\n\n----\n\nQUICQUIC","source":"_posts/quic.md","raw":"---\ntitle: QUIC:\ndate: 2024-08-16 16:45:11\ntags:\n---\nHTTPTCPTCPWeb\n\n TCP Google QUICQUICQuick UDP Internet ConnectionsGoogle2012HTTP/2QUICUDPQUICIETFQUICHTTP/3\n\n QUIC  TCP TCP  UDP  QUIC  QUIC  TCP \n\n\n# QUIC\n\nHTTP/2TCPTCP\n\n1. TCPTLS\n![](/images/http/TCP-connection-1.png)<center>()</center>\n\n2. Head-of-Line BlockingHTTP/2TCP\n\n    >HTTP\n\n![](/images/quic/head_of_line_blocking.png)<center>()</center>\n\nQUIC\n\n1. QUIC0-RTT0-RTT Resumption\n2. QUICTLS 1.3TLS\n3. QUIC\n4. QUICWi-Fi4G\n\n# QUIC\n\n1. UDPQUICUDPTCP\n \n    >  QUIC  UDP QUIC  UDP -  5\n\n2. QUIC\n\n3. QUICIPWi-Fi4G\n\n4. QUICTLS 1.3\n\n5. QUIC\n\n# TCP\n||\tTCP |\tQUIC |\n|--|--|--|\n||\tTCP|\tUDP|\n||\tTCP|\t|\n||\tTLS|\tTLS 1.3|\n||\tRTT|\t0-RTT|\n||\t |\t|\n||\t|\t|\n\n# QUIC\nQUICTLS 1.3\n![handshake](/images/quic/handshake.png)\n\n## \n\n1. ClientHello -> \n2. ServerHello -> \n3. Certificate -> \n4. Finished -> \n5.  -> QUIC\n\n## \n\n+ \n+ \n+ \n\nQUICTLS 1.3QUIC\n\n# \nQUIC\n\nTCPUDPnginxTCPQUIC\n```\nserver {\n    listen 443 ssl;\n    listen [::]:443 ssl;\n    listen 443 quic reuseport;\n    listen [::]:443 quic reuseport;\n\n    http2 on;\n    server_name itprohub.site www.itprohub.site;\n\n    ssl_certificate /etc/ssh/itprohub.site_bundle.crt;\n    ssl_certificate_key /etc/ssh/itprohub.site.key;\n\n    #  QUIC  HTTP/3 \n    #add_header Alt-Svc 'h3=\":443\"; ma=86400';  # HTTP/3 ALPN\n\n    ssl_protocols TLSv1.3;\n    ssl_prefer_server_ciphers on;\n    ssl_ciphers \"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256\";  #  TLS 1.3 \n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n\n    location / {\n        proxy_pass http://localhost:4000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n```\n\n```\nsudo tcpdump -i eth0 udp port 443 -w quic_capture.pcap\n```\nwireshark \n\nTCP\n![TCP](/images/quic/tcp.png)\n\nQUIC\n![QUIC](/images/quic/quic.png)\n\nTCPipQUICip\n\nQUIC  IP QUIC QUIC  IP  Wireshark  IP \n\nQUIC Path ValidationQUIC  Wireshark  QUIC  IP  TCP  IP \n\n# QUIC\n\n1. QUIC\n\n2. VoIPQUIC\n\n3. Wi-Fi4GQUIC\n\n4. WebHTTP/3HTTP/2WebQUICHTTP/3\n\n# QUIC\n\nQUIC\n\n1. UDPQUICUDPNATUDPQUIC\n\n2. QUICQUIC\n\n3. QUICTCP\n\n\n# \n\nQUICHTTP/3QUICWeb5GQUIC\n\nQUICTCPQUICQUIC\n\n----\n\nQUICQUIC","slug":"quic","published":1,"updated":"2024-08-23T02:21:47.402Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhd000iu8p125ez6mdm","content":"<p>HTTPTCPTCPWeb</p>\n<p> TCP Google QUICQUICQuick UDP Internet ConnectionsGoogle2012HTTP&#x2F;2QUICUDPQUICIETFQUICHTTP&#x2F;3</p>\n<p> QUIC  TCP TCP  UDP  QUIC  QUIC  TCP </p>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><p>HTTP&#x2F;2TCPTCP</p>\n<ol>\n<li><p>TCPTLS<br><img src=\"/images/http/TCP-connection-1.png\" alt=\"\"><center>()</center></p>\n</li>\n<li><p>Head-of-Line BlockingHTTP&#x2F;2TCP</p>\n<blockquote>\n<p>HTTP</p>\n</blockquote>\n</li>\n</ol>\n<p><img src=\"/images/quic/head_of_line_blocking.png\" alt=\"\"><center>()</center></p>\n<p>QUIC</p>\n<ol>\n<li>QUIC0-RTT0-RTT Resumption</li>\n<li>QUICTLS 1.3TLS</li>\n<li>QUIC</li>\n<li>QUICWi-Fi4G</li>\n</ol>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><ol>\n<li><p>UDPQUICUDPTCP</p>\n<blockquote>\n<p> QUIC  UDP QUIC  UDP -  5</p>\n</blockquote>\n</li>\n<li><p>QUIC</p>\n</li>\n<li><p>QUICIPWi-Fi4G</p>\n</li>\n<li><p>QUICTLS 1.3</p>\n</li>\n<li><p>QUIC</p>\n</li>\n</ol>\n<h1 id=\"TCP\"><a href=\"#TCP\" class=\"headerlink\" title=\"TCP\"></a>TCP</h1><table>\n<thead>\n<tr>\n<th></th>\n<th>TCP</th>\n<th>QUIC</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>TCP</td>\n<td>UDP</td>\n</tr>\n<tr>\n<td></td>\n<td>TCP</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>TLS</td>\n<td>TLS 1.3</td>\n</tr>\n<tr>\n<td></td>\n<td>RTT</td>\n<td>0-RTT</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><p>QUICTLS 1.3<br><img src=\"/images/quic/handshake.png\" alt=\"handshake\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>ClientHello -&gt; </li>\n<li>ServerHello -&gt; </li>\n<li>Certificate -&gt; </li>\n<li>Finished -&gt; </li>\n<li> -&gt; QUIC</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>QUICTLS 1.3QUIC</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>QUIC</p>\n<p>TCPUDPnginxTCPQUIC</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 443 ssl;</span><br><span class=\"line\">    listen [::]:443 ssl;</span><br><span class=\"line\">    listen 443 quic reuseport;</span><br><span class=\"line\">    listen [::]:443 quic reuseport;</span><br><span class=\"line\"></span><br><span class=\"line\">    http2 on;</span><br><span class=\"line\">    server_name itprohub.site www.itprohub.site;</span><br><span class=\"line\"></span><br><span class=\"line\">    ssl_certificate /etc/ssh/itprohub.site_bundle.crt;</span><br><span class=\"line\">    ssl_certificate_key /etc/ssh/itprohub.site.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    #  QUIC  HTTP/3 </span><br><span class=\"line\">    #add_header Alt-Svc &#x27;h3=&quot;:443&quot;; ma=86400&#x27;;  # HTTP/3 ALPN</span><br><span class=\"line\"></span><br><span class=\"line\">    ssl_protocols TLSv1.3;</span><br><span class=\"line\">    ssl_prefer_server_ciphers on;</span><br><span class=\"line\">    ssl_ciphers &quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;;  #  TLS 1.3 </span><br><span class=\"line\">    ssl_session_cache shared:SSL:10m;</span><br><span class=\"line\">    ssl_session_timeout 10m;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:4000;</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo tcpdump -i eth0 udp port 443 -w quic_capture.pcap</span><br></pre></td></tr></table></figure>\n<p>wireshark </p>\n<p>TCP<br><img src=\"/images/quic/tcp.png\" alt=\"TCP\"></p>\n<p>QUIC<br><img src=\"/images/quic/quic.png\" alt=\"QUIC\"></p>\n<p>TCPipQUICip</p>\n<p>QUIC  IP QUIC QUIC  IP  Wireshark  IP </p>\n<p>QUIC Path ValidationQUIC  Wireshark  QUIC  IP  TCP  IP </p>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><ol>\n<li><p>QUIC</p>\n</li>\n<li><p>VoIPQUIC</p>\n</li>\n<li><p>Wi-Fi4GQUIC</p>\n</li>\n<li><p>WebHTTP&#x2F;3HTTP&#x2F;2WebQUICHTTP&#x2F;3</p>\n</li>\n</ol>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><p>QUIC</p>\n<ol>\n<li><p>UDPQUICUDPNATUDPQUIC</p>\n</li>\n<li><p>QUICQUIC</p>\n</li>\n<li><p>QUICTCP</p>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>QUICHTTP&#x2F;3QUICWeb5GQUIC</p>\n<p>QUICTCPQUICQUIC</p>\n<hr>\n<p>QUICQUIC</p>\n","site":{"data":{}},"excerpt":"","more":"<p>HTTPTCPTCPWeb</p>\n<p> TCP Google QUICQUICQuick UDP Internet ConnectionsGoogle2012HTTP&#x2F;2QUICUDPQUICIETFQUICHTTP&#x2F;3</p>\n<p> QUIC  TCP TCP  UDP  QUIC  QUIC  TCP </p>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><p>HTTP&#x2F;2TCPTCP</p>\n<ol>\n<li><p>TCPTLS<br><img src=\"/images/http/TCP-connection-1.png\" alt=\"\"><center>()</center></p>\n</li>\n<li><p>Head-of-Line BlockingHTTP&#x2F;2TCP</p>\n<blockquote>\n<p>HTTP</p>\n</blockquote>\n</li>\n</ol>\n<p><img src=\"/images/quic/head_of_line_blocking.png\" alt=\"\"><center>()</center></p>\n<p>QUIC</p>\n<ol>\n<li>QUIC0-RTT0-RTT Resumption</li>\n<li>QUICTLS 1.3TLS</li>\n<li>QUIC</li>\n<li>QUICWi-Fi4G</li>\n</ol>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><ol>\n<li><p>UDPQUICUDPTCP</p>\n<blockquote>\n<p> QUIC  UDP QUIC  UDP -  5</p>\n</blockquote>\n</li>\n<li><p>QUIC</p>\n</li>\n<li><p>QUICIPWi-Fi4G</p>\n</li>\n<li><p>QUICTLS 1.3</p>\n</li>\n<li><p>QUIC</p>\n</li>\n</ol>\n<h1 id=\"TCP\"><a href=\"#TCP\" class=\"headerlink\" title=\"TCP\"></a>TCP</h1><table>\n<thead>\n<tr>\n<th></th>\n<th>TCP</th>\n<th>QUIC</th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>TCP</td>\n<td>UDP</td>\n</tr>\n<tr>\n<td></td>\n<td>TCP</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>TLS</td>\n<td>TLS 1.3</td>\n</tr>\n<tr>\n<td></td>\n<td>RTT</td>\n<td>0-RTT</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><p>QUICTLS 1.3<br><img src=\"/images/quic/handshake.png\" alt=\"handshake\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>ClientHello -&gt; </li>\n<li>ServerHello -&gt; </li>\n<li>Certificate -&gt; </li>\n<li>Finished -&gt; </li>\n<li> -&gt; QUIC</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>QUICTLS 1.3QUIC</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>QUIC</p>\n<p>TCPUDPnginxTCPQUIC</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 443 ssl;</span><br><span class=\"line\">    listen [::]:443 ssl;</span><br><span class=\"line\">    listen 443 quic reuseport;</span><br><span class=\"line\">    listen [::]:443 quic reuseport;</span><br><span class=\"line\"></span><br><span class=\"line\">    http2 on;</span><br><span class=\"line\">    server_name itprohub.site www.itprohub.site;</span><br><span class=\"line\"></span><br><span class=\"line\">    ssl_certificate /etc/ssh/itprohub.site_bundle.crt;</span><br><span class=\"line\">    ssl_certificate_key /etc/ssh/itprohub.site.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    #  QUIC  HTTP/3 </span><br><span class=\"line\">    #add_header Alt-Svc &#x27;h3=&quot;:443&quot;; ma=86400&#x27;;  # HTTP/3 ALPN</span><br><span class=\"line\"></span><br><span class=\"line\">    ssl_protocols TLSv1.3;</span><br><span class=\"line\">    ssl_prefer_server_ciphers on;</span><br><span class=\"line\">    ssl_ciphers &quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;;  #  TLS 1.3 </span><br><span class=\"line\">    ssl_session_cache shared:SSL:10m;</span><br><span class=\"line\">    ssl_session_timeout 10m;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:4000;</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo tcpdump -i eth0 udp port 443 -w quic_capture.pcap</span><br></pre></td></tr></table></figure>\n<p>wireshark </p>\n<p>TCP<br><img src=\"/images/quic/tcp.png\" alt=\"TCP\"></p>\n<p>QUIC<br><img src=\"/images/quic/quic.png\" alt=\"QUIC\"></p>\n<p>TCPipQUICip</p>\n<p>QUIC  IP QUIC QUIC  IP  Wireshark  IP </p>\n<p>QUIC Path ValidationQUIC  Wireshark  QUIC  IP  TCP  IP </p>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><ol>\n<li><p>QUIC</p>\n</li>\n<li><p>VoIPQUIC</p>\n</li>\n<li><p>Wi-Fi4GQUIC</p>\n</li>\n<li><p>WebHTTP&#x2F;3HTTP&#x2F;2WebQUICHTTP&#x2F;3</p>\n</li>\n</ol>\n<h1 id=\"QUIC\"><a href=\"#QUIC\" class=\"headerlink\" title=\"QUIC\"></a>QUIC</h1><p>QUIC</p>\n<ol>\n<li><p>UDPQUICUDPNATUDPQUIC</p>\n</li>\n<li><p>QUICQUIC</p>\n</li>\n<li><p>QUICTCP</p>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>QUICHTTP&#x2F;3QUICWeb5GQUIC</p>\n<p>QUICTCPQUICQUIC</p>\n<hr>\n<p>QUICQUIC</p>\n"},{"title":"JavaScript  Web ","date":"2024-10-30T08:06:01.000Z","_content":"Signals Angular  SolidPreact Web \n\n# \n DOM  React \n\n## \n\n```javascript\nimport { h } from 'preact';\nimport { signal, computed } from '@preact/signals';\nimport style from './style.css';\n\nconst username = signal('');\nconst password = signal('');\nconst message = computed(() => `${username.value} / ${password.value}`);\nconst Test = ({ user }) => {\n\tconst submitForm = () => {\n\n\t};\n\n\treturn (\n\t\t<div>\n\t\t\t<h2></h2>\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"\"\n\t\t\t\tonInput={(e) => username.value = e.target.value}\n\t\t\t/><br/>\n\t\t\t<input\n\t\t\t\ttype=\"password\"\n\t\t\t\tplaceholder=\"\"\n\t\t\t\tonInput={(e) => password.value = e.target.value}\n\t\t\t/><br/>\n\t\t\t<button onClick={submitForm}></button>\n\t\t\t<p>{message}</p>\n\t\t</div>\n\t);\n};\n\nexport default Test;\n```\npreact\n![](./images/js-signal/responsive.gif)\n\n# \n Web  JavaScript  EventTarget \n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n}\n\n\nconst signal = new Signal('Initial Value');\nconsole.log(signal.value);\nsignal.addEventListener('change', (event) => {\n    console.log(`${event.detail}`);\n});\n\nsignal.value = 'Updated Value'; // Updated Value\nsignal.value = 'Another Value'; // Another Value\n```\n EventTarget  value  change  addEventListener \n\n![](./images/js-signal/EventTarget.png)\n\n\n#  API\n Signal effect \n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n\n    effect(fn) {\n        fn();\n        this.addEventListener('change', fn);\n        return () => this.removeEventListener('change', fn);\n    }\n\n    valueOf () { return this.#value; }\n    toString () { return String(this.#value); }\n}\n```\n effect \n\n```javascript\nconst signal = new Signal('Initial Value');\nsignal.effect(() => console.log(`${signal.value}`)); \nsignal.value = 'Updated Value'; \n```\neffect  change \n![](./images/js-signal/EventTarget2.png)\n\n# \n\n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n\n    valueOf () { return this.#value; }\n    toString () { return String(this.#value); }\n}\n\n\nclass ComputedSignal extends Signal {\n    constructor(calculateFn, deps) {\n        super(calculateFn(...deps));\n        this.deps = deps;\n\n        deps.forEach(dep => {\n            dep.addEventListener('change', () => {\n                this.value = calculateFn(...deps);\n            });\n        });\n    }\n}\n\nconst name = new Signal('Thor');\nconst surname = new Signal('Odinson');\n\nconst fullName = new ComputedSignal((first, last) => `${first} ${last}`, [name, surname]);\n\nfullName.addEventListener('change', () => {\n    console.log(`${fullName.value}`);\n});\n\nname.value = 'Bruce'; // Bruce Odinson\nsurname.value = 'Banner'; // Bruce Banner\n```\nfullName  name  surname  name fullName \n![](./images/js-signal/EventTarget3.png)\n\n#  Web \n Web  UI  DOM\n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n\n    effect(fn) {\n        fn();\n        this.addEventListener('change', fn);\n        return () => this.removeEventListener('change', fn);\n    }\n}\n\ncustomElements.define('theme-switcher', class extends HTMLElement {\n    constructor() {\n        super();\n        this.darkThemeSignal = new Signal(false); // \n    }\n\n    connectedCallback() {\n        // \n        this.innerHTML = `\n            <button id=\"light\"></button>\n            <button id=\"dark\"></button>\n            <p>${this.darkThemeSignal.value ? '' : ''}</p>\n        `;\n\n        // \n        const lightButton = this.querySelector('#light');\n        const darkButton = this.querySelector('#dark');\n        const statusText = this.querySelector('p');\n\n        // \n        lightButton.addEventListener('click', () => {\n            this.darkThemeSignal.value = false; // \n        });\n\n        darkButton.addEventListener('click', () => {\n            this.darkThemeSignal.value = true; // \n        });\n\n        // \n        this.darkThemeSignal.effect(() => {\n            document.body.style.backgroundColor = this.darkThemeSignal.value ? 'black' : 'white';\n            document.body.style.color = this.darkThemeSignal.value ? 'white' : 'black';\n            statusText.textContent = `${this.darkThemeSignal.value ? '' : ''}`;\n        });\n    }\n});\n```\nWeb \n![](./images/js-signal/switch-theme.gif)\n\n# vue\nvuevue3Proxyvue2Object.definePropertyEventTarget Vue  Vue  EventTargetVue EventTarget  DOM  Vue \n\n# \n Web  JavaScript","source":"_posts/js-signal.md","raw":"---\ntitle: JavaScript  Web \ndate: 2024-10-30 16:06:01\ntags:\n---\nSignals Angular  SolidPreact Web \n\n# \n DOM  React \n\n## \n\n```javascript\nimport { h } from 'preact';\nimport { signal, computed } from '@preact/signals';\nimport style from './style.css';\n\nconst username = signal('');\nconst password = signal('');\nconst message = computed(() => `${username.value} / ${password.value}`);\nconst Test = ({ user }) => {\n\tconst submitForm = () => {\n\n\t};\n\n\treturn (\n\t\t<div>\n\t\t\t<h2></h2>\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"\"\n\t\t\t\tonInput={(e) => username.value = e.target.value}\n\t\t\t/><br/>\n\t\t\t<input\n\t\t\t\ttype=\"password\"\n\t\t\t\tplaceholder=\"\"\n\t\t\t\tonInput={(e) => password.value = e.target.value}\n\t\t\t/><br/>\n\t\t\t<button onClick={submitForm}></button>\n\t\t\t<p>{message}</p>\n\t\t</div>\n\t);\n};\n\nexport default Test;\n```\npreact\n![](./images/js-signal/responsive.gif)\n\n# \n Web  JavaScript  EventTarget \n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n}\n\n\nconst signal = new Signal('Initial Value');\nconsole.log(signal.value);\nsignal.addEventListener('change', (event) => {\n    console.log(`${event.detail}`);\n});\n\nsignal.value = 'Updated Value'; // Updated Value\nsignal.value = 'Another Value'; // Another Value\n```\n EventTarget  value  change  addEventListener \n\n![](./images/js-signal/EventTarget.png)\n\n\n#  API\n Signal effect \n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n\n    effect(fn) {\n        fn();\n        this.addEventListener('change', fn);\n        return () => this.removeEventListener('change', fn);\n    }\n\n    valueOf () { return this.#value; }\n    toString () { return String(this.#value); }\n}\n```\n effect \n\n```javascript\nconst signal = new Signal('Initial Value');\nsignal.effect(() => console.log(`${signal.value}`)); \nsignal.value = 'Updated Value'; \n```\neffect  change \n![](./images/js-signal/EventTarget2.png)\n\n# \n\n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n\n    valueOf () { return this.#value; }\n    toString () { return String(this.#value); }\n}\n\n\nclass ComputedSignal extends Signal {\n    constructor(calculateFn, deps) {\n        super(calculateFn(...deps));\n        this.deps = deps;\n\n        deps.forEach(dep => {\n            dep.addEventListener('change', () => {\n                this.value = calculateFn(...deps);\n            });\n        });\n    }\n}\n\nconst name = new Signal('Thor');\nconst surname = new Signal('Odinson');\n\nconst fullName = new ComputedSignal((first, last) => `${first} ${last}`, [name, surname]);\n\nfullName.addEventListener('change', () => {\n    console.log(`${fullName.value}`);\n});\n\nname.value = 'Bruce'; // Bruce Odinson\nsurname.value = 'Banner'; // Bruce Banner\n```\nfullName  name  surname  name fullName \n![](./images/js-signal/EventTarget3.png)\n\n#  Web \n Web  UI  DOM\n\n```javascript\nclass Signal extends EventTarget {\n    #value;\n    constructor(value) {\n        super();\n        this.#value = value;\n    }\n    get value() {\n        return this.#value;\n    }\n\n    set value(newValue) {\n        if (this.#value !== newValue) {\n            this.#value = newValue;\n            this.dispatchEvent(new CustomEvent('change', { detail: newValue }));\n        }\n    }\n\n    effect(fn) {\n        fn();\n        this.addEventListener('change', fn);\n        return () => this.removeEventListener('change', fn);\n    }\n}\n\ncustomElements.define('theme-switcher', class extends HTMLElement {\n    constructor() {\n        super();\n        this.darkThemeSignal = new Signal(false); // \n    }\n\n    connectedCallback() {\n        // \n        this.innerHTML = `\n            <button id=\"light\"></button>\n            <button id=\"dark\"></button>\n            <p>${this.darkThemeSignal.value ? '' : ''}</p>\n        `;\n\n        // \n        const lightButton = this.querySelector('#light');\n        const darkButton = this.querySelector('#dark');\n        const statusText = this.querySelector('p');\n\n        // \n        lightButton.addEventListener('click', () => {\n            this.darkThemeSignal.value = false; // \n        });\n\n        darkButton.addEventListener('click', () => {\n            this.darkThemeSignal.value = true; // \n        });\n\n        // \n        this.darkThemeSignal.effect(() => {\n            document.body.style.backgroundColor = this.darkThemeSignal.value ? 'black' : 'white';\n            document.body.style.color = this.darkThemeSignal.value ? 'white' : 'black';\n            statusText.textContent = `${this.darkThemeSignal.value ? '' : ''}`;\n        });\n    }\n});\n```\nWeb \n![](./images/js-signal/switch-theme.gif)\n\n# vue\nvuevue3Proxyvue2Object.definePropertyEventTarget Vue  Vue  EventTargetVue EventTarget  DOM  Vue \n\n# \n Web  JavaScript","slug":"js-signal","published":1,"updated":"2024-11-05T07:08:38.259Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhe000ju8p1gzq6177s","content":"<p>Signals Angular  SolidPreact Web </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> DOM  React </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; h &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;preact&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; signal, computed &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@preact/signals&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> style <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./style.css&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> username = <span class=\"title function_\">signal</span>(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> password = <span class=\"title function_\">signal</span>(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> message = <span class=\"title function_\">computed</span>(<span class=\"function\">() =&gt;</span> <span class=\"string\">`<span class=\"subst\">$&#123;username.value&#125;</span> / <span class=\"subst\">$&#123;password.value&#125;</span>`</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Test</span> = (<span class=\"params\">&#123; user &#125;</span>) =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">const</span> <span class=\"title function_\">submitForm</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> (</span><br><span class=\"line\">\t\t<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">input</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">onInput</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> username.value = e.target.value&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t/&gt;<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">input</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">type</span>=<span class=\"string\">&quot;password&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">onInput</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> password.value = e.target.value&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t/&gt;<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;submitForm&#125;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;message&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">\t);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Test</span>;</span><br></pre></td></tr></table></figure>\n<p>preact<br><img src=\"/./images/js-signal/responsive.gif\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Web  JavaScript  EventTarget </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> signal = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Initial Value&#x27;</span>);</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(signal.<span class=\"property\">value</span>);</span><br><span class=\"line\">signal.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;event.detail&#125;</span>`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">signal.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Updated Value&#x27;</span>; <span class=\"comment\">// Updated Value</span></span><br><span class=\"line\">signal.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Another Value&#x27;</span>; <span class=\"comment\">// Another Value</span></span><br></pre></td></tr></table></figure>\n<p> EventTarget  value  change  addEventListener </p>\n<p><img src=\"/./images/js-signal/EventTarget.png\" alt=\"\"><br></p>\n<h1 id=\"-API\"><a href=\"#-API\" class=\"headerlink\" title=\" API\"></a> API</h1><p> Signal effect </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">effect</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">fn</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\">() =&gt;</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">removeEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    valueOf () &#123; <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value; &#125;</span><br><span class=\"line\">    toString () &#123; <span class=\"keyword\">return</span> <span class=\"title class_\">String</span>(<span class=\"variable language_\">this</span>.#value); &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> effect </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> signal = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Initial Value&#x27;</span>);</span><br><span class=\"line\">signal.<span class=\"title function_\">effect</span>(<span class=\"function\">() =&gt;</span> <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;signal.value&#125;</span>`</span>)); </span><br><span class=\"line\">signal.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Updated Value&#x27;</span>; </span><br></pre></td></tr></table></figure>\n<p>effect  change <br><img src=\"/./images/js-signal/EventTarget2.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    valueOf () &#123; <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value; &#125;</span><br><span class=\"line\">    toString () &#123; <span class=\"keyword\">return</span> <span class=\"title class_\">String</span>(<span class=\"variable language_\">this</span>.#value); &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ComputedSignal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">Signal</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">calculateFn, deps</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>(<span class=\"title function_\">calculateFn</span>(...deps));</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">deps</span> = deps;</span><br><span class=\"line\"></span><br><span class=\"line\">        deps.<span class=\"title function_\">forEach</span>(<span class=\"function\"><span class=\"params\">dep</span> =&gt;</span> &#123;</span><br><span class=\"line\">            dep.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"title function_\">calculateFn</span>(...deps);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> name = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Thor&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> surname = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Odinson&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> fullName = <span class=\"keyword\">new</span> <span class=\"title class_\">ComputedSignal</span>(<span class=\"function\">(<span class=\"params\">first, last</span>) =&gt;</span> <span class=\"string\">`<span class=\"subst\">$&#123;first&#125;</span> <span class=\"subst\">$&#123;last&#125;</span>`</span>, [name, surname]);</span><br><span class=\"line\"></span><br><span class=\"line\">fullName.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;fullName.value&#125;</span>`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">name.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Bruce&#x27;</span>; <span class=\"comment\">// Bruce Odinson</span></span><br><span class=\"line\">surname.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Banner&#x27;</span>; <span class=\"comment\">// Bruce Banner</span></span><br></pre></td></tr></table></figure>\n<p>fullName  name  surname  name fullName <br><img src=\"/./images/js-signal/EventTarget3.png\" alt=\"\"></p>\n<h1 id=\"-Web-\"><a href=\"#-Web-\" class=\"headerlink\" title=\" Web \"></a> Web </h1><p> Web  UI  DOM</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">effect</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">fn</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\">() =&gt;</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">removeEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">customElements.<span class=\"title function_\">define</span>(<span class=\"string\">&#x27;theme-switcher&#x27;</span>, <span class=\"keyword\">class</span> <span class=\"title class_\">extends</span> <span class=\"title class_\">HTMLElement</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"literal\">false</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">connectedCallback</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">innerHTML</span> = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">            &lt;button id=&quot;light&quot;&gt;&lt;/button&gt;</span></span><br><span class=\"line\"><span class=\"string\">            &lt;button id=&quot;dark&quot;&gt;&lt;/button&gt;</span></span><br><span class=\"line\"><span class=\"string\">            &lt;p&gt;<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.darkThemeSignal.value ? <span class=\"string\">&#x27;&#x27;</span> : <span class=\"string\">&#x27;&#x27;</span>&#125;</span>&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">        `</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> lightButton = <span class=\"variable language_\">this</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;#light&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">const</span> darkButton = <span class=\"variable language_\">this</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;#dark&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">const</span> statusText = <span class=\"variable language_\">this</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;p&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        lightButton.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;click&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> = <span class=\"literal\">false</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        darkButton.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;click&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> = <span class=\"literal\">true</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"title function_\">effect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">style</span>.<span class=\"property\">backgroundColor</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> ? <span class=\"string\">&#x27;black&#x27;</span> : <span class=\"string\">&#x27;white&#x27;</span>;</span><br><span class=\"line\">            <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">style</span>.<span class=\"property\">color</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> ? <span class=\"string\">&#x27;white&#x27;</span> : <span class=\"string\">&#x27;black&#x27;</span>;</span><br><span class=\"line\">            statusText.<span class=\"property\">textContent</span> = <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.darkThemeSignal.value ? <span class=\"string\">&#x27;&#x27;</span> : <span class=\"string\">&#x27;&#x27;</span>&#125;</span>`</span>;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>Web <br><img src=\"/./images/js-signal/switch-theme.gif\" alt=\"\"></p>\n<h1 id=\"vue\"><a href=\"#vue\" class=\"headerlink\" title=\"vue\"></a>vue</h1><p>vuevue3Proxyvue2Object.definePropertyEventTarget Vue  Vue  EventTargetVue EventTarget  DOM  Vue </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Web  JavaScript</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Signals Angular  SolidPreact Web </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> DOM  React </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; h &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;preact&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; signal, computed &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@preact/signals&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> style <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./style.css&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> username = <span class=\"title function_\">signal</span>(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> password = <span class=\"title function_\">signal</span>(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> message = <span class=\"title function_\">computed</span>(<span class=\"function\">() =&gt;</span> <span class=\"string\">`<span class=\"subst\">$&#123;username.value&#125;</span> / <span class=\"subst\">$&#123;password.value&#125;</span>`</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Test</span> = (<span class=\"params\">&#123; user &#125;</span>) =&gt; &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">const</span> <span class=\"title function_\">submitForm</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> (</span><br><span class=\"line\">\t\t<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">input</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">onInput</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> username.value = e.target.value&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t/&gt;<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">input</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">type</span>=<span class=\"string\">&quot;password&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">\t\t\t\t<span class=\"attr\">onInput</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> password.value = e.target.value&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t/&gt;<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;submitForm&#125;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;message&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">\t);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">Test</span>;</span><br></pre></td></tr></table></figure>\n<p>preact<br><img src=\"/./images/js-signal/responsive.gif\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Web  JavaScript  EventTarget </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> signal = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Initial Value&#x27;</span>);</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(signal.<span class=\"property\">value</span>);</span><br><span class=\"line\">signal.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;event.detail&#125;</span>`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">signal.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Updated Value&#x27;</span>; <span class=\"comment\">// Updated Value</span></span><br><span class=\"line\">signal.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Another Value&#x27;</span>; <span class=\"comment\">// Another Value</span></span><br></pre></td></tr></table></figure>\n<p> EventTarget  value  change  addEventListener </p>\n<p><img src=\"/./images/js-signal/EventTarget.png\" alt=\"\"><br></p>\n<h1 id=\"-API\"><a href=\"#-API\" class=\"headerlink\" title=\" API\"></a> API</h1><p> Signal effect </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">effect</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">fn</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\">() =&gt;</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">removeEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    valueOf () &#123; <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value; &#125;</span><br><span class=\"line\">    toString () &#123; <span class=\"keyword\">return</span> <span class=\"title class_\">String</span>(<span class=\"variable language_\">this</span>.#value); &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> effect </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> signal = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Initial Value&#x27;</span>);</span><br><span class=\"line\">signal.<span class=\"title function_\">effect</span>(<span class=\"function\">() =&gt;</span> <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;signal.value&#125;</span>`</span>)); </span><br><span class=\"line\">signal.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Updated Value&#x27;</span>; </span><br></pre></td></tr></table></figure>\n<p>effect  change <br><img src=\"/./images/js-signal/EventTarget2.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    valueOf () &#123; <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value; &#125;</span><br><span class=\"line\">    toString () &#123; <span class=\"keyword\">return</span> <span class=\"title class_\">String</span>(<span class=\"variable language_\">this</span>.#value); &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ComputedSignal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">Signal</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">calculateFn, deps</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>(<span class=\"title function_\">calculateFn</span>(...deps));</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">deps</span> = deps;</span><br><span class=\"line\"></span><br><span class=\"line\">        deps.<span class=\"title function_\">forEach</span>(<span class=\"function\"><span class=\"params\">dep</span> =&gt;</span> &#123;</span><br><span class=\"line\">            dep.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"title function_\">calculateFn</span>(...deps);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> name = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Thor&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> surname = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"string\">&#x27;Odinson&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> fullName = <span class=\"keyword\">new</span> <span class=\"title class_\">ComputedSignal</span>(<span class=\"function\">(<span class=\"params\">first, last</span>) =&gt;</span> <span class=\"string\">`<span class=\"subst\">$&#123;first&#125;</span> <span class=\"subst\">$&#123;last&#125;</span>`</span>, [name, surname]);</span><br><span class=\"line\"></span><br><span class=\"line\">fullName.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;fullName.value&#125;</span>`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">name.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Bruce&#x27;</span>; <span class=\"comment\">// Bruce Odinson</span></span><br><span class=\"line\">surname.<span class=\"property\">value</span> = <span class=\"string\">&#x27;Banner&#x27;</span>; <span class=\"comment\">// Bruce Banner</span></span><br></pre></td></tr></table></figure>\n<p>fullName  name  surname  name fullName <br><img src=\"/./images/js-signal/EventTarget3.png\" alt=\"\"></p>\n<h1 id=\"-Web-\"><a href=\"#-Web-\" class=\"headerlink\" title=\" Web \"></a> Web </h1><p> Web  UI  DOM</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Signal</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">EventTarget</span> &#123;</span><br><span class=\"line\">    #value;</span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.#value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">get</span> <span class=\"title function_\">value</span>() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.#value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">set</span> <span class=\"title function_\">value</span>(<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.#value !== newValue) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.#value = newValue;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">dispatchEvent</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">CustomEvent</span>(<span class=\"string\">&#x27;change&#x27;</span>, &#123; <span class=\"attr\">detail</span>: newValue &#125;));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">effect</span>(<span class=\"params\">fn</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">fn</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"function\">() =&gt;</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">removeEventListener</span>(<span class=\"string\">&#x27;change&#x27;</span>, fn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">customElements.<span class=\"title function_\">define</span>(<span class=\"string\">&#x27;theme-switcher&#x27;</span>, <span class=\"keyword\">class</span> <span class=\"title class_\">extends</span> <span class=\"title class_\">HTMLElement</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">constructor</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">super</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Signal</span>(<span class=\"literal\">false</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"title function_\">connectedCallback</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">innerHTML</span> = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">            &lt;button id=&quot;light&quot;&gt;&lt;/button&gt;</span></span><br><span class=\"line\"><span class=\"string\">            &lt;button id=&quot;dark&quot;&gt;&lt;/button&gt;</span></span><br><span class=\"line\"><span class=\"string\">            &lt;p&gt;<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.darkThemeSignal.value ? <span class=\"string\">&#x27;&#x27;</span> : <span class=\"string\">&#x27;&#x27;</span>&#125;</span>&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"string\">        `</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">const</span> lightButton = <span class=\"variable language_\">this</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;#light&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">const</span> darkButton = <span class=\"variable language_\">this</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;#dark&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">const</span> statusText = <span class=\"variable language_\">this</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;p&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        lightButton.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;click&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> = <span class=\"literal\">false</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        darkButton.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;click&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> = <span class=\"literal\">true</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"title function_\">effect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">style</span>.<span class=\"property\">backgroundColor</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> ? <span class=\"string\">&#x27;black&#x27;</span> : <span class=\"string\">&#x27;white&#x27;</span>;</span><br><span class=\"line\">            <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">style</span>.<span class=\"property\">color</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">darkThemeSignal</span>.<span class=\"property\">value</span> ? <span class=\"string\">&#x27;white&#x27;</span> : <span class=\"string\">&#x27;black&#x27;</span>;</span><br><span class=\"line\">            statusText.<span class=\"property\">textContent</span> = <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.darkThemeSignal.value ? <span class=\"string\">&#x27;&#x27;</span> : <span class=\"string\">&#x27;&#x27;</span>&#125;</span>`</span>;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>Web <br><img src=\"/./images/js-signal/switch-theme.gif\" alt=\"\"></p>\n<h1 id=\"vue\"><a href=\"#vue\" class=\"headerlink\" title=\"vue\"></a>vue</h1><p>vuevue3Proxyvue2Object.definePropertyEventTarget Vue  Vue  EventTargetVue EventTarget  DOM  Vue </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Web  JavaScript</p>\n"},{"title":"RabbitMQ","date":"2024-07-11T02:36:12.000Z","_content":"\nRabbitMQ \n\n# Classic Queues\n## \n RabbitMQ \n\n## \n\n+ \n+ \n+ \n+ \n## \n\n\n\n\n# Quorum Queues\n## \n Raft \n\n## \n\n-  Raft \n- \n- \n- \n\n## \n\n- \n- \n\n## \n1. \n\nserver_initiated_close406PRECONDITION_FAILED - my-quorum-queuenon-durable\n\nQuorum  Raft  3.8.2  TTL  2\n\n2. \nmq\n\ndemo\n![](/images/rabbitmq-quarum/quarum1.png)\n\n![](/images/rabbitmq-quarum/quarum2.png)\n\n##  VS \n\n### \n Raft \n\n### \n\n\n# Stream Queues\n\n\n## \n+ \n+ \n+ \n+ \n\n## \n\n\n\n\n```CSharp\npublic void InitStreamMQ()\n{\n    var factory = new ConnectionFactory() { HostName = \"localhost\", UserName = \"user\", Password = \"myrabbit\" };\n\n    var connection = factory.CreateConnection();\n    var channel = connection.CreateModel();\n    // \n    var args = new Dictionary<string, object> { { \"x-queue-type\", \"stream\" } };\n    channel.QueueDeclare(queue: \"stream_queue\", durable: true, exclusive: false, autoDelete: false, arguments: args);\n    channel.QueueBind(queue: \"stream_queue\", exchange: \"amq.direct\", routingKey: \"stream_queue\");\n}\n\n\n[ActionTitle(Name = \"\")]\n[Route(\"subscribe\")]\npublic void SubscribeQuorumMessage()\n{\n    var factory = new ConnectionFactory() { HostName = \"localhost\", VirtualHost = \"/\", UserName = \"user\", Password = \"myrabbit\" };\n\n    var connection = factory.CreateConnection();\n    var channel = connection.CreateModel();\n\n    channel.BasicQos(prefetchSize: 0, prefetchCount: 1, global: false);\n    // \n    var consumer = new EventingBasicConsumer(channel);\n    consumer.Received += (model, ea) => {\n        var body = ea.Body.ToArray();\n        var message = Encoding.UTF8.GetString(body);\n        Console.WriteLine(\" [x] Received {0}\", message);\n    };\n\n    /**\n     * x-stream-offset\n        first: \n        last: \n        next: offset\n        Offset: \n        Timestamp:Data  Date timestamp = new Date(System.currentTimeMillis() - 60 * 60 * 1_000)\n     */\n    var args = new Dictionary<string, object> { { \"x-stream-offset\", 2 } };\n    channel.BasicConsume(queue: \"stream_queue\", autoAck: false, arguments: args, consumer: consumer);\n}\n\n```\n103(offset2).\n![offset](/images/rabbitmq-quarum/stream_offset.png)\n\n## \n Apache Kafkaoffset\n\n## \n\n+ \n+ \n\n## PS\n1. Auto-Ack  false\nautoAck false\n![aoto ack](/images/rabbitmq-quarum/stream_error2.png)\n\n2. prefetchCount\nStream Queue RabbitMQ  prefetchCount\n![prefetchCount](/images/rabbitmq-quarum/stream_error1.png)\n\n3. durabletrue\nQuorum Streamdurabletrueexclusivefalsex-max-length-bytes x-stream-max-segment-size-bytes streamstream\n\n\n# \n RabbitMQ \n\n1. \n   - \n   - \n2. \n   - \n   - \n3. \n   - \n   - \n\n# \n RabbitMQ \n\n\n[Quorum Queues](https://www.rabbitmq.com/docs/quorum-queues)","source":"_posts/rabbitmq-quorum.md","raw":"---\ntitle: RabbitMQ\ndate: 2024-07-11 10:36:12\ntags:\n---\n\nRabbitMQ \n\n# Classic Queues\n## \n RabbitMQ \n\n## \n\n+ \n+ \n+ \n+ \n## \n\n\n\n\n# Quorum Queues\n## \n Raft \n\n## \n\n-  Raft \n- \n- \n- \n\n## \n\n- \n- \n\n## \n1. \n\nserver_initiated_close406PRECONDITION_FAILED - my-quorum-queuenon-durable\n\nQuorum  Raft  3.8.2  TTL  2\n\n2. \nmq\n\ndemo\n![](/images/rabbitmq-quarum/quarum1.png)\n\n![](/images/rabbitmq-quarum/quarum2.png)\n\n##  VS \n\n### \n Raft \n\n### \n\n\n# Stream Queues\n\n\n## \n+ \n+ \n+ \n+ \n\n## \n\n\n\n\n```CSharp\npublic void InitStreamMQ()\n{\n    var factory = new ConnectionFactory() { HostName = \"localhost\", UserName = \"user\", Password = \"myrabbit\" };\n\n    var connection = factory.CreateConnection();\n    var channel = connection.CreateModel();\n    // \n    var args = new Dictionary<string, object> { { \"x-queue-type\", \"stream\" } };\n    channel.QueueDeclare(queue: \"stream_queue\", durable: true, exclusive: false, autoDelete: false, arguments: args);\n    channel.QueueBind(queue: \"stream_queue\", exchange: \"amq.direct\", routingKey: \"stream_queue\");\n}\n\n\n[ActionTitle(Name = \"\")]\n[Route(\"subscribe\")]\npublic void SubscribeQuorumMessage()\n{\n    var factory = new ConnectionFactory() { HostName = \"localhost\", VirtualHost = \"/\", UserName = \"user\", Password = \"myrabbit\" };\n\n    var connection = factory.CreateConnection();\n    var channel = connection.CreateModel();\n\n    channel.BasicQos(prefetchSize: 0, prefetchCount: 1, global: false);\n    // \n    var consumer = new EventingBasicConsumer(channel);\n    consumer.Received += (model, ea) => {\n        var body = ea.Body.ToArray();\n        var message = Encoding.UTF8.GetString(body);\n        Console.WriteLine(\" [x] Received {0}\", message);\n    };\n\n    /**\n     * x-stream-offset\n        first: \n        last: \n        next: offset\n        Offset: \n        Timestamp:Data  Date timestamp = new Date(System.currentTimeMillis() - 60 * 60 * 1_000)\n     */\n    var args = new Dictionary<string, object> { { \"x-stream-offset\", 2 } };\n    channel.BasicConsume(queue: \"stream_queue\", autoAck: false, arguments: args, consumer: consumer);\n}\n\n```\n103(offset2).\n![offset](/images/rabbitmq-quarum/stream_offset.png)\n\n## \n Apache Kafkaoffset\n\n## \n\n+ \n+ \n\n## PS\n1. Auto-Ack  false\nautoAck false\n![aoto ack](/images/rabbitmq-quarum/stream_error2.png)\n\n2. prefetchCount\nStream Queue RabbitMQ  prefetchCount\n![prefetchCount](/images/rabbitmq-quarum/stream_error1.png)\n\n3. durabletrue\nQuorum Streamdurabletrueexclusivefalsex-max-length-bytes x-stream-max-segment-size-bytes streamstream\n\n\n# \n RabbitMQ \n\n1. \n   - \n   - \n2. \n   - \n   - \n3. \n   - \n   - \n\n# \n RabbitMQ \n\n\n[Quorum Queues](https://www.rabbitmq.com/docs/quorum-queues)","slug":"rabbitmq-quorum","published":1,"updated":"2024-07-13T07:55:05.748Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhe000lu8p1elle0wu6","content":"<p>RabbitMQ </p>\n<h1 id=\"Classic-Queues\"><a href=\"#Classic-Queues\" class=\"headerlink\" title=\"Classic Queues\"></a>Classic Queues</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> RabbitMQ </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br></p>\n<h1 id=\"Quorum-Queues\"><a href=\"#Quorum-Queues\" class=\"headerlink\" title=\"Quorum Queues\"></a>Quorum Queues</h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p> Raft </p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li> Raft </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><br><br>server_initiated_close406PRECONDITION_FAILED - my-quorum-queuenon-durable</li>\n</ol>\n<p>Quorum  Raft  3.8.2  TTL  2</p>\n<ol start=\"2\">\n<li><br>mq</li>\n</ol>\n<p>demo<br><img src=\"/images/rabbitmq-quarum/quarum1.png\" alt=\"\"><br><br><img src=\"/images/rabbitmq-quarum/quarum2.png\" alt=\"\"></p>\n<h2 id=\"-VS-\"><a href=\"#-VS-\" class=\"headerlink\" title=\" VS \"></a> VS </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> Raft </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h1 id=\"Stream-Queues\"><a href=\"#Stream-Queues\" class=\"headerlink\" title=\"Stream Queues\"></a>Stream Queues</h1><p></p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">InitStreamMQ</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> factory = <span class=\"keyword\">new</span> ConnectionFactory() &#123; HostName = <span class=\"string\">&quot;localhost&quot;</span>, UserName = <span class=\"string\">&quot;user&quot;</span>, Password = <span class=\"string\">&quot;myrabbit&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> connection = factory.CreateConnection();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> channel = connection.CreateModel();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> args = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt; &#123; &#123; <span class=\"string\">&quot;x-queue-type&quot;</span>, <span class=\"string\">&quot;stream&quot;</span> &#125; &#125;;</span><br><span class=\"line\">    channel.QueueDeclare(queue: <span class=\"string\">&quot;stream_queue&quot;</span>, durable: <span class=\"literal\">true</span>, exclusive: <span class=\"literal\">false</span>, autoDelete: <span class=\"literal\">false</span>, arguments: args);</span><br><span class=\"line\">    channel.QueueBind(queue: <span class=\"string\">&quot;stream_queue&quot;</span>, exchange: <span class=\"string\">&quot;amq.direct&quot;</span>, routingKey: <span class=\"string\">&quot;stream_queue&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;subscribe&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SubscribeQuorumMessage</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> factory = <span class=\"keyword\">new</span> ConnectionFactory() &#123; HostName = <span class=\"string\">&quot;localhost&quot;</span>, VirtualHost = <span class=\"string\">&quot;/&quot;</span>, UserName = <span class=\"string\">&quot;user&quot;</span>, Password = <span class=\"string\">&quot;myrabbit&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> connection = factory.CreateConnection();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> channel = connection.CreateModel();</span><br><span class=\"line\"></span><br><span class=\"line\">    channel.BasicQos(prefetchSize: <span class=\"number\">0</span>, prefetchCount: <span class=\"number\">1</span>, <span class=\"keyword\">global</span>: <span class=\"literal\">false</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> consumer = <span class=\"keyword\">new</span> EventingBasicConsumer(channel);</span><br><span class=\"line\">    consumer.Received += (model, ea) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">        <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot; [x] Received &#123;0&#125;&quot;</span>, message);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * x-stream-offset</span></span><br><span class=\"line\"><span class=\"comment\">        first: </span></span><br><span class=\"line\"><span class=\"comment\">        last: </span></span><br><span class=\"line\"><span class=\"comment\">        next: offset</span></span><br><span class=\"line\"><span class=\"comment\">        Offset: </span></span><br><span class=\"line\"><span class=\"comment\">        Timestamp:Data  Date timestamp = new Date(System.currentTimeMillis() - 60 * 60 * 1_000)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> args = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt; &#123; &#123; <span class=\"string\">&quot;x-stream-offset&quot;</span>, <span class=\"number\">2</span> &#125; &#125;;</span><br><span class=\"line\">    channel.BasicConsume(queue: <span class=\"string\">&quot;stream_queue&quot;</span>, autoAck: <span class=\"literal\">false</span>, arguments: args, consumer: consumer);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>103(offset2).<br><img src=\"/images/rabbitmq-quarum/stream_offset.png\" alt=\"offset\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> Apache Kafkaoffset</p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"PS\"><a href=\"#PS\" class=\"headerlink\" title=\"PS\"></a>PS</h2><ol>\n<li><p>Auto-Ack  false<br>autoAck false<br><img src=\"/images/rabbitmq-quarum/stream_error2.png\" alt=\"aoto ack\"></p>\n</li>\n<li><p>prefetchCount<br>Stream Queue RabbitMQ  prefetchCount<br><img src=\"/images/rabbitmq-quarum/stream_error1.png\" alt=\"prefetchCount\"></p>\n</li>\n<li><p>durabletrue<br>Quorum Streamdurabletrueexclusivefalsex-max-length-bytes x-stream-max-segment-size-bytes streamstream</p>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> RabbitMQ </p>\n<ol>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> RabbitMQ </p>\n<p><br><a href=\"https://www.rabbitmq.com/docs/quorum-queues\">Quorum Queues</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>RabbitMQ </p>\n<h1 id=\"Classic-Queues\"><a href=\"#Classic-Queues\" class=\"headerlink\" title=\"Classic Queues\"></a>Classic Queues</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> RabbitMQ </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br></p>\n<h1 id=\"Quorum-Queues\"><a href=\"#Quorum-Queues\" class=\"headerlink\" title=\"Quorum Queues\"></a>Quorum Queues</h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p> Raft </p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li> Raft </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><br><br>server_initiated_close406PRECONDITION_FAILED - my-quorum-queuenon-durable</li>\n</ol>\n<p>Quorum  Raft  3.8.2  TTL  2</p>\n<ol start=\"2\">\n<li><br>mq</li>\n</ol>\n<p>demo<br><img src=\"/images/rabbitmq-quarum/quarum1.png\" alt=\"\"><br><br><img src=\"/images/rabbitmq-quarum/quarum2.png\" alt=\"\"></p>\n<h2 id=\"-VS-\"><a href=\"#-VS-\" class=\"headerlink\" title=\" VS \"></a> VS </h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> Raft </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h1 id=\"Stream-Queues\"><a href=\"#Stream-Queues\" class=\"headerlink\" title=\"Stream Queues\"></a>Stream Queues</h1><p></p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">InitStreamMQ</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> factory = <span class=\"keyword\">new</span> ConnectionFactory() &#123; HostName = <span class=\"string\">&quot;localhost&quot;</span>, UserName = <span class=\"string\">&quot;user&quot;</span>, Password = <span class=\"string\">&quot;myrabbit&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> connection = factory.CreateConnection();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> channel = connection.CreateModel();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> args = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt; &#123; &#123; <span class=\"string\">&quot;x-queue-type&quot;</span>, <span class=\"string\">&quot;stream&quot;</span> &#125; &#125;;</span><br><span class=\"line\">    channel.QueueDeclare(queue: <span class=\"string\">&quot;stream_queue&quot;</span>, durable: <span class=\"literal\">true</span>, exclusive: <span class=\"literal\">false</span>, autoDelete: <span class=\"literal\">false</span>, arguments: args);</span><br><span class=\"line\">    channel.QueueBind(queue: <span class=\"string\">&quot;stream_queue&quot;</span>, exchange: <span class=\"string\">&quot;amq.direct&quot;</span>, routingKey: <span class=\"string\">&quot;stream_queue&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;subscribe&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SubscribeQuorumMessage</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> factory = <span class=\"keyword\">new</span> ConnectionFactory() &#123; HostName = <span class=\"string\">&quot;localhost&quot;</span>, VirtualHost = <span class=\"string\">&quot;/&quot;</span>, UserName = <span class=\"string\">&quot;user&quot;</span>, Password = <span class=\"string\">&quot;myrabbit&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> connection = factory.CreateConnection();</span><br><span class=\"line\">    <span class=\"keyword\">var</span> channel = connection.CreateModel();</span><br><span class=\"line\"></span><br><span class=\"line\">    channel.BasicQos(prefetchSize: <span class=\"number\">0</span>, prefetchCount: <span class=\"number\">1</span>, <span class=\"keyword\">global</span>: <span class=\"literal\">false</span>);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> consumer = <span class=\"keyword\">new</span> EventingBasicConsumer(channel);</span><br><span class=\"line\">    consumer.Received += (model, ea) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> body = ea.Body.ToArray();</span><br><span class=\"line\">        <span class=\"keyword\">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot; [x] Received &#123;0&#125;&quot;</span>, message);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * x-stream-offset</span></span><br><span class=\"line\"><span class=\"comment\">        first: </span></span><br><span class=\"line\"><span class=\"comment\">        last: </span></span><br><span class=\"line\"><span class=\"comment\">        next: offset</span></span><br><span class=\"line\"><span class=\"comment\">        Offset: </span></span><br><span class=\"line\"><span class=\"comment\">        Timestamp:Data  Date timestamp = new Date(System.currentTimeMillis() - 60 * 60 * 1_000)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> args = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">object</span>&gt; &#123; &#123; <span class=\"string\">&quot;x-stream-offset&quot;</span>, <span class=\"number\">2</span> &#125; &#125;;</span><br><span class=\"line\">    channel.BasicConsume(queue: <span class=\"string\">&quot;stream_queue&quot;</span>, autoAck: <span class=\"literal\">false</span>, arguments: args, consumer: consumer);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>103(offset2).<br><img src=\"/images/rabbitmq-quarum/stream_offset.png\" alt=\"offset\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> Apache Kafkaoffset</p>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"PS\"><a href=\"#PS\" class=\"headerlink\" title=\"PS\"></a>PS</h2><ol>\n<li><p>Auto-Ack  false<br>autoAck false<br><img src=\"/images/rabbitmq-quarum/stream_error2.png\" alt=\"aoto ack\"></p>\n</li>\n<li><p>prefetchCount<br>Stream Queue RabbitMQ  prefetchCount<br><img src=\"/images/rabbitmq-quarum/stream_error1.png\" alt=\"prefetchCount\"></p>\n</li>\n<li><p>durabletrue<br>Quorum Streamdurabletrueexclusivefalsex-max-length-bytes x-stream-max-segment-size-bytes streamstream</p>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> RabbitMQ </p>\n<ol>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> RabbitMQ </p>\n<p><br><a href=\"https://www.rabbitmq.com/docs/quorum-queues\">Quorum Queues</a></p>\n"},{"title":"Redis - Redis","date":"2024-04-18T07:09:28.000Z","_content":"\n\n<img src=\"/images/redis-interview/recruitment.png\" width=\"50%\">\n\nRedis\nRedisRedis\n\nRedis[](#References)\n\n\n Redis Experts arent the only people who know what to do. Theyre the people who know what not to do. \n\n Redis \n\n\n# \n key \n\n![](/images/redis-interview/cache-penetration.png)\n\n## \n\n\n1.  key\n2.  key\n\n## \n+ \n+ \n\n## \n1. \n2.  key\n3. \n4. \n5. \n\n C# \n\n```C#\npublic class UserBll\n{\n    public static readonly int CACHE_NULL_TTL = 10;\n    public static readonly int CACHE_TTL = 20;\n    /** \n     * * \n     * @param id \n     * @ return \n     */\n    public WebUserInfo QueryUser(string key)\n    {\n        var redis = Redis.GetDatabase(0);\n        // 1.redisstore\n        String value = redis.StringGet(key);\n        WebUserInfo user = null;\n        // 2.\n        if( value.HasValue() ) {\n            user = value.FromJson<WebUserInfo>();\n            // 3.\n            return user;\n        }\n        // \n        if ( value == null) {\n            // \n            return null;\n        }\n        // 4.id\n        user = DatabaseQuery(key);\n        // 5. \n        if( user == null ) {\n            // redis\n            redis.StringSet(key, \"\", new TimeSpan(0, CACHE_NULL_TTL, 0));\n            return null;\n        }\n        // 6.redis\n        redis.StringSet(key, user.ToJson(), new TimeSpan(0, CACHE_TTL, 0));\n        // 7. \n        return user;\n}\n\n\n    public WebUserInfo DatabaseQuery(string key)\n    {\n        // \n        //  API \n        //  null\n        return null;\n    }\n\n\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        UserBll cache = new UserBll();\n\n        // \n        string result1 = cache.QueryUser(\"key1\");\n        Console.WriteLine(\"Result 1: \" + result1); // Output: Result 1: (null)\n\n        // \n        string result2 = cache.QueryUser(\"key1\");\n        Console.WriteLine(\"Result 2: \" + result2); // Output: Result 2: (null)\n\n        // \n        string result3 = cache.QueryUser(\"key2\");\n        Console.WriteLine(\"Result 3: \" + result3); // Output: Result 3: <value from database>\n    }\n}\n\n\n```\nkeyrediskeynullrediskeyredishit null\n- \n- TTL\n\nTTLnullquery\n\n# \n\n\n![Cache Avalanche](/images/redis-interview/cache-avalanche.png)\n\n## \n\n\n## \n### 1. \n\n\n### 2. \n\n\n### 3. \n\n\n### 4. \n\n\n# \nkey\n\n![](/images/redis-interview/cache-breakdown.png)\n\n1.  \n2.  \n3.  \n4.  \n\nC#\n```C#\nusing System;\nusing System.Collections.Generic;\nusing System.Threading;\n\npublic class Cache\n{\n    private Dictionary<string, string> cache = new Dictionary<string, string>();\n    private Mutex mutex = new Mutex();\n\n    public string Get(string key)\n    {\n        // \n        string value;\n        if (cache.TryGetValue(key, out value))\n        {\n            return value;\n        }\n\n        // \n        mutex.WaitOne();\n        try\n        {\n            // \n            if (cache.TryGetValue(key, out value))\n            {\n                return value;\n            }\n\n            // \n            value = QueryFromDatabase(key);\n\n            // \n            cache[key] = value;\n        }\n        finally\n        {\n            mutex.ReleaseMutex();\n        }\n\n        return value;\n    }\n\n    private string QueryFromDatabase(string key)\n    {\n        // \n        Thread.Sleep(100); // \n        return \"value for \" + key;\n    }\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        Cache cache = new Cache();\n\n        // \n        List<Thread> threads = new List<Thread>();\n        for (int i = 0; i < 10; i++)\n        {\n            Thread thread = new Thread(() =>\n            {\n                string value = cache.Get(\"key\");\n                Console.WriteLine(Thread.CurrentThread.Name + \": \" + value);\n            });\n            thread.Name = \"Thread \" + i;\n            threads.Add(thread);\n        }\n\n        foreach (Thread thread in threads)\n        {\n            thread.Start();\n        }\n\n        foreach (Thread thread in threads)\n        {\n            thread.Join();\n        }\n    }\n}\n\n```\n\n# \n<div id=\"References\"></div>\n\n+ [Redis](http://redis.io/documentation)\n+ [Redis](https://www.runoob.com/redis/redis-tutorial.html)\n\n\n...\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","source":"_posts/redis-interview-1.md","raw":"---\ntitle: Redis - Redis\ndate: 2024-04-18 15:09:28\ntags: redis  \n---\n\n\n<img src=\"/images/redis-interview/recruitment.png\" width=\"50%\">\n\nRedis\nRedisRedis\n\nRedis[](#References)\n\n\n Redis Experts arent the only people who know what to do. Theyre the people who know what not to do. \n\n Redis \n\n\n# \n key \n\n![](/images/redis-interview/cache-penetration.png)\n\n## \n\n\n1.  key\n2.  key\n\n## \n+ \n+ \n\n## \n1. \n2.  key\n3. \n4. \n5. \n\n C# \n\n```C#\npublic class UserBll\n{\n    public static readonly int CACHE_NULL_TTL = 10;\n    public static readonly int CACHE_TTL = 20;\n    /** \n     * * \n     * @param id \n     * @ return \n     */\n    public WebUserInfo QueryUser(string key)\n    {\n        var redis = Redis.GetDatabase(0);\n        // 1.redisstore\n        String value = redis.StringGet(key);\n        WebUserInfo user = null;\n        // 2.\n        if( value.HasValue() ) {\n            user = value.FromJson<WebUserInfo>();\n            // 3.\n            return user;\n        }\n        // \n        if ( value == null) {\n            // \n            return null;\n        }\n        // 4.id\n        user = DatabaseQuery(key);\n        // 5. \n        if( user == null ) {\n            // redis\n            redis.StringSet(key, \"\", new TimeSpan(0, CACHE_NULL_TTL, 0));\n            return null;\n        }\n        // 6.redis\n        redis.StringSet(key, user.ToJson(), new TimeSpan(0, CACHE_TTL, 0));\n        // 7. \n        return user;\n}\n\n\n    public WebUserInfo DatabaseQuery(string key)\n    {\n        // \n        //  API \n        //  null\n        return null;\n    }\n\n\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        UserBll cache = new UserBll();\n\n        // \n        string result1 = cache.QueryUser(\"key1\");\n        Console.WriteLine(\"Result 1: \" + result1); // Output: Result 1: (null)\n\n        // \n        string result2 = cache.QueryUser(\"key1\");\n        Console.WriteLine(\"Result 2: \" + result2); // Output: Result 2: (null)\n\n        // \n        string result3 = cache.QueryUser(\"key2\");\n        Console.WriteLine(\"Result 3: \" + result3); // Output: Result 3: <value from database>\n    }\n}\n\n\n```\nkeyrediskeynullrediskeyredishit null\n- \n- TTL\n\nTTLnullquery\n\n# \n\n\n![Cache Avalanche](/images/redis-interview/cache-avalanche.png)\n\n## \n\n\n## \n### 1. \n\n\n### 2. \n\n\n### 3. \n\n\n### 4. \n\n\n# \nkey\n\n![](/images/redis-interview/cache-breakdown.png)\n\n1.  \n2.  \n3.  \n4.  \n\nC#\n```C#\nusing System;\nusing System.Collections.Generic;\nusing System.Threading;\n\npublic class Cache\n{\n    private Dictionary<string, string> cache = new Dictionary<string, string>();\n    private Mutex mutex = new Mutex();\n\n    public string Get(string key)\n    {\n        // \n        string value;\n        if (cache.TryGetValue(key, out value))\n        {\n            return value;\n        }\n\n        // \n        mutex.WaitOne();\n        try\n        {\n            // \n            if (cache.TryGetValue(key, out value))\n            {\n                return value;\n            }\n\n            // \n            value = QueryFromDatabase(key);\n\n            // \n            cache[key] = value;\n        }\n        finally\n        {\n            mutex.ReleaseMutex();\n        }\n\n        return value;\n    }\n\n    private string QueryFromDatabase(string key)\n    {\n        // \n        Thread.Sleep(100); // \n        return \"value for \" + key;\n    }\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        Cache cache = new Cache();\n\n        // \n        List<Thread> threads = new List<Thread>();\n        for (int i = 0; i < 10; i++)\n        {\n            Thread thread = new Thread(() =>\n            {\n                string value = cache.Get(\"key\");\n                Console.WriteLine(Thread.CurrentThread.Name + \": \" + value);\n            });\n            thread.Name = \"Thread \" + i;\n            threads.Add(thread);\n        }\n\n        foreach (Thread thread in threads)\n        {\n            thread.Start();\n        }\n\n        foreach (Thread thread in threads)\n        {\n            thread.Join();\n        }\n    }\n}\n\n```\n\n# \n<div id=\"References\"></div>\n\n+ [Redis](http://redis.io/documentation)\n+ [Redis](https://www.runoob.com/redis/redis-tutorial.html)\n\n\n...\n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","slug":"redis-interview-1","published":1,"updated":"2024-04-26T03:31:26.087Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhe000nu8p14nceckxa","content":"<p></p>\n<img src=\"/images/redis-interview/recruitment.png\" width=\"50%\">\n\n<p>Redis<br>RedisRedis</p>\n<p>Redis<a href=\"#References\"></a></p>\n<p> Redis Experts arent the only people who know what to do. Theyre the people who know what not to do. </p>\n<p> Redis <br></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> key </p>\n<p><img src=\"/images/redis-interview/cache-penetration.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li> key</li>\n<li> key</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li> key</li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p> C# </p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">UserBll</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">int</span> CACHE_NULL_TTL = <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">int</span> CACHE_TTL = <span class=\"number\">20</span>;</span><br><span class=\"line\">    <span class=\"comment\">/** </span></span><br><span class=\"line\"><span class=\"comment\">     * * </span></span><br><span class=\"line\"><span class=\"comment\">     * @param id </span></span><br><span class=\"line\"><span class=\"comment\">     * @ return </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> WebUserInfo <span class=\"title\">QueryUser</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> redis = Redis.GetDatabase(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 1.redisstore</span></span><br><span class=\"line\">        String <span class=\"keyword\">value</span> = redis.StringGet(key);</span><br><span class=\"line\">        WebUserInfo user = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 2.</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( <span class=\"keyword\">value</span>.HasValue() ) &#123;</span><br><span class=\"line\">            user = <span class=\"keyword\">value</span>.FromJson&lt;WebUserInfo&gt;();</span><br><span class=\"line\">            <span class=\"comment\">// 3.</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ( <span class=\"keyword\">value</span> == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 4.id</span></span><br><span class=\"line\">        user = DatabaseQuery(key);</span><br><span class=\"line\">        <span class=\"comment\">// 5. </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( user == <span class=\"literal\">null</span> ) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// redis</span></span><br><span class=\"line\">            redis.StringSet(key, <span class=\"string\">&quot;&quot;</span>, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, CACHE_NULL_TTL, <span class=\"number\">0</span>));</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 6.redis</span></span><br><span class=\"line\">        redis.StringSet(key, user.ToJson(), <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, CACHE_TTL, <span class=\"number\">0</span>));</span><br><span class=\"line\">        <span class=\"comment\">// 7. </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> WebUserInfo <span class=\"title\">DatabaseQuery</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">//  API </span></span><br><span class=\"line\">        <span class=\"comment\">//  null</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        UserBll cache = <span class=\"keyword\">new</span> UserBll();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> result1 = cache.QueryUser(<span class=\"string\">&quot;key1&quot;</span>);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Result 1: &quot;</span> + result1); <span class=\"comment\">// Output: Result 1: (null)</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> result2 = cache.QueryUser(<span class=\"string\">&quot;key1&quot;</span>);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Result 2: &quot;</span> + result2); <span class=\"comment\">// Output: Result 2: (null)</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> result3 = cache.QueryUser(<span class=\"string\">&quot;key2&quot;</span>);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Result 3: &quot;</span> + result3); <span class=\"comment\">// Output: Result 3: &lt;value from database&gt;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>keyrediskeynullrediskeyredishit null</p>\n<ul>\n<li></li>\n<li>TTL</li>\n</ul>\n<p>TTLnullquery</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p><img src=\"/images/redis-interview/cache-avalanche.png\" alt=\"Cache Avalanche\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><p></p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><p></p>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><p></p>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>key</p>\n<p><img src=\"/images/redis-interview/cache-breakdown.png\" alt=\"\"></p>\n<ol>\n<li> </li>\n<li> </li>\n<li> </li>\n<li> </li>\n</ol>\n<p>C#</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Cache</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt; cache = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Mutex mutex = <span class=\"keyword\">new</span> Mutex();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">string</span> <span class=\"title\">Get</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cache.TryGetValue(key, <span class=\"keyword\">out</span> <span class=\"keyword\">value</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        mutex.WaitOne();</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cache.TryGetValue(key, <span class=\"keyword\">out</span> <span class=\"keyword\">value</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">value</span> = QueryFromDatabase(key);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            cache[key] = <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">finally</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            mutex.ReleaseMutex();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">string</span> <span class=\"title\">QueryFromDatabase</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Thread.Sleep(<span class=\"number\">100</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;value for &quot;</span> + key;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Cache cache = <span class=\"keyword\">new</span> Cache();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        List&lt;Thread&gt; threads = <span class=\"keyword\">new</span> List&lt;Thread&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Thread thread = <span class=\"keyword\">new</span> Thread(() =&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">string</span> <span class=\"keyword\">value</span> = cache.Get(<span class=\"string\">&quot;key&quot;</span>);</span><br><span class=\"line\">                Console.WriteLine(Thread.CurrentThread.Name + <span class=\"string\">&quot;: &quot;</span> + <span class=\"keyword\">value</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            thread.Name = <span class=\"string\">&quot;Thread &quot;</span> + i;</span><br><span class=\"line\">            threads.Add(thread);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span> (Thread thread <span class=\"keyword\">in</span> threads)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            thread.Start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span> (Thread thread <span class=\"keyword\">in</span> threads)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            thread.Join();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><div id=\"References\"></div>\n\n<ul>\n<li><a href=\"http://redis.io/documentation\">Redis</a></li>\n<li><a href=\"https://www.runoob.com/redis/redis-tutorial.html\">Redis</a></li>\n</ul>\n<p></p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p></p>\n<img src=\"/images/redis-interview/recruitment.png\" width=\"50%\">\n\n<p>Redis<br>RedisRedis</p>\n<p>Redis<a href=\"#References\"></a></p>\n<p> Redis Experts arent the only people who know what to do. Theyre the people who know what not to do. </p>\n<p> Redis <br></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> key </p>\n<p><img src=\"/images/redis-interview/cache-penetration.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li> key</li>\n<li> key</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li> key</li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p> C# </p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">UserBll</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">int</span> CACHE_NULL_TTL = <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">int</span> CACHE_TTL = <span class=\"number\">20</span>;</span><br><span class=\"line\">    <span class=\"comment\">/** </span></span><br><span class=\"line\"><span class=\"comment\">     * * </span></span><br><span class=\"line\"><span class=\"comment\">     * @param id </span></span><br><span class=\"line\"><span class=\"comment\">     * @ return </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> WebUserInfo <span class=\"title\">QueryUser</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> redis = Redis.GetDatabase(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 1.redisstore</span></span><br><span class=\"line\">        String <span class=\"keyword\">value</span> = redis.StringGet(key);</span><br><span class=\"line\">        WebUserInfo user = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 2.</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( <span class=\"keyword\">value</span>.HasValue() ) &#123;</span><br><span class=\"line\">            user = <span class=\"keyword\">value</span>.FromJson&lt;WebUserInfo&gt;();</span><br><span class=\"line\">            <span class=\"comment\">// 3.</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ( <span class=\"keyword\">value</span> == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 4.id</span></span><br><span class=\"line\">        user = DatabaseQuery(key);</span><br><span class=\"line\">        <span class=\"comment\">// 5. </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( user == <span class=\"literal\">null</span> ) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// redis</span></span><br><span class=\"line\">            redis.StringSet(key, <span class=\"string\">&quot;&quot;</span>, <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, CACHE_NULL_TTL, <span class=\"number\">0</span>));</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 6.redis</span></span><br><span class=\"line\">        redis.StringSet(key, user.ToJson(), <span class=\"keyword\">new</span> TimeSpan(<span class=\"number\">0</span>, CACHE_TTL, <span class=\"number\">0</span>));</span><br><span class=\"line\">        <span class=\"comment\">// 7. </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> WebUserInfo <span class=\"title\">DatabaseQuery</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">//  API </span></span><br><span class=\"line\">        <span class=\"comment\">//  null</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        UserBll cache = <span class=\"keyword\">new</span> UserBll();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> result1 = cache.QueryUser(<span class=\"string\">&quot;key1&quot;</span>);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Result 1: &quot;</span> + result1); <span class=\"comment\">// Output: Result 1: (null)</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> result2 = cache.QueryUser(<span class=\"string\">&quot;key1&quot;</span>);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Result 2: &quot;</span> + result2); <span class=\"comment\">// Output: Result 2: (null)</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> result3 = cache.QueryUser(<span class=\"string\">&quot;key2&quot;</span>);</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Result 3: &quot;</span> + result3); <span class=\"comment\">// Output: Result 3: &lt;value from database&gt;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>keyrediskeynullrediskeyredishit null</p>\n<ul>\n<li></li>\n<li>TTL</li>\n</ul>\n<p>TTLnullquery</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p><img src=\"/images/redis-interview/cache-avalanche.png\" alt=\"Cache Avalanche\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><p></p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><p></p>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><p></p>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>key</p>\n<p><img src=\"/images/redis-interview/cache-breakdown.png\" alt=\"\"></p>\n<ol>\n<li> </li>\n<li> </li>\n<li> </li>\n<li> </li>\n</ol>\n<p>C#</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Cache</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt; cache = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Mutex mutex = <span class=\"keyword\">new</span> Mutex();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">string</span> <span class=\"title\">Get</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"built_in\">string</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (cache.TryGetValue(key, <span class=\"keyword\">out</span> <span class=\"keyword\">value</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        mutex.WaitOne();</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cache.TryGetValue(key, <span class=\"keyword\">out</span> <span class=\"keyword\">value</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">value</span> = QueryFromDatabase(key);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            cache[key] = <span class=\"keyword\">value</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">finally</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            mutex.ReleaseMutex();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">string</span> <span class=\"title\">QueryFromDatabase</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Thread.Sleep(<span class=\"number\">100</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;value for &quot;</span> + key;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Cache cache = <span class=\"keyword\">new</span> Cache();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        List&lt;Thread&gt; threads = <span class=\"keyword\">new</span> List&lt;Thread&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Thread thread = <span class=\"keyword\">new</span> Thread(() =&gt;</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">string</span> <span class=\"keyword\">value</span> = cache.Get(<span class=\"string\">&quot;key&quot;</span>);</span><br><span class=\"line\">                Console.WriteLine(Thread.CurrentThread.Name + <span class=\"string\">&quot;: &quot;</span> + <span class=\"keyword\">value</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            thread.Name = <span class=\"string\">&quot;Thread &quot;</span> + i;</span><br><span class=\"line\">            threads.Add(thread);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span> (Thread thread <span class=\"keyword\">in</span> threads)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            thread.Start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span> (Thread thread <span class=\"keyword\">in</span> threads)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            thread.Join();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><div id=\"References\"></div>\n\n<ul>\n<li><a href=\"http://redis.io/documentation\">Redis</a></li>\n<li><a href=\"https://www.runoob.com/redis/redis-tutorial.html\">Redis</a></li>\n</ul>\n<p></p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n"},{"title":" HTTP Connection ","date":"2024-03-19T08:11:52.000Z","_content":"HTTP Connection  HTTP  HTTP Connection \n\nHTTP[](https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE#)\n\n\n## \nHTTP ConnectionConnection  TCP  HTTP //\n\n### \n```http request\nConnection: keep-alive\nConnection: close\n```\n\nHTTP Connection\n\n+ keep-alive HTTP 1.1 HTTP 1.0\n+ close HTTP 1.0  HTTP 1.1 \n\nHttp1.1 Keep-Alive Header Connection: Keep-AliveConnection: Keep-Alive Keep-Alive HTTP \n\n__\n![handshake](/images/http/perisitent-connection.png)\n\n\n## Keep-Alive\nkeep-alive \n### \n\n1.  \n2.  \n3.  \n\n### \n1.  \n2.  \n\n## \n###  Keep-Alive Timeout \nkeep-aliveApache\nKeep-Alive WEB \n```http request\nKeep-Alive:timeout=5\n```\n<font color=\"#dd0000\">Mozilla  Konquor  Keep-AliveTimeout=Time  MSIE  60 </font>\n\n###  Connection close \n Response Header Connection close\n\n close  close \n\n\n## \nkeep-alive\n\n+ \n```\n[HttpGet]\n[ActionTitle(Name = \"\")]\n[Route(\"close.svc\")]\npublic void Close()\n{\n    Response.Headers.Connection = \"close\";\n    return;\n}\n```\n![](/images/http/handshake-2.png)\nstart\n\ncloseconnection: close4\n\n+ (Mozilla)\n```C#\n[HttpGet]\n[ActionTitle(Name = \"\")]\n[Route(\"start.svc\")]\npublic void Start()\n{\n    Response.Headers.KeepAlive = \"timeout=10, max=3\";\n    return;\n}\n```\n  ![](/images/http/timeout-auto-disconnect.png)\n10s10s\n\n\n+ \n![](/images/http/auto-disconnect.png)\n\n\n****\n+ 10.21.21.6ip  Keep-Alive \n+  Keep-Alive ACK\n+   Keep-Alive  Keep-Alive ACK Seq  Ack \n+  5min  FIN ACK   \n\n****\n+  TCP  Keep-Alive  ACK \n+ \n\n## TCP  Keep-Alive \n> + TCP Keep-Alive  TCP  LinuxWindowsMacOS  \n> + TCP Keep-Alive HTTPTCP \n> + WindowsTCP Keep-Alive\n\nTCP Keep-Alive\n1. TCP Keep-AliveWindowsnetshTCP Keep-Alive\n2. Keep-AliveJavaHttpURLConnectionC#HttpClientTCPKeep-Alive\n3. HTTPKeep-AliveHTTP/1.1Keep-AliveHTTP\n4. TCPKeep-Alive\n\n## \nHTTP Connection  HTTP  HTTP Connection  HTTP Connection \n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","source":"_posts/http.md","raw":"---\ntitle:  HTTP Connection \ndate: 2024-03-19 16:11:52\ntags: http http Connection\n---\nHTTP Connection  HTTP  HTTP Connection \n\nHTTP[](https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE#)\n\n\n## \nHTTP ConnectionConnection  TCP  HTTP //\n\n### \n```http request\nConnection: keep-alive\nConnection: close\n```\n\nHTTP Connection\n\n+ keep-alive HTTP 1.1 HTTP 1.0\n+ close HTTP 1.0  HTTP 1.1 \n\nHttp1.1 Keep-Alive Header Connection: Keep-AliveConnection: Keep-Alive Keep-Alive HTTP \n\n__\n![handshake](/images/http/perisitent-connection.png)\n\n\n## Keep-Alive\nkeep-alive \n### \n\n1.  \n2.  \n3.  \n\n### \n1.  \n2.  \n\n## \n###  Keep-Alive Timeout \nkeep-aliveApache\nKeep-Alive WEB \n```http request\nKeep-Alive:timeout=5\n```\n<font color=\"#dd0000\">Mozilla  Konquor  Keep-AliveTimeout=Time  MSIE  60 </font>\n\n###  Connection close \n Response Header Connection close\n\n close  close \n\n\n## \nkeep-alive\n\n+ \n```\n[HttpGet]\n[ActionTitle(Name = \"\")]\n[Route(\"close.svc\")]\npublic void Close()\n{\n    Response.Headers.Connection = \"close\";\n    return;\n}\n```\n![](/images/http/handshake-2.png)\nstart\n\ncloseconnection: close4\n\n+ (Mozilla)\n```C#\n[HttpGet]\n[ActionTitle(Name = \"\")]\n[Route(\"start.svc\")]\npublic void Start()\n{\n    Response.Headers.KeepAlive = \"timeout=10, max=3\";\n    return;\n}\n```\n  ![](/images/http/timeout-auto-disconnect.png)\n10s10s\n\n\n+ \n![](/images/http/auto-disconnect.png)\n\n\n****\n+ 10.21.21.6ip  Keep-Alive \n+  Keep-Alive ACK\n+   Keep-Alive  Keep-Alive ACK Seq  Ack \n+  5min  FIN ACK   \n\n****\n+  TCP  Keep-Alive  ACK \n+ \n\n## TCP  Keep-Alive \n> + TCP Keep-Alive  TCP  LinuxWindowsMacOS  \n> + TCP Keep-Alive HTTPTCP \n> + WindowsTCP Keep-Alive\n\nTCP Keep-Alive\n1. TCP Keep-AliveWindowsnetshTCP Keep-Alive\n2. Keep-AliveJavaHttpURLConnectionC#HttpClientTCPKeep-Alive\n3. HTTPKeep-AliveHTTP/1.1Keep-AliveHTTP\n4. TCPKeep-Alive\n\n## \nHTTP Connection  HTTP  HTTP Connection  HTTP Connection \n\n\n[ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)\n\n![ITProHub](https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg)","slug":"http","published":1,"updated":"2024-04-26T03:06:44.259Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhf000ou8p19gpwhfmw","content":"<p>HTTP Connection  HTTP  HTTP Connection </p>\n<p>HTTP<a href=\"https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE#\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTTP ConnectionConnection  TCP  HTTP &#x2F;&#x2F;</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight http\"><figcaption><span>request</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">Connection</span><span class=\"punctuation\">: </span>keep-alive</span><br><span class=\"line\"><span class=\"attribute\">Connection</span><span class=\"punctuation\">: </span>close</span><br></pre></td></tr></table></figure>\n\n<p>HTTP Connection</p>\n<ul>\n<li>keep-alive HTTP 1.1 HTTP 1.0</li>\n<li>close HTTP 1.0  HTTP 1.1 </li>\n</ul>\n<p>Http1.1 Keep-Alive Header Connection: Keep-AliveConnection: Keep-Alive Keep-Alive HTTP </p>\n<p><em></em><br><img src=\"/images/http/perisitent-connection.png\" alt=\"handshake\"></p>\n<h2 id=\"Keep-Alive\"><a href=\"#Keep-Alive\" class=\"headerlink\" title=\"Keep-Alive\"></a>Keep-Alive</h2><p>keep-alive </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li> </li>\n<li> </li>\n<li> </li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li> </li>\n<li> </li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-Keep-Alive-Timeout-\"><a href=\"#-Keep-Alive-Timeout-\" class=\"headerlink\" title=\" Keep-Alive Timeout \"></a> Keep-Alive Timeout </h3><p>keep-aliveApache<br>Keep-Alive WEB </p>\n<figure class=\"highlight http\"><figcaption><span>request</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Keep-Alive:timeout=5</span><br></pre></td></tr></table></figure>\n<p><font color=\"#dd0000\">Mozilla  Konquor  Keep-AliveTimeout&#x3D;Time  MSIE  60 </font></p>\n<h3 id=\"-Connection-close-\"><a href=\"#-Connection-close-\" class=\"headerlink\" title=\" Connection close \"></a> Connection close </h3><p> Response Header Connection close</p>\n<p> close  close </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>keep-alive</p>\n<ul>\n<li><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[HttpGet]</span><br><span class=\"line\">[ActionTitle(Name = &quot;&quot;)]</span><br><span class=\"line\">[Route(&quot;close.svc&quot;)]</span><br><span class=\"line\">public void Close()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Response.Headers.Connection = &quot;close&quot;;</span><br><span class=\"line\">    return;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<img src=\"/images/http/handshake-2.png\" alt=\"\"><br>start</li>\n</ul>\n<p>closeconnection: close4</p>\n<ul>\n<li><p>(Mozilla)</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;start.svc&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Start</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Response.Headers.KeepAlive = <span class=\"string\">&quot;timeout=10, max=3&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/http/timeout-auto-disconnect.png\" alt=\"\"><br>10s10s</p>\n</li>\n<li><p><br><img src=\"/images/http/auto-disconnect.png\" alt=\"\"><br></p>\n</li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li>10.21.21.6ip  Keep-Alive </li>\n<li> Keep-Alive ACK</li>\n<li>  Keep-Alive  Keep-Alive ACK Seq  Ack </li>\n<li> 5min  FIN ACK   </li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li> TCP  Keep-Alive  ACK </li>\n<li></li>\n</ul>\n<h2 id=\"TCP-Keep-Alive-\"><a href=\"#TCP-Keep-Alive-\" class=\"headerlink\" title=\"TCP  Keep-Alive \"></a>TCP  Keep-Alive </h2><blockquote>\n<ul>\n<li>TCP Keep-Alive  TCP  LinuxWindowsMacOS  </li>\n<li>TCP Keep-Alive HTTPTCP </li>\n<li>WindowsTCP Keep-Alive</li>\n</ul>\n</blockquote>\n<p>TCP Keep-Alive</p>\n<ol>\n<li>TCP Keep-AliveWindowsnetshTCP Keep-Alive</li>\n<li>Keep-AliveJavaHttpURLConnectionC#HttpClientTCPKeep-Alive</li>\n<li>HTTPKeep-AliveHTTP&#x2F;1.1Keep-AliveHTTP</li>\n<li>TCPKeep-Alive</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTTP Connection  HTTP  HTTP Connection  HTTP Connection </p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>HTTP Connection  HTTP  HTTP Connection </p>\n<p>HTTP<a href=\"https://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE#\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTTP ConnectionConnection  TCP  HTTP &#x2F;&#x2F;</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight http\"><figcaption><span>request</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">Connection</span><span class=\"punctuation\">: </span>keep-alive</span><br><span class=\"line\"><span class=\"attribute\">Connection</span><span class=\"punctuation\">: </span>close</span><br></pre></td></tr></table></figure>\n\n<p>HTTP Connection</p>\n<ul>\n<li>keep-alive HTTP 1.1 HTTP 1.0</li>\n<li>close HTTP 1.0  HTTP 1.1 </li>\n</ul>\n<p>Http1.1 Keep-Alive Header Connection: Keep-AliveConnection: Keep-Alive Keep-Alive HTTP </p>\n<p><em></em><br><img src=\"/images/http/perisitent-connection.png\" alt=\"handshake\"></p>\n<h2 id=\"Keep-Alive\"><a href=\"#Keep-Alive\" class=\"headerlink\" title=\"Keep-Alive\"></a>Keep-Alive</h2><p>keep-alive </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li> </li>\n<li> </li>\n<li> </li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li> </li>\n<li> </li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-Keep-Alive-Timeout-\"><a href=\"#-Keep-Alive-Timeout-\" class=\"headerlink\" title=\" Keep-Alive Timeout \"></a> Keep-Alive Timeout </h3><p>keep-aliveApache<br>Keep-Alive WEB </p>\n<figure class=\"highlight http\"><figcaption><span>request</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Keep-Alive:timeout=5</span><br></pre></td></tr></table></figure>\n<p><font color=\"#dd0000\">Mozilla  Konquor  Keep-AliveTimeout&#x3D;Time  MSIE  60 </font></p>\n<h3 id=\"-Connection-close-\"><a href=\"#-Connection-close-\" class=\"headerlink\" title=\" Connection close \"></a> Connection close </h3><p> Response Header Connection close</p>\n<p> close  close </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>keep-alive</p>\n<ul>\n<li><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[HttpGet]</span><br><span class=\"line\">[ActionTitle(Name = &quot;&quot;)]</span><br><span class=\"line\">[Route(&quot;close.svc&quot;)]</span><br><span class=\"line\">public void Close()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Response.Headers.Connection = &quot;close&quot;;</span><br><span class=\"line\">    return;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<img src=\"/images/http/handshake-2.png\" alt=\"\"><br>start</li>\n</ul>\n<p>closeconnection: close4</p>\n<ul>\n<li><p>(Mozilla)</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"meta\">HttpGet</span>]</span><br><span class=\"line\">[<span class=\"meta\">ActionTitle(Name = <span class=\"string\">&quot;&quot;</span>)</span>]</span><br><span class=\"line\">[<span class=\"meta\">Route(<span class=\"string\">&quot;start.svc&quot;</span>)</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Start</span>()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Response.Headers.KeepAlive = <span class=\"string\">&quot;timeout=10, max=3&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/http/timeout-auto-disconnect.png\" alt=\"\"><br>10s10s</p>\n</li>\n<li><p><br><img src=\"/images/http/auto-disconnect.png\" alt=\"\"><br></p>\n</li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li>10.21.21.6ip  Keep-Alive </li>\n<li> Keep-Alive ACK</li>\n<li>  Keep-Alive  Keep-Alive ACK Seq  Ack </li>\n<li> 5min  FIN ACK   </li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li> TCP  Keep-Alive  ACK </li>\n<li></li>\n</ul>\n<h2 id=\"TCP-Keep-Alive-\"><a href=\"#TCP-Keep-Alive-\" class=\"headerlink\" title=\"TCP  Keep-Alive \"></a>TCP  Keep-Alive </h2><blockquote>\n<ul>\n<li>TCP Keep-Alive  TCP  LinuxWindowsMacOS  </li>\n<li>TCP Keep-Alive HTTPTCP </li>\n<li>WindowsTCP Keep-Alive</li>\n</ul>\n</blockquote>\n<p>TCP Keep-Alive</p>\n<ol>\n<li>TCP Keep-AliveWindowsnetshTCP Keep-Alive</li>\n<li>Keep-AliveJavaHttpURLConnectionC#HttpClientTCPKeep-Alive</li>\n<li>HTTPKeep-AliveHTTP&#x2F;1.1Keep-AliveHTTP</li>\n<li>TCPKeep-Alive</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTTP Connection  HTTP  HTTP Connection  HTTP Connection </p>\n<p><a href=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\">ITProHub</a></p>\n<p><img src=\"https://myom-dev.oss-cn-hangzhou.aliyuncs.com/WechatPublicPlatformQrCode.jpg\" alt=\"ITProHub\"></p>\n"},{"title":" TCP ","date":"2024-08-28T07:04:04.000Z","_content":"TCP  TCP  TCP \n\n#  TCP \n\nTCP  TCP  TCP \n\n \"Hello\"  \"World\" \"HelloWorld\" \"Hello\"  \"World\" \n\n# TCP \n\n TCP  TCP \n\n1. TCP TCP  TCP \n\n2. Nagle Nagle \n\n3.  TCP TCP \n\n#  TCP \n\n\n\n1. \n\n2.  \\n\n\n3. \n\n## HTTP\nHTTPTCPHTTP\n\nHTTPTCPTCPHTTP\n\n### \n\n+ Content-Length \n    > HTTP Content-Length \n\n+ Chunked Transfer-Encoding\n    > HTTP/1.1Chunked Transfer-Encoding0    \n\n\n# \n\n\n## \n\n\n```C#\nstatic void Main(string[] args)\n{\n    TcpListener listener = new TcpListener(IPAddress.Any, 8888);\n    listener.Start();\n    Console.WriteLine(\"Server Start...\");\n\n    using( TcpClient client = listener.AcceptTcpClient() )\n    using( NetworkStream stream = client.GetStream() ) {\n        byte[] buffer = new byte[1024];\n        int bytesRead = stream.Read(buffer, 0, buffer.Length);\n        string receivedData = Encoding.UTF8.GetString(buffer, 0, bytesRead);\n\n        Console.WriteLine(\"Received Data:\\r\\n \" + receivedData);\n    }\n    listener.Stop();\n\n    Console.ReadLine();\n}\n```\n\n```C#\nstatic void Main(string[] args)\n{\n    using( TcpClient client = new TcpClient(\"127.0.0.1\", 8888) )\n    using( NetworkStream stream = client.GetStream() ) {\n        string[] messages = { \"Message 1\\r\\n\", \"Message 2\\r\\n\", \"Message 3\\r\\n\" };\n\n        foreach( var msg in messages ) {\n            byte[] data = Encoding.UTF8.GetBytes(msg);\n            stream.Write(data, 0, data.Length);\n        }\n\n        Console.WriteLine(\"Messages sent.\");\n    }\n\n    Console.ReadLine();\n}\n```\n\n![](/images/sticky-packet/sender-sticky.png)\n Message 1Message 2Message 3TCP\n\n### \n\n```C#\n static void Main(string[] args)\n {\n     using( TcpClient client = new TcpClient(\"127.0.0.1\", 8888) )\n     using( NetworkStream stream = client.GetStream() ) {\n         string[] messages = { \"Message 1\", \"Message 2\", \"Message 3\" };\n\n         foreach( var msg in messages ) {\n             byte[] messageData = Encoding.UTF8.GetBytes(msg);\n             byte[] lengthPrefix = BitConverter.GetBytes(messageData.Length);\n\n             // \n             stream.Write(lengthPrefix, 0, lengthPrefix.Length);\n             // \n             stream.Write(messageData, 0, messageData.Length);\n         }\n\n         Console.ReadLine();\n     }\n }\n```\n\n![](/images/sticky-packet/solve-sender-sticky.png)\n\n\n## \n:\n```C#\nstatic void Main(string[] args)\n{\n    TcpListener listener = new TcpListener(IPAddress.Any, 8888);\n    listener.Start();\n    Console.WriteLine(\"Server Start...\");\n\n    using( TcpClient client = listener.AcceptTcpClient() )\n    using( NetworkStream stream = client.GetStream() ) {\n        byte[] buffer = new byte[20]; // \n\n        int bytesRead;\n        while( (bytesRead = stream.Read(buffer, 0, buffer.Length)) > 0 ) {\n            string part = Encoding.UTF8.GetString(buffer, 0, bytesRead);\n            Console.WriteLine(\"Receive: \" + part );\n\n            if( bytesRead < buffer.Length )\n                break; // \n        }\n\n    }\n\n    listener.Stop();\n    Console.ReadLine();\n}\n```\n:\n```C#\nstatic void Main(string[] args)\n{\n    using( TcpClient client = new TcpClient(\"127.0.0.1\", 8888) )\n    using( NetworkStream stream = client.GetStream() ) {\n        string message = \"This is a longer message that may be split across multiple packets.\";\n        byte[] data = Encoding.UTF8.GetBytes(message);\n        stream.Write(data, 0, data.Length);\n\n        Console.WriteLine(\"Message sent.\");\n    }\n    Console.ReadLine();\n}\n```\n\n\n![](/images/sticky-packet/server-sticky.png)\n\n### \n\n\n```C#\nstatic void Main(string[] args)\n{\n    TcpListener listener = new TcpListener(IPAddress.Any, 8888);\n    listener.Start();\n    Console.WriteLine(\"Server start... \");\n    using( TcpClient client = listener.AcceptTcpClient() )\n    using( NetworkStream stream = client.GetStream() ) {\n        byte[] buffer = new byte[20];\n        StringBuilder completeMessage = new StringBuilder();\n\n        int bytesRead;\n        while( (bytesRead = stream.Read(buffer, 0, buffer.Length)) > 0 ) {\n            // \n            string part = Encoding.UTF8.GetString(buffer, 0, bytesRead);\n            completeMessage.Append(part);\n\n            // \n            if( completeMessage.ToString().Contains(\"...\") ) // \n            {\n                break;\n            }\n        }\n        Console.WriteLine(\"Complete Message: \" + completeMessage.ToString());\n    }\n\n    listener.Stop();\n    Console.ReadLine();\n}\n```\n\n![](/images/sticky-packet/solve-server-sticky.png)\n\n# \n\nTCP  TCP \n\n TCP ","source":"_posts/sticky-packet.md","raw":"---\ntitle:  TCP \ndate: 2024-08-28 15:04:04\ntags:\n---\nTCP  TCP  TCP \n\n#  TCP \n\nTCP  TCP  TCP \n\n \"Hello\"  \"World\" \"HelloWorld\" \"Hello\"  \"World\" \n\n# TCP \n\n TCP  TCP \n\n1. TCP TCP  TCP \n\n2. Nagle Nagle \n\n3.  TCP TCP \n\n#  TCP \n\n\n\n1. \n\n2.  \\n\n\n3. \n\n## HTTP\nHTTPTCPHTTP\n\nHTTPTCPTCPHTTP\n\n### \n\n+ Content-Length \n    > HTTP Content-Length \n\n+ Chunked Transfer-Encoding\n    > HTTP/1.1Chunked Transfer-Encoding0    \n\n\n# \n\n\n## \n\n\n```C#\nstatic void Main(string[] args)\n{\n    TcpListener listener = new TcpListener(IPAddress.Any, 8888);\n    listener.Start();\n    Console.WriteLine(\"Server Start...\");\n\n    using( TcpClient client = listener.AcceptTcpClient() )\n    using( NetworkStream stream = client.GetStream() ) {\n        byte[] buffer = new byte[1024];\n        int bytesRead = stream.Read(buffer, 0, buffer.Length);\n        string receivedData = Encoding.UTF8.GetString(buffer, 0, bytesRead);\n\n        Console.WriteLine(\"Received Data:\\r\\n \" + receivedData);\n    }\n    listener.Stop();\n\n    Console.ReadLine();\n}\n```\n\n```C#\nstatic void Main(string[] args)\n{\n    using( TcpClient client = new TcpClient(\"127.0.0.1\", 8888) )\n    using( NetworkStream stream = client.GetStream() ) {\n        string[] messages = { \"Message 1\\r\\n\", \"Message 2\\r\\n\", \"Message 3\\r\\n\" };\n\n        foreach( var msg in messages ) {\n            byte[] data = Encoding.UTF8.GetBytes(msg);\n            stream.Write(data, 0, data.Length);\n        }\n\n        Console.WriteLine(\"Messages sent.\");\n    }\n\n    Console.ReadLine();\n}\n```\n\n![](/images/sticky-packet/sender-sticky.png)\n Message 1Message 2Message 3TCP\n\n### \n\n```C#\n static void Main(string[] args)\n {\n     using( TcpClient client = new TcpClient(\"127.0.0.1\", 8888) )\n     using( NetworkStream stream = client.GetStream() ) {\n         string[] messages = { \"Message 1\", \"Message 2\", \"Message 3\" };\n\n         foreach( var msg in messages ) {\n             byte[] messageData = Encoding.UTF8.GetBytes(msg);\n             byte[] lengthPrefix = BitConverter.GetBytes(messageData.Length);\n\n             // \n             stream.Write(lengthPrefix, 0, lengthPrefix.Length);\n             // \n             stream.Write(messageData, 0, messageData.Length);\n         }\n\n         Console.ReadLine();\n     }\n }\n```\n\n![](/images/sticky-packet/solve-sender-sticky.png)\n\n\n## \n:\n```C#\nstatic void Main(string[] args)\n{\n    TcpListener listener = new TcpListener(IPAddress.Any, 8888);\n    listener.Start();\n    Console.WriteLine(\"Server Start...\");\n\n    using( TcpClient client = listener.AcceptTcpClient() )\n    using( NetworkStream stream = client.GetStream() ) {\n        byte[] buffer = new byte[20]; // \n\n        int bytesRead;\n        while( (bytesRead = stream.Read(buffer, 0, buffer.Length)) > 0 ) {\n            string part = Encoding.UTF8.GetString(buffer, 0, bytesRead);\n            Console.WriteLine(\"Receive: \" + part );\n\n            if( bytesRead < buffer.Length )\n                break; // \n        }\n\n    }\n\n    listener.Stop();\n    Console.ReadLine();\n}\n```\n:\n```C#\nstatic void Main(string[] args)\n{\n    using( TcpClient client = new TcpClient(\"127.0.0.1\", 8888) )\n    using( NetworkStream stream = client.GetStream() ) {\n        string message = \"This is a longer message that may be split across multiple packets.\";\n        byte[] data = Encoding.UTF8.GetBytes(message);\n        stream.Write(data, 0, data.Length);\n\n        Console.WriteLine(\"Message sent.\");\n    }\n    Console.ReadLine();\n}\n```\n\n\n![](/images/sticky-packet/server-sticky.png)\n\n### \n\n\n```C#\nstatic void Main(string[] args)\n{\n    TcpListener listener = new TcpListener(IPAddress.Any, 8888);\n    listener.Start();\n    Console.WriteLine(\"Server start... \");\n    using( TcpClient client = listener.AcceptTcpClient() )\n    using( NetworkStream stream = client.GetStream() ) {\n        byte[] buffer = new byte[20];\n        StringBuilder completeMessage = new StringBuilder();\n\n        int bytesRead;\n        while( (bytesRead = stream.Read(buffer, 0, buffer.Length)) > 0 ) {\n            // \n            string part = Encoding.UTF8.GetString(buffer, 0, bytesRead);\n            completeMessage.Append(part);\n\n            // \n            if( completeMessage.ToString().Contains(\"...\") ) // \n            {\n                break;\n            }\n        }\n        Console.WriteLine(\"Complete Message: \" + completeMessage.ToString());\n    }\n\n    listener.Stop();\n    Console.ReadLine();\n}\n```\n\n![](/images/sticky-packet/solve-server-sticky.png)\n\n# \n\nTCP  TCP \n\n TCP ","slug":"sticky-packet","published":1,"updated":"2024-08-30T06:30:41.472Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhf000ru8p14llwgnu3","content":"<p>TCP  TCP  TCP </p>\n<h1 id=\"-TCP-\"><a href=\"#-TCP-\" class=\"headerlink\" title=\" TCP \"></a> TCP </h1><p>TCP  TCP  TCP </p>\n<p> Hello  World HelloWorld Hello  World </p>\n<h1 id=\"TCP-\"><a href=\"#TCP-\" class=\"headerlink\" title=\"TCP \"></a>TCP </h1><p> TCP  TCP </p>\n<ol>\n<li><p>TCP TCP  TCP </p>\n</li>\n<li><p>Nagle Nagle </p>\n</li>\n<li><p> TCP TCP </p>\n</li>\n</ol>\n<h1 id=\"-TCP-\"><a href=\"#-TCP-\" class=\"headerlink\" title=\" TCP \"></a> TCP </h1><p></p>\n<ol>\n<li><p></p>\n</li>\n<li><p> \\n</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h2><p>HTTPTCPHTTP</p>\n<p>HTTPTCPTCPHTTP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>Content-Length </p>\n<blockquote>\n<p>HTTP Content-Length </p>\n</blockquote>\n</li>\n<li><p>Chunked Transfer-Encoding</p>\n<blockquote>\n<p>HTTP&#x2F;1.1Chunked Transfer-Encoding0</p>\n</blockquote>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    TcpListener listener = <span class=\"keyword\">new</span> TcpListener(IPAddress.Any, <span class=\"number\">8888</span>);</span><br><span class=\"line\">    listener.Start();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">&quot;Server Start...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = listener.AcceptTcpClient() )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] buffer = <span class=\"keyword\">new</span> <span class=\"built_in\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">        <span class=\"built_in\">int</span> bytesRead = stream.Read(buffer, <span class=\"number\">0</span>, buffer.Length);</span><br><span class=\"line\">        <span class=\"built_in\">string</span> receivedData = Encoding.UTF8.GetString(buffer, <span class=\"number\">0</span>, bytesRead);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Received Data:\\r\\n &quot;</span> + receivedData);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    listener.Stop();</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = <span class=\"keyword\">new</span> TcpClient(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">8888</span>) )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">string</span>[] messages = &#123; <span class=\"string\">&quot;Message 1\\r\\n&quot;</span>, <span class=\"string\">&quot;Message 2\\r\\n&quot;</span>, <span class=\"string\">&quot;Message 3\\r\\n&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span>( <span class=\"keyword\">var</span> msg <span class=\"keyword\">in</span> messages ) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">byte</span>[] data = Encoding.UTF8.GetBytes(msg);</span><br><span class=\"line\">            stream.Write(data, <span class=\"number\">0</span>, data.Length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Messages sent.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/sticky-packet/sender-sticky.png\" alt=\"\"><br> Message 1Message 2Message 3TCP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = <span class=\"keyword\">new</span> TcpClient(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">8888</span>) )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">string</span>[] messages = &#123; <span class=\"string\">&quot;Message 1&quot;</span>, <span class=\"string\">&quot;Message 2&quot;</span>, <span class=\"string\">&quot;Message 3&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span>( <span class=\"keyword\">var</span> msg <span class=\"keyword\">in</span> messages ) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">byte</span>[] messageData = Encoding.UTF8.GetBytes(msg);</span><br><span class=\"line\">            <span class=\"built_in\">byte</span>[] lengthPrefix = BitConverter.GetBytes(messageData.Length);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            stream.Write(lengthPrefix, <span class=\"number\">0</span>, lengthPrefix.Length);</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            stream.Write(messageData, <span class=\"number\">0</span>, messageData.Length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.ReadLine();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/sticky-packet/solve-sender-sticky.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    TcpListener listener = <span class=\"keyword\">new</span> TcpListener(IPAddress.Any, <span class=\"number\">8888</span>);</span><br><span class=\"line\">    listener.Start();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">&quot;Server Start...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = listener.AcceptTcpClient() )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] buffer = <span class=\"keyword\">new</span> <span class=\"built_in\">byte</span>[<span class=\"number\">20</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"built_in\">int</span> bytesRead;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>( (bytesRead = stream.Read(buffer, <span class=\"number\">0</span>, buffer.Length)) &gt; <span class=\"number\">0</span> ) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">string</span> part = Encoding.UTF8.GetString(buffer, <span class=\"number\">0</span>, bytesRead);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;Receive: &quot;</span> + part );</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span>( bytesRead &lt; buffer.Length )</span><br><span class=\"line\">                <span class=\"keyword\">break</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    listener.Stop();</span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>:</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = <span class=\"keyword\">new</span> TcpClient(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">8888</span>) )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">string</span> message = <span class=\"string\">&quot;This is a longer message that may be split across multiple packets.&quot;</span>;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] data = Encoding.UTF8.GetBytes(message);</span><br><span class=\"line\">        stream.Write(data, <span class=\"number\">0</span>, data.Length);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Message sent.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/images/sticky-packet/server-sticky.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    TcpListener listener = <span class=\"keyword\">new</span> TcpListener(IPAddress.Any, <span class=\"number\">8888</span>);</span><br><span class=\"line\">    listener.Start();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">&quot;Server start... &quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = listener.AcceptTcpClient() )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] buffer = <span class=\"keyword\">new</span> <span class=\"built_in\">byte</span>[<span class=\"number\">20</span>];</span><br><span class=\"line\">        StringBuilder completeMessage = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"built_in\">int</span> bytesRead;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>( (bytesRead = stream.Read(buffer, <span class=\"number\">0</span>, buffer.Length)) &gt; <span class=\"number\">0</span> ) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"built_in\">string</span> part = Encoding.UTF8.GetString(buffer, <span class=\"number\">0</span>, bytesRead);</span><br><span class=\"line\">            completeMessage.Append(part);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>( completeMessage.ToString().Contains(<span class=\"string\">&quot;...&quot;</span>) ) <span class=\"comment\">// </span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Complete Message: &quot;</span> + completeMessage.ToString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    listener.Stop();</span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/sticky-packet/solve-server-sticky.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>TCP  TCP </p>\n<p> TCP </p>\n","site":{"data":{}},"excerpt":"","more":"<p>TCP  TCP  TCP </p>\n<h1 id=\"-TCP-\"><a href=\"#-TCP-\" class=\"headerlink\" title=\" TCP \"></a> TCP </h1><p>TCP  TCP  TCP </p>\n<p> Hello  World HelloWorld Hello  World </p>\n<h1 id=\"TCP-\"><a href=\"#TCP-\" class=\"headerlink\" title=\"TCP \"></a>TCP </h1><p> TCP  TCP </p>\n<ol>\n<li><p>TCP TCP  TCP </p>\n</li>\n<li><p>Nagle Nagle </p>\n</li>\n<li><p> TCP TCP </p>\n</li>\n</ol>\n<h1 id=\"-TCP-\"><a href=\"#-TCP-\" class=\"headerlink\" title=\" TCP \"></a> TCP </h1><p></p>\n<ol>\n<li><p></p>\n</li>\n<li><p> \\n</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h2><p>HTTPTCPHTTP</p>\n<p>HTTPTCPTCPHTTP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>Content-Length </p>\n<blockquote>\n<p>HTTP Content-Length </p>\n</blockquote>\n</li>\n<li><p>Chunked Transfer-Encoding</p>\n<blockquote>\n<p>HTTP&#x2F;1.1Chunked Transfer-Encoding0</p>\n</blockquote>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    TcpListener listener = <span class=\"keyword\">new</span> TcpListener(IPAddress.Any, <span class=\"number\">8888</span>);</span><br><span class=\"line\">    listener.Start();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">&quot;Server Start...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = listener.AcceptTcpClient() )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] buffer = <span class=\"keyword\">new</span> <span class=\"built_in\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">        <span class=\"built_in\">int</span> bytesRead = stream.Read(buffer, <span class=\"number\">0</span>, buffer.Length);</span><br><span class=\"line\">        <span class=\"built_in\">string</span> receivedData = Encoding.UTF8.GetString(buffer, <span class=\"number\">0</span>, bytesRead);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Received Data:\\r\\n &quot;</span> + receivedData);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    listener.Stop();</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = <span class=\"keyword\">new</span> TcpClient(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">8888</span>) )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">string</span>[] messages = &#123; <span class=\"string\">&quot;Message 1\\r\\n&quot;</span>, <span class=\"string\">&quot;Message 2\\r\\n&quot;</span>, <span class=\"string\">&quot;Message 3\\r\\n&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span>( <span class=\"keyword\">var</span> msg <span class=\"keyword\">in</span> messages ) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">byte</span>[] data = Encoding.UTF8.GetBytes(msg);</span><br><span class=\"line\">            stream.Write(data, <span class=\"number\">0</span>, data.Length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Messages sent.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/sticky-packet/sender-sticky.png\" alt=\"\"><br> Message 1Message 2Message 3TCP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = <span class=\"keyword\">new</span> TcpClient(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">8888</span>) )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">string</span>[] messages = &#123; <span class=\"string\">&quot;Message 1&quot;</span>, <span class=\"string\">&quot;Message 2&quot;</span>, <span class=\"string\">&quot;Message 3&quot;</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">foreach</span>( <span class=\"keyword\">var</span> msg <span class=\"keyword\">in</span> messages ) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">byte</span>[] messageData = Encoding.UTF8.GetBytes(msg);</span><br><span class=\"line\">            <span class=\"built_in\">byte</span>[] lengthPrefix = BitConverter.GetBytes(messageData.Length);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            stream.Write(lengthPrefix, <span class=\"number\">0</span>, lengthPrefix.Length);</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            stream.Write(messageData, <span class=\"number\">0</span>, messageData.Length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.ReadLine();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/sticky-packet/solve-sender-sticky.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    TcpListener listener = <span class=\"keyword\">new</span> TcpListener(IPAddress.Any, <span class=\"number\">8888</span>);</span><br><span class=\"line\">    listener.Start();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">&quot;Server Start...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = listener.AcceptTcpClient() )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] buffer = <span class=\"keyword\">new</span> <span class=\"built_in\">byte</span>[<span class=\"number\">20</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"built_in\">int</span> bytesRead;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>( (bytesRead = stream.Read(buffer, <span class=\"number\">0</span>, buffer.Length)) &gt; <span class=\"number\">0</span> ) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">string</span> part = Encoding.UTF8.GetString(buffer, <span class=\"number\">0</span>, bytesRead);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;Receive: &quot;</span> + part );</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span>( bytesRead &lt; buffer.Length )</span><br><span class=\"line\">                <span class=\"keyword\">break</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    listener.Stop();</span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>:</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = <span class=\"keyword\">new</span> TcpClient(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">8888</span>) )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">string</span> message = <span class=\"string\">&quot;This is a longer message that may be split across multiple packets.&quot;</span>;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] data = Encoding.UTF8.GetBytes(message);</span><br><span class=\"line\">        stream.Write(data, <span class=\"number\">0</span>, data.Length);</span><br><span class=\"line\"></span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Message sent.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><br><img src=\"/images/sticky-packet/server-sticky.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    TcpListener listener = <span class=\"keyword\">new</span> TcpListener(IPAddress.Any, <span class=\"number\">8888</span>);</span><br><span class=\"line\">    listener.Start();</span><br><span class=\"line\">    Console.WriteLine(<span class=\"string\">&quot;Server start... &quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( TcpClient client = listener.AcceptTcpClient() )</span><br><span class=\"line\">    <span class=\"keyword\">using</span>( NetworkStream stream = client.GetStream() ) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">byte</span>[] buffer = <span class=\"keyword\">new</span> <span class=\"built_in\">byte</span>[<span class=\"number\">20</span>];</span><br><span class=\"line\">        StringBuilder completeMessage = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"built_in\">int</span> bytesRead;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>( (bytesRead = stream.Read(buffer, <span class=\"number\">0</span>, buffer.Length)) &gt; <span class=\"number\">0</span> ) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"built_in\">string</span> part = Encoding.UTF8.GetString(buffer, <span class=\"number\">0</span>, bytesRead);</span><br><span class=\"line\">            completeMessage.Append(part);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>( completeMessage.ToString().Contains(<span class=\"string\">&quot;...&quot;</span>) ) <span class=\"comment\">// </span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Console.WriteLine(<span class=\"string\">&quot;Complete Message: &quot;</span> + completeMessage.ToString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    listener.Stop();</span><br><span class=\"line\">    Console.ReadLine();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/sticky-packet/solve-server-sticky.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>TCP  TCP </p>\n<p> TCP </p>\n"},{"title":"","date":"2024-05-30T08:02:51.000Z","_content":"\nHN\n\n\n CLIPContrastive Language-Image Pre-Training\n\nclip\n\n    [](https://juejin.cn/post/7325356387152707634)\n\n# \n\n+ \n+ \n+ Word2Vecord2Vec \n+ OpenCLIP CLIP  OpenAI OpenCLIPCLIP\n+ Qdrant Qdrant \n\n# \n1. \n2. CLIP\n3. \n4. \n5. CLIP\n6. \n7. \n![](/images/image-search/process.png)\n\n# \npythonWBscrapy\nWB\n\n  WB\n\nSelenium\n```python\nimport os\nimport scrapy\nfrom selenium import webdriver\nfrom selenium.webdriver.chrome.service import Service\nfrom selenium.webdriver.chrome.options import Options\nfrom scrapy.crawler import CrawlerProcess\nfrom scrapy.http import Request\nimport re  #  re \n\nclass WeiboSpider(scrapy.Spider):\n    name = 'wb'\n    start_urls = ['xxx.xxx.com']  # URL\n\n    def __init__(self, *args, **kwargs):\n        super(WeiboSpider, self).__init__(*args, **kwargs)\n        # SeleniumChromeDriver\n        chrome_options = Options()\n        chrome_options.add_argument(\"--headless\")  # \n        chrome_service = Service('D:\\\\Program Files\\\\chromedriver\\\\chromedriver.exe')\n        self.driver = webdriver.Chrome(service=chrome_service, options=chrome_options)\n\n    def parse(self, response):\n        # Selenium\n        self.driver.get(response.url)\n        # JavaScript\n        self.driver.implicitly_wait(10)  # 10\n        \n        #  images \n        images_dir = 'images'\n        if not os.path.exists(images_dir):\n            os.makedirs(images_dir)\n        \n        # URL...\n        # \n        images = self.driver.find_elements('tag name', 'img')\n        for image in images:\n            image_url = image.get_attribute('src')\n            if image_url:\n                yield Request(image_url, callback=self.save_image)\n\n        # SeleniumChromeDriver\n        self.driver.quit()\n\n    def save_image(self, response):\n        # \n\n```\n\n![](/images/image-search/images.png)\n\n# \nqdrant\n\n OpenAI  CLIP  ViT-B/32 \n[clip](https://github.com/openai/CLIP)\n```python\n# OpenCLIP\nmodel = open_clip.create_model('ViT-B-32', pretrained='openai')\npreprocess = open_clip.image_transform(model.visual.image_size, is_train=False)\n\n# Qdrant\nqdrant_client = QdrantClient(host='localhost', port=6333)\n\n# \ncollection_name = 'image_vectors'\n\n# \nfor image_name in os.listdir(source_folder):\n    image_path = os.path.join(source_folder, image_name)\n    \n    # \n    if os.path.isfile(image_path) and image_name.lower().endswith(('png', 'jpg', 'jpeg', 'bmp', 'gif')):\n        # \n\n        # \n\n        # \n        point = rest.PointStruct(\n            id=point_id,\n            vector=image_features,\n            payload={'file_name': image_name}\n        )\n        \n        # Qdrant\n\n        # TODO         \n```\n\n![](/images/image-search/qdrant.png)\n\n# \n\n\n1. \n2. \n3. \n4. \n\npythondemo\n```python\napp = Flask(__name__)\nUPLOAD_FOLDER = 'uploads'\nCLIPPED_FOLDER = 'image_scraper/images/clipped'\nos.makedirs(UPLOAD_FOLDER, exist_ok=True)\n\n# OpenCLIP\nmodel = open_clip.create_model('ViT-B-32', pretrained='openai')\npreprocess = open_clip.image_transform(model.visual.image_size, is_train=False)\n\n# Qdrant\nqdrant_client = QdrantClient(host='localhost', port=6333)\ncollection_name = 'image_vectors'\n\n# \n\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return \"No file part\", 400\n    file = request.files['file']\n    if file.filename == '':\n        return \"No selected file\", 400\n    if file and allowed_file(file.filename):\n        \n        # \n\n        # \n\n        # Qdrant\n        search_result = qdrant_client.search(\n            collection_name=collection_name,\n            query_vector=image_features,\n            limit=5  # \n        )\n\n        # \n        similar_images = [hit.payload['file_name'] for hit in search_result]\n        \n        return render_template('result.html', images=similar_images)\n    return \"File not allowed\", 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n\n```\n\n\n\n![](/images/image-search/search.gif)\n\n# \n OpenAI  CLIP  qdrant  Flask  Web \n\n\n\n","source":"_posts/similar-image-search.md","raw":"---\ntitle: \ndate: 2024-05-30 16:02:51\ntags:\n---\n\nHN\n\n\n CLIPContrastive Language-Image Pre-Training\n\nclip\n\n    [](https://juejin.cn/post/7325356387152707634)\n\n# \n\n+ \n+ \n+ Word2Vecord2Vec \n+ OpenCLIP CLIP  OpenAI OpenCLIPCLIP\n+ Qdrant Qdrant \n\n# \n1. \n2. CLIP\n3. \n4. \n5. CLIP\n6. \n7. \n![](/images/image-search/process.png)\n\n# \npythonWBscrapy\nWB\n\n  WB\n\nSelenium\n```python\nimport os\nimport scrapy\nfrom selenium import webdriver\nfrom selenium.webdriver.chrome.service import Service\nfrom selenium.webdriver.chrome.options import Options\nfrom scrapy.crawler import CrawlerProcess\nfrom scrapy.http import Request\nimport re  #  re \n\nclass WeiboSpider(scrapy.Spider):\n    name = 'wb'\n    start_urls = ['xxx.xxx.com']  # URL\n\n    def __init__(self, *args, **kwargs):\n        super(WeiboSpider, self).__init__(*args, **kwargs)\n        # SeleniumChromeDriver\n        chrome_options = Options()\n        chrome_options.add_argument(\"--headless\")  # \n        chrome_service = Service('D:\\\\Program Files\\\\chromedriver\\\\chromedriver.exe')\n        self.driver = webdriver.Chrome(service=chrome_service, options=chrome_options)\n\n    def parse(self, response):\n        # Selenium\n        self.driver.get(response.url)\n        # JavaScript\n        self.driver.implicitly_wait(10)  # 10\n        \n        #  images \n        images_dir = 'images'\n        if not os.path.exists(images_dir):\n            os.makedirs(images_dir)\n        \n        # URL...\n        # \n        images = self.driver.find_elements('tag name', 'img')\n        for image in images:\n            image_url = image.get_attribute('src')\n            if image_url:\n                yield Request(image_url, callback=self.save_image)\n\n        # SeleniumChromeDriver\n        self.driver.quit()\n\n    def save_image(self, response):\n        # \n\n```\n\n![](/images/image-search/images.png)\n\n# \nqdrant\n\n OpenAI  CLIP  ViT-B/32 \n[clip](https://github.com/openai/CLIP)\n```python\n# OpenCLIP\nmodel = open_clip.create_model('ViT-B-32', pretrained='openai')\npreprocess = open_clip.image_transform(model.visual.image_size, is_train=False)\n\n# Qdrant\nqdrant_client = QdrantClient(host='localhost', port=6333)\n\n# \ncollection_name = 'image_vectors'\n\n# \nfor image_name in os.listdir(source_folder):\n    image_path = os.path.join(source_folder, image_name)\n    \n    # \n    if os.path.isfile(image_path) and image_name.lower().endswith(('png', 'jpg', 'jpeg', 'bmp', 'gif')):\n        # \n\n        # \n\n        # \n        point = rest.PointStruct(\n            id=point_id,\n            vector=image_features,\n            payload={'file_name': image_name}\n        )\n        \n        # Qdrant\n\n        # TODO         \n```\n\n![](/images/image-search/qdrant.png)\n\n# \n\n\n1. \n2. \n3. \n4. \n\npythondemo\n```python\napp = Flask(__name__)\nUPLOAD_FOLDER = 'uploads'\nCLIPPED_FOLDER = 'image_scraper/images/clipped'\nos.makedirs(UPLOAD_FOLDER, exist_ok=True)\n\n# OpenCLIP\nmodel = open_clip.create_model('ViT-B-32', pretrained='openai')\npreprocess = open_clip.image_transform(model.visual.image_size, is_train=False)\n\n# Qdrant\nqdrant_client = QdrantClient(host='localhost', port=6333)\ncollection_name = 'image_vectors'\n\n# \n\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\n@app.route('/upload', methods=['POST'])\ndef upload_file():\n    if 'file' not in request.files:\n        return \"No file part\", 400\n    file = request.files['file']\n    if file.filename == '':\n        return \"No selected file\", 400\n    if file and allowed_file(file.filename):\n        \n        # \n\n        # \n\n        # Qdrant\n        search_result = qdrant_client.search(\n            collection_name=collection_name,\n            query_vector=image_features,\n            limit=5  # \n        )\n\n        # \n        similar_images = [hit.payload['file_name'] for hit in search_result]\n        \n        return render_template('result.html', images=similar_images)\n    return \"File not allowed\", 400\n\nif __name__ == '__main__':\n    app.run(debug=True)\n\n```\n\n\n\n![](/images/image-search/search.gif)\n\n# \n OpenAI  CLIP  qdrant  Flask  Web \n\n\n\n","slug":"similar-image-search","published":1,"updated":"2024-06-07T15:31:38.746Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cm3442fhk000vu8p1eafo9dtq","content":"<p>HN<br></p>\n<p> CLIPContrastive Language-Image Pre-Training</p>\n<p>clip</p>\n<pre><code>[](https://juejin.cn/post/7325356387152707634)\n</code></pre>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n<li>Word2Vecord2Vec </li>\n<li>OpenCLIP CLIP  OpenAI OpenCLIPCLIP</li>\n<li>Qdrant Qdrant </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li></li>\n<li>CLIP</li>\n<li></li>\n<li></li>\n<li>CLIP</li>\n<li></li>\n<li><br><img src=\"/images/image-search/process.png\" alt=\"\"></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>pythonWBscrapy<br>WB</p>\n<p>  WB</p>\n<p>Selenium</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> scrapy</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.service <span class=\"keyword\">import</span> Service</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.options <span class=\"keyword\">import</span> Options</span><br><span class=\"line\"><span class=\"keyword\">from</span> scrapy.crawler <span class=\"keyword\">import</span> CrawlerProcess</span><br><span class=\"line\"><span class=\"keyword\">from</span> scrapy.http <span class=\"keyword\">import</span> Request</span><br><span class=\"line\"><span class=\"keyword\">import</span> re  <span class=\"comment\">#  re </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">WeiboSpider</span>(scrapy.Spider):</span><br><span class=\"line\">    name = <span class=\"string\">&#x27;wb&#x27;</span></span><br><span class=\"line\">    start_urls = [<span class=\"string\">&#x27;xxx.xxx.com&#x27;</span>]  <span class=\"comment\"># URL</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, *args, **kwargs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(WeiboSpider, self).__init__(*args, **kwargs)</span><br><span class=\"line\">        <span class=\"comment\"># SeleniumChromeDriver</span></span><br><span class=\"line\">        chrome_options = Options()</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">&quot;--headless&quot;</span>)  <span class=\"comment\"># </span></span><br><span class=\"line\">        chrome_service = Service(<span class=\"string\">&#x27;D:\\\\Program Files\\\\chromedriver\\\\chromedriver.exe&#x27;</span>)</span><br><span class=\"line\">        self.driver = webdriver.Chrome(service=chrome_service, options=chrome_options)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">parse</span>(<span class=\"params\">self, response</span>):</span><br><span class=\"line\">        <span class=\"comment\"># Selenium</span></span><br><span class=\"line\">        self.driver.get(response.url)</span><br><span class=\"line\">        <span class=\"comment\"># JavaScript</span></span><br><span class=\"line\">        self.driver.implicitly_wait(<span class=\"number\">10</span>)  <span class=\"comment\"># 10</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">#  images </span></span><br><span class=\"line\">        images_dir = <span class=\"string\">&#x27;images&#x27;</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> os.path.exists(images_dir):</span><br><span class=\"line\">            os.makedirs(images_dir)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># URL...</span></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\">        images = self.driver.find_elements(<span class=\"string\">&#x27;tag name&#x27;</span>, <span class=\"string\">&#x27;img&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> image <span class=\"keyword\">in</span> images:</span><br><span class=\"line\">            image_url = image.get_attribute(<span class=\"string\">&#x27;src&#x27;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> image_url:</span><br><span class=\"line\">                <span class=\"keyword\">yield</span> Request(image_url, callback=self.save_image)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># SeleniumChromeDriver</span></span><br><span class=\"line\">        self.driver.quit()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">save_image</span>(<span class=\"params\">self, response</span>):</span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/image-search/images.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>qdrant</p>\n<p> OpenAI  CLIP  ViT-B&#x2F;32 <br><a href=\"https://github.com/openai/CLIP\">clip</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># OpenCLIP</span></span><br><span class=\"line\">model = open_clip.create_model(<span class=\"string\">&#x27;ViT-B-32&#x27;</span>, pretrained=<span class=\"string\">&#x27;openai&#x27;</span>)</span><br><span class=\"line\">preprocess = open_clip.image_transform(model.visual.image_size, is_train=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Qdrant</span></span><br><span class=\"line\">qdrant_client = QdrantClient(host=<span class=\"string\">&#x27;localhost&#x27;</span>, port=<span class=\"number\">6333</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">collection_name = <span class=\"string\">&#x27;image_vectors&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">for</span> image_name <span class=\"keyword\">in</span> os.listdir(source_folder):</span><br><span class=\"line\">    image_path = os.path.join(source_folder, image_name)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> os.path.isfile(image_path) <span class=\"keyword\">and</span> image_name.lower().endswith((<span class=\"string\">&#x27;png&#x27;</span>, <span class=\"string\">&#x27;jpg&#x27;</span>, <span class=\"string\">&#x27;jpeg&#x27;</span>, <span class=\"string\">&#x27;bmp&#x27;</span>, <span class=\"string\">&#x27;gif&#x27;</span>)):</span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\">        point = rest.PointStruct(</span><br><span class=\"line\">            <span class=\"built_in\">id</span>=point_id,</span><br><span class=\"line\">            vector=image_features,</span><br><span class=\"line\">            payload=&#123;<span class=\"string\">&#x27;file_name&#x27;</span>: image_name&#125;</span><br><span class=\"line\">        )</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Qdrant</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># TODO         </span></span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/image-search/qdrant.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><br></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>pythondemo</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\">UPLOAD_FOLDER = <span class=\"string\">&#x27;uploads&#x27;</span></span><br><span class=\"line\">CLIPPED_FOLDER = <span class=\"string\">&#x27;image_scraper/images/clipped&#x27;</span></span><br><span class=\"line\">os.makedirs(UPLOAD_FOLDER, exist_ok=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># OpenCLIP</span></span><br><span class=\"line\">model = open_clip.create_model(<span class=\"string\">&#x27;ViT-B-32&#x27;</span>, pretrained=<span class=\"string\">&#x27;openai&#x27;</span>)</span><br><span class=\"line\">preprocess = open_clip.image_transform(model.visual.image_size, is_train=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Qdrant</span></span><br><span class=\"line\">qdrant_client = QdrantClient(host=<span class=\"string\">&#x27;localhost&#x27;</span>, port=<span class=\"number\">6333</span>)</span><br><span class=\"line\">collection_name = <span class=\"string\">&#x27;image_vectors&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">index</span>():</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;index.html&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/upload&#x27;</span>, methods=[<span class=\"string\">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">upload_file</span>():</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"string\">&#x27;file&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> request.files:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;No file part&quot;</span>, <span class=\"number\">400</span></span><br><span class=\"line\">    file = request.files[<span class=\"string\">&#x27;file&#x27;</span>]</span><br><span class=\"line\">    <span class=\"keyword\">if</span> file.filename == <span class=\"string\">&#x27;&#x27;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;No selected file&quot;</span>, <span class=\"number\">400</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> file <span class=\"keyword\">and</span> allowed_file(file.filename):</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Qdrant</span></span><br><span class=\"line\">        search_result = qdrant_client.search(</span><br><span class=\"line\">            collection_name=collection_name,</span><br><span class=\"line\">            query_vector=image_features,</span><br><span class=\"line\">            limit=<span class=\"number\">5</span>  <span class=\"comment\"># </span></span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\">        similar_images = [hit.payload[<span class=\"string\">&#x27;file_name&#x27;</span>] <span class=\"keyword\">for</span> hit <span class=\"keyword\">in</span> search_result]</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;result.html&#x27;</span>, images=similar_images)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;File not allowed&quot;</span>, <span class=\"number\">400</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p><br><img src=\"/images/image-search/search.gif\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> OpenAI  CLIP  qdrant  Flask  Web </p>\n<p></p>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<p>HN<br></p>\n<p> CLIPContrastive Language-Image Pre-Training</p>\n<p>clip</p>\n<pre><code>[](https://juejin.cn/post/7325356387152707634)\n</code></pre>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li></li>\n<li></li>\n<li>Word2Vecord2Vec </li>\n<li>OpenCLIP CLIP  OpenAI OpenCLIPCLIP</li>\n<li>Qdrant Qdrant </li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li></li>\n<li>CLIP</li>\n<li></li>\n<li></li>\n<li>CLIP</li>\n<li></li>\n<li><br><img src=\"/images/image-search/process.png\" alt=\"\"></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>pythonWBscrapy<br>WB</p>\n<p>  WB</p>\n<p>Selenium</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> scrapy</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.service <span class=\"keyword\">import</span> Service</span><br><span class=\"line\"><span class=\"keyword\">from</span> selenium.webdriver.chrome.options <span class=\"keyword\">import</span> Options</span><br><span class=\"line\"><span class=\"keyword\">from</span> scrapy.crawler <span class=\"keyword\">import</span> CrawlerProcess</span><br><span class=\"line\"><span class=\"keyword\">from</span> scrapy.http <span class=\"keyword\">import</span> Request</span><br><span class=\"line\"><span class=\"keyword\">import</span> re  <span class=\"comment\">#  re </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">WeiboSpider</span>(scrapy.Spider):</span><br><span class=\"line\">    name = <span class=\"string\">&#x27;wb&#x27;</span></span><br><span class=\"line\">    start_urls = [<span class=\"string\">&#x27;xxx.xxx.com&#x27;</span>]  <span class=\"comment\"># URL</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, *args, **kwargs</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(WeiboSpider, self).__init__(*args, **kwargs)</span><br><span class=\"line\">        <span class=\"comment\"># SeleniumChromeDriver</span></span><br><span class=\"line\">        chrome_options = Options()</span><br><span class=\"line\">        chrome_options.add_argument(<span class=\"string\">&quot;--headless&quot;</span>)  <span class=\"comment\"># </span></span><br><span class=\"line\">        chrome_service = Service(<span class=\"string\">&#x27;D:\\\\Program Files\\\\chromedriver\\\\chromedriver.exe&#x27;</span>)</span><br><span class=\"line\">        self.driver = webdriver.Chrome(service=chrome_service, options=chrome_options)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">parse</span>(<span class=\"params\">self, response</span>):</span><br><span class=\"line\">        <span class=\"comment\"># Selenium</span></span><br><span class=\"line\">        self.driver.get(response.url)</span><br><span class=\"line\">        <span class=\"comment\"># JavaScript</span></span><br><span class=\"line\">        self.driver.implicitly_wait(<span class=\"number\">10</span>)  <span class=\"comment\"># 10</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">#  images </span></span><br><span class=\"line\">        images_dir = <span class=\"string\">&#x27;images&#x27;</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> os.path.exists(images_dir):</span><br><span class=\"line\">            os.makedirs(images_dir)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># URL...</span></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\">        images = self.driver.find_elements(<span class=\"string\">&#x27;tag name&#x27;</span>, <span class=\"string\">&#x27;img&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> image <span class=\"keyword\">in</span> images:</span><br><span class=\"line\">            image_url = image.get_attribute(<span class=\"string\">&#x27;src&#x27;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> image_url:</span><br><span class=\"line\">                <span class=\"keyword\">yield</span> Request(image_url, callback=self.save_image)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># SeleniumChromeDriver</span></span><br><span class=\"line\">        self.driver.quit()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">save_image</span>(<span class=\"params\">self, response</span>):</span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/image-search/images.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>qdrant</p>\n<p> OpenAI  CLIP  ViT-B&#x2F;32 <br><a href=\"https://github.com/openai/CLIP\">clip</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># OpenCLIP</span></span><br><span class=\"line\">model = open_clip.create_model(<span class=\"string\">&#x27;ViT-B-32&#x27;</span>, pretrained=<span class=\"string\">&#x27;openai&#x27;</span>)</span><br><span class=\"line\">preprocess = open_clip.image_transform(model.visual.image_size, is_train=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Qdrant</span></span><br><span class=\"line\">qdrant_client = QdrantClient(host=<span class=\"string\">&#x27;localhost&#x27;</span>, port=<span class=\"number\">6333</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">collection_name = <span class=\"string\">&#x27;image_vectors&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">for</span> image_name <span class=\"keyword\">in</span> os.listdir(source_folder):</span><br><span class=\"line\">    image_path = os.path.join(source_folder, image_name)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> os.path.isfile(image_path) <span class=\"keyword\">and</span> image_name.lower().endswith((<span class=\"string\">&#x27;png&#x27;</span>, <span class=\"string\">&#x27;jpg&#x27;</span>, <span class=\"string\">&#x27;jpeg&#x27;</span>, <span class=\"string\">&#x27;bmp&#x27;</span>, <span class=\"string\">&#x27;gif&#x27;</span>)):</span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\">        point = rest.PointStruct(</span><br><span class=\"line\">            <span class=\"built_in\">id</span>=point_id,</span><br><span class=\"line\">            vector=image_features,</span><br><span class=\"line\">            payload=&#123;<span class=\"string\">&#x27;file_name&#x27;</span>: image_name&#125;</span><br><span class=\"line\">        )</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># Qdrant</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># TODO         </span></span><br></pre></td></tr></table></figure>\n<p><br><img src=\"/images/image-search/qdrant.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><br></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>pythondemo</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\">UPLOAD_FOLDER = <span class=\"string\">&#x27;uploads&#x27;</span></span><br><span class=\"line\">CLIPPED_FOLDER = <span class=\"string\">&#x27;image_scraper/images/clipped&#x27;</span></span><br><span class=\"line\">os.makedirs(UPLOAD_FOLDER, exist_ok=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># OpenCLIP</span></span><br><span class=\"line\">model = open_clip.create_model(<span class=\"string\">&#x27;ViT-B-32&#x27;</span>, pretrained=<span class=\"string\">&#x27;openai&#x27;</span>)</span><br><span class=\"line\">preprocess = open_clip.image_transform(model.visual.image_size, is_train=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Qdrant</span></span><br><span class=\"line\">qdrant_client = QdrantClient(host=<span class=\"string\">&#x27;localhost&#x27;</span>, port=<span class=\"number\">6333</span>)</span><br><span class=\"line\">collection_name = <span class=\"string\">&#x27;image_vectors&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">index</span>():</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;index.html&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(<span class=\"params\"><span class=\"string\">&#x27;/upload&#x27;</span>, methods=[<span class=\"string\">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">upload_file</span>():</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"string\">&#x27;file&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> request.files:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;No file part&quot;</span>, <span class=\"number\">400</span></span><br><span class=\"line\">    file = request.files[<span class=\"string\">&#x27;file&#x27;</span>]</span><br><span class=\"line\">    <span class=\"keyword\">if</span> file.filename == <span class=\"string\">&#x27;&#x27;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;No selected file&quot;</span>, <span class=\"number\">400</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> file <span class=\"keyword\">and</span> allowed_file(file.filename):</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Qdrant</span></span><br><span class=\"line\">        search_result = qdrant_client.search(</span><br><span class=\"line\">            collection_name=collection_name,</span><br><span class=\"line\">            query_vector=image_features,</span><br><span class=\"line\">            limit=<span class=\"number\">5</span>  <span class=\"comment\"># </span></span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\">        similar_images = [hit.payload[<span class=\"string\">&#x27;file_name&#x27;</span>] <span class=\"keyword\">for</span> hit <span class=\"keyword\">in</span> search_result]</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> render_template(<span class=\"string\">&#x27;result.html&#x27;</span>, images=similar_images)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;File not allowed&quot;</span>, <span class=\"number\">400</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    app.run(debug=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p><br><img src=\"/images/image-search/search.gif\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> OpenAI  CLIP  qdrant  Flask  Web </p>\n<p></p>\n<p></p>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cm3442fh70005u8p1d7vcawvp","tag_id":"cm3442fh70007u8p16r7c7r4h","_id":"cm3442fhc000cu8p16gmt6uiu"},{"post_id":"cm3442fha0009u8p1bpeu9l1y","tag_id":"cm3442fhb000bu8p196erbfjn","_id":"cm3442fhd000hu8p1bjgg01e1"},{"post_id":"cm3442fha000au8p16lf23fe1","tag_id":"cm3442fhd000gu8p12yh52qa9","_id":"cm3442fhe000mu8p1hqqw9y20"},{"post_id":"cm3442fhc000du8p155z813xo","tag_id":"cm3442fhe000ku8p1b2ducw8j","_id":"cm3442fhf000pu8p17luw99bn"},{"post_id":"cm3442fhe000nu8p14nceckxa","tag_id":"cm3442fhf000qu8p199xgf4qr","_id":"cm3442fhg000tu8p165qp6zy4"},{"post_id":"cm3442fhf000ou8p19gpwhfmw","tag_id":"cm3442fhf000su8p172yq18j7","_id":"cm3442fhg000uu8p10ptph36z"}],"Tag":[{"name":"dump  ","_id":"cm3442fh70007u8p16r7c7r4h"},{"name":"Garnet  ","_id":"cm3442fhb000bu8p196erbfjn"},{"name":"https http ssl tls","_id":"cm3442fhd000gu8p12yh52qa9"},{"name":" ","_id":"cm3442fhe000ku8p1b2ducw8j"},{"name":"redis  ","_id":"cm3442fhf000qu8p199xgf4qr"},{"name":"http http Connection","_id":"cm3442fhf000su8p172yq18j7"}]}}